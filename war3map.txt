globals
    // User-defined
rect udg_ReviveRect= null
unit array udg_ReviveHero
integer udg_ReviveWriteIndex= 0
integer udg_ReviveReadIndex= 0
group udg_TempGroup= null
location udg_TempPoint= null
boolean udg_DamageAbility= false
boolean udg_DamageMagic= false
unit array udg_ShadowstormCaster
location udg_TempPoint2= null
integer udg_TempInt= 0
unit udg_TempUnit= null
real udg_TempReal= 0
unit array udg_NagaSiren
group udg_TempGroup2= null
boolean udg_TempBool= false
unit array udg_VoidZoneCaster
unit array udg_VoidZoneDummy
integer udg_VoidZoneWriteIndex= 0
integer udg_VoidZoneReadIndex= 0
real udg_TempReal2= 0
group udg_SunBlessingLearnedGroup= null
integer udg_SunBlessingCasterIndex= 0
unit array udg_SunBlessingCaster
group array udg_SunBlessingTargetGroup
group udg_IronRavenGroup= null
unit udg_TempUnit2= null
integer udg_MaxPlayers= 0
group udg_GolemGroup= null
integer udg_ItemIdMagicLamp= 0
integer udg_ItemIdScaleOfBalance= 0
real udg_DarkBeamMultiplier= 0
group udg_ShadowSpikesDummyGroup= null
unit udg_ShadowSpikesCaster= null
boolean udg_ShadowSpikesFinished= false
unit array udg_ShadowstormDummy
integer udg_ShadowstormWriteIndex= 0
integer udg_ShadowstormReadIndex= 0
integer udg_ItemIdSoulEater= 0
location udg_FrozenSpheresPoint= null
group udg_FrozenSpheresGroup= null
real udg_FrozenSpheresDirection= 0
unit udg_FrozenSpheresCaster= null
unit udg_MasterOfTheVault= null
group udg_HealingStreamGroup= null
real udg_HealingStreamMultiplier= 0
integer udg_HealingStreamBounceCount= 0
unit udg_HealingStreamCaster= null
group udg_PlayerHeroes= null
group udg_SinisterReflectionGroup= null
timer udg_OpenMainGateTimer= null
location udg_ClonesPoint= null
unit udg_ClonesUnit= null
integer udg_ClonesTick= 0
unit udg_ClonesCaster= null
boolean udg_ClonesHasMovedCaster= false
integer udg_ClonesNumClones= 0
real udg_ClonesStartAngle= 0
integer udg_ClonesTickInterval= 0
unit udg_ClonesLastCreated= null
group udg_CircleOfCultistsGroup= null
unit udg_TranqTotemCaster= null
group udg_TranqTotemCasterGroup= null
group udg_TranqTotemGroup= null
group udg_HeroSelectGroup= null
timer udg_DoubleClickTimerP1= null
boolean array udg_HasClicked
unit array udg_LastClickedUnit
timer udg_DoubleClickTimerP2= null
timer udg_DoubleClickTimerP3= null
timer udg_DoubleClickTimerP4= null
timer udg_DoubleClickTimerP5= null
integer udg_HeroPicksLeft= 0
integer array udg_PlayerNumHeroes
group udg_WheelOfDeathGroup= null
group udg_PatMainHall= null
timer udg_PatMainHallTimer= null
rect udg_PatMainHallDestination= null
integer array udg_SlaughterTPCount
unit array udg_SlaughterCaster
location array udg_SlaughterPoint
unit array udg_SlaughterTarget
integer udg_SlaughterWriteIndex= 0
integer udg_SlaughterReadIndex= 0
location udg_TempPoint3= null
integer udg_DummyUnitId= 0
group udg_IsCastingGroup= null
unit udg_ThunderheadCaster= null
string udg_TempString
unit udg_SinisterReflectionTarget= null
unit udg_SpiritBeastsCaster= null
unit udg_FireTotemCaster= null
integer udg_SiphonAuraBuffId= 0
location udg_ArcaneNovaPoint= null
unit udg_AvatarCaster= null
integer udg_AvatarAbilId= 0
integer array udg_AvatarLifeBonus
integer udg_AvatarWriteIndex= 0
integer udg_AvatarReadIndex= 0
integer udg_StormShieldCharges= 0
integer udg_ItemIdGaiaSeed= 0
integer udg_ItemIdIdolOfResistance= 0
integer udg_ItemIdBloodtaintedCrystal= 0
integer udg_ItemIdLifeOrb= 0
integer udg_InterruptAbilId= 0
string udg_InterruptAbilOrder
group udg_ImpaleDummyGroup= null
texttag udg_HeroSelectFloatingText= null
unit udg_CryptLordBoss= null
integer udg_AbilShockwaveId= 0
unit udg_BonesOfDeathCaster= null
integer udg_AbilSoulCoilId= 0
unit udg_SoulCoilCaster= null
integer udg_CreepRegenIdleTime= 0
boolean array udg_LevelCompleted
integer udg_NumLevels= 0
rect udg_NextLevelCamBounds= null
rect udg_NextLevelStartRect= null
integer udg_SunfireBeamAbilId= 0
integer udg_FireDruidBossId= 0
unit udg_SunfireBeamCaster= null
integer udg_SunfireBeamDummyId= 0
unit udg_SunfireBeamDummy= null
integer udg_CryptLordBossId= 0
integer udg_FountainOfBloodAbilId= 0
integer udg_SphinxBossId= 0
integer udg_SwitcherooAbilId= 0
integer udg_EarthSpearAbilId= 0
integer udg_GolemUnitId= 0
unit udg_EarthSpearCaster= null
integer udg_EarthSpearDummyAbilId= 0
integer udg_AscensionAbilId= 0
integer udg_AscensionBuffId= 0
group udg_FountainOfBloodCasterGroup= null
integer udg_SolarRaysAbilId= 0
integer udg_SolarRaysDummyAbilId= 0
unit udg_SolarRaysCaster= null
group udg_SolarRaysDummyGroup= null
location udg_SunfireBeamTargetLoc= null
unit udg_TeleportFireDruidCaster= null
integer udg_TeleportFireDruidAbilId= 0
integer udg_SoulCoilDummyAbilId= 0
integer udg_LichBossId= 0
integer udg_EarthSpearDummyId= 0

    // Generated
rect gg_rct_AbilFireDruidBossTpOrigin= null
rect gg_rct_AbilLichBossClonesOrigin= null
rect gg_rct_AmbienceDungeon00= null
rect gg_rct_AmbienceDungeon02= null
rect gg_rct_Center= null
rect gg_rct_EnvAQDoorBig0= null
rect gg_rct_EnvAQDoorSmall0A= null
rect gg_rct_EnvAQDoorSmall0B= null
rect gg_rct_EnvAQDoorSmall0C= null
rect gg_rct_HeroSelection= null
rect gg_rct_LandmarkCircleOfCultists= null
rect gg_rct_LandmarkCircleOfCultistsAggro= null
rect gg_rct_Level01CamBounds= null
rect gg_rct_Level01Exit= null
rect gg_rct_Level01Revive= null
rect gg_rct_Level02CamBounds= null
rect gg_rct_Level02Exit= null
rect gg_rct_Level02Revive= null
rect gg_rct_Level02Start= null
rect gg_rct_Level03CamBounds= null
rect gg_rct_Level03Exit= null
rect gg_rct_Level03Revive= null
rect gg_rct_Level03Start= null
rect gg_rct_Level04CamBounds= null
rect gg_rct_Level04Exit= null
rect gg_rct_Level04Revive= null
rect gg_rct_Level04Start= null
rect gg_rct_Level05CamBounds= null
rect gg_rct_Level05Exit= null
rect gg_rct_Level05Revive= null
rect gg_rct_Level05Start= null
rect gg_rct_Level06CamBounds= null
rect gg_rct_Level06Exit= null
rect gg_rct_Level06Revive= null
rect gg_rct_Level06Start= null
rect gg_rct_Level07CamBounds= null
rect gg_rct_Level07Revive= null
rect gg_rct_Level07Start= null
rect gg_rct_PatrolMainHallCenter= null
rect gg_rct_PatrolMainHallEast= null
rect gg_rct_PatrolMainHallNorth= null
rect gg_rct_PatrolMainHallSouth= null
rect gg_rct_PatrolMainHallWest= null
rect gg_rct_WeatherGreenFogHeavy00= null
rect gg_rct_WeatherOutlandWindLight00= null
rect gg_rct_WeatherOutlandWindLight01= null
rect gg_rct_WeatherOutlandWindLight02= null
rect gg_rct_WeatherOutlandWindLight03= null
rect gg_rct_WeatherOutlandWindLight04= null
rect gg_rct_WeatherOutlandWindLight05= null
rect gg_rct_WeatherOutlandWindLight06= null
rect gg_rct_WeatherWhiteFogHeavy00= null
camerasetup gg_cam_TopDown= null
sound gg_snd_Ambience_Dungeon= null
sound gg_snd_MoonWellWhat1= null
string gg_snd_Music_AgonWastes
string gg_snd_Music_AhnQirajIntro
sound gg_snd_QuestCompleted= null
sound gg_snd_RockGolemWhat2= null
sound gg_snd_Voice_Azir_AncientPowerCourses= null
sound gg_snd_Voice_Azir_DeathHow= null
sound gg_snd_Voice_Azir_SeeWhatISee= null
sound gg_snd_Voice_Azir_TrustInMyVision= null
sound gg_snd_Voice_Azir_YouDareOppose= null
sound gg_snd_Voice_Azir_YourSacrifice= null
sound gg_snd_Voice_Lich_JudgedForDefiling= null
sound gg_snd_Voice_Lich_LawsOfTheAncient= null
sound gg_snd_Voice_Lich_ServeToTheLast= null
sound gg_snd_Voice_Lich_Trespassers= null
sound gg_snd_Yogg_BowDown= null
sound gg_snd_Yogg_DestroyThemMinion= null
sound gg_snd_Yogg_EternalSuffering= null
sound gg_snd_Yogg_Laugh= null
sound gg_snd_Yogg_Madness= null
sound gg_snd_Yogg_Sound00= null
sound gg_snd_Yogg_Sound01= null
sound gg_snd_Yogg_YourWill= null
trigger gg_trg_IsUnitCasting= null
trigger gg_trg_IsCastingBegin= null
trigger gg_trg_IsCastingCleanup= null
trigger gg_trg_ShouldUnitUseAbility= null
trigger gg_trg_DispelUnit= null
trigger gg_trg_EnemyUseAbility= null
trigger gg_trg_IsUnitStatusImmune= null
trigger gg_trg_InterruptTarget= null
trigger gg_trg_GetUnitDamage= null
trigger gg_trg_GetUnitLifePercentage= null
trigger gg_trg_GetUnitLifeRegeneration= null
trigger gg_trg_GetUnitMagicDamageReduction= null
trigger gg_trg_GetUnitManaRegeneration= null
trigger gg_trg_GetUnitSpellPower= null
trigger gg_trg_HealUnit= null
trigger gg_trg_RegenerateLife= null
trigger gg_trg_RestoreMana= null
trigger gg_trg_SpellTargetEnemyFilter= null
trigger gg_trg_UnitDamageTargetMagic= null
trigger gg_trg_Init= null
trigger gg_trg_InitInGame= null
trigger gg_trg_Regeneration= null
trigger gg_trg_Zoom= null
trigger gg_trg_LevelsInit= null
trigger gg_trg_NextLevel= null
trigger gg_trg_Level01Exit= null
trigger gg_trg_Level02Exit= null
trigger gg_trg_Level03Exit= null
trigger gg_trg_Level04Exit= null
trigger gg_trg_Level05Exit= null
trigger gg_trg_Level06Exit= null
trigger gg_trg_Level01Complete= null
trigger gg_trg_Level02Complete= null
trigger gg_trg_Level03Complete= null
trigger gg_trg_Level04Complete= null
trigger gg_trg_Level05Complete= null
trigger gg_trg_Level06Complete= null
trigger gg_trg_Level07Complete= null
trigger gg_trg_InitCircleOfCultists= null
trigger gg_trg_CircleOfCultistsAggro= null
trigger gg_trg_CircleOfCultistsAttacked= null
trigger gg_trg_OpenMainGateStart= null
trigger gg_trg_OpenMainGateFinish= null
trigger gg_trg_OpenGateToTriangle= null
trigger gg_trg_HeroSelectInit= null
trigger gg_trg_HeroSelectSetSeleted= null
trigger gg_trg_SetHeroSelectMaxAbils= null
trigger gg_trg_SetPlayerNumHeroes= null
trigger gg_trg_DoubleClickTimeoutP1= null
trigger gg_trg_DoubleClickTimeoutP2= null
trigger gg_trg_DoubleClickTimeoutP3= null
trigger gg_trg_DoubleClickTimeoutP4= null
trigger gg_trg_DoubleClickTimeoutP5= null
trigger gg_trg_HeroRevive= null
trigger gg_trg_SetHeroColors= null
trigger gg_trg_ThunderheadCast= null
trigger gg_trg_ThunderheadDmg= null
trigger gg_trg_ThunderheadDmgEvent= null
trigger gg_trg_SpiritBeastsCast= null
trigger gg_trg_SpiritBeastsScale= null
trigger gg_trg_StormShieldCast= null
trigger gg_trg_StormShieldDmg= null
trigger gg_trg_AvatarCast= null
trigger gg_trg_SpiritCoil= null
trigger gg_trg_DarkSlumber= null
trigger gg_trg_SiphonAura= null
trigger gg_trg_WheelOfDeathCast= null
trigger gg_trg_WheelOfDeathTick= null
trigger gg_trg_SunBladesCast= null
trigger gg_trg_SunBladesDmgEvt= null
trigger gg_trg_SunBlessingLearn= null
trigger gg_trg_SunBlessingCast= null
trigger gg_trg_SunBlessingTick= null
trigger gg_trg_SunShieldDmgEvt= null
trigger gg_trg_MirageCast= null
trigger gg_trg_MirageDeath= null
trigger gg_trg_ArcaneTorrent= null
trigger gg_trg_ArcaneTorrentDummyDeath= null
trigger gg_trg_Amplify= null
trigger gg_trg_NetherFlux= null
trigger gg_trg_ArcaneNovaFinish= null
trigger gg_trg_RayOfLight= null
trigger gg_trg_ShiningGaze= null
trigger gg_trg_HolyShield= null
trigger gg_trg_HolyShieldDmgEvent= null
trigger gg_trg_RadiantNova= null
trigger gg_trg_HealingStreamCast= null
trigger gg_trg_FireTotemCast= null
trigger gg_trg_EarthShield= null
trigger gg_trg_TranqTotemCast= null
trigger gg_trg_TranqTotemBirth= null
trigger gg_trg_TranqTotemDeath= null
trigger gg_trg_TranqTotemTick= null
trigger gg_trg_Rake= null
trigger gg_trg_Umbra= null
trigger gg_trg_SlaughterCast= null
trigger gg_trg_SlaughterTick= null
trigger gg_trg_IronRavenAlphaInit= null
trigger gg_trg_IronRavenAlphaAbility= null
trigger gg_trg_IronRavenAlphaPeriodic= null
trigger gg_trg_IronRavenAlphaSelect= null
trigger gg_trg_CreateAbilFloatingText= null
trigger gg_trg_CreepResourceAward= null
trigger gg_trg_CreepExpReward= null
trigger gg_trg_CreepRegen= null
trigger gg_trg_CreepRegenStopByAttack= null
trigger gg_trg_CreepRegenStopByAttacked= null
trigger gg_trg_CreepRegenStopBySpellTargetEnemy= null
trigger gg_trg_CreepRegenStopByDamaged= null
trigger gg_trg_CreepRegenStopByDamagedEvent= null
trigger gg_trg_InitGolems= null
trigger gg_trg_GolemAggro= null
trigger gg_trg_EarthSpearUse= null
trigger gg_trg_EarthSpearCast= null
trigger gg_trg_EarthSpearDmg= null
trigger gg_trg_AcolyteHeal= null
trigger gg_trg_ImpaleAttack= null
trigger gg_trg_ImpaleDummyDeath= null
trigger gg_trg_BonesOfDeathUse= null
trigger gg_trg_BonesOfDeathCast= null
trigger gg_trg_BonesOfDeathEnd= null
trigger gg_trg_BonesOfDeathStop= null
trigger gg_trg_SummonScarabsUse= null
trigger gg_trg_SummonScarabsCast= null
trigger gg_trg_ShockwaveUse= null
trigger gg_trg_ShockwaveBegin= null
trigger gg_trg_ShockwaveFinish= null
trigger gg_trg_FireDruidBossDeath= null
trigger gg_trg_FireDruidBossKill= null
trigger gg_trg_FireDruidBossEngage= null
trigger gg_trg_AscensionUse= null
trigger gg_trg_AscensionCast= null
trigger gg_trg_AscensionDmg= null
trigger gg_trg_SolarRaysUse= null
trigger gg_trg_SolarRaysBegin= null
trigger gg_trg_SolarRaysFinish= null
trigger gg_trg_SolarRaysDummyDeath= null
trigger gg_trg_SunfireBeamUse= null
trigger gg_trg_SunfireBeamBegin= null
trigger gg_trg_SunfireBeamFinish= null
trigger gg_trg_TeleportFireDruidUse= null
trigger gg_trg_TeleportFireDruidCast= null
trigger gg_trg_SphinxCouncilInit= null
trigger gg_trg_RandomizeSphinxBossAbils= null
trigger gg_trg_SphinxBossShareAbility= null
trigger gg_trg_SphinxBossEncounterRewards= null
trigger gg_trg_FountainOfBloodUse= null
trigger gg_trg_FountainOfBloodBegin= null
trigger gg_trg_FountainOfBloodEnd= null
trigger gg_trg_SwitcherooUse= null
trigger gg_trg_SwitcherooCast= null
trigger gg_trg_SuccubusAttackAnim= null
trigger gg_trg_AbominationEnrage= null
trigger gg_trg_AbominationBreathUse= null
trigger gg_trg_AbominationBreathCast= null
trigger gg_trg_BoneSpike= null
trigger gg_trg_FrozenSpheresUse= null
trigger gg_trg_FrozenSpheresCast= null
trigger gg_trg_FrozenSpheresDummyDeath= null
trigger gg_trg_FrozenSpheresTick= null
trigger gg_trg_LichDeath= null
trigger gg_trg_LichBossEngage= null
trigger gg_trg_SoulCoilUse= null
trigger gg_trg_SoulCoilBegin= null
trigger gg_trg_SoulCoilDummyCast= null
trigger gg_trg_SoulCoilEndStop= null
trigger gg_trg_UnholyNovaUse= null
trigger gg_trg_UnholyNovaBegin= null
trigger gg_trg_UnholyNovaFinish= null
trigger gg_trg_SinisterReflectUse= null
trigger gg_trg_SinisterReflectBegin= null
trigger gg_trg_SinisterReflectFinish= null
trigger gg_trg_SinisterReflectDeath= null
trigger gg_trg_ClonesUse= null
trigger gg_trg_ClonesCast= null
trigger gg_trg_ClonesLoop= null
trigger gg_trg_ClonesSetNumClones= null
trigger gg_trg_ClonesDmg= null
trigger gg_trg_ClonesDmgEvent= null
trigger gg_trg_InitNagaSirens= null
trigger gg_trg_NagaSirenHPShareStart= null
trigger gg_trg_NagaSirenHPShare= null
trigger gg_trg_NagaSirenDeath= null
trigger gg_trg_HealTwinUse= null
trigger gg_trg_HealTwinCast= null
trigger gg_trg_TeleportUse= null
trigger gg_trg_TeleportCast= null
trigger gg_trg_ShadowstormUse= null
trigger gg_trg_ShadowstormCast= null
trigger gg_trg_ShadowstormDmg= null
trigger gg_trg_ShadowstormDmgEvent= null
trigger gg_trg_ShadowstormDummyDeath= null
trigger gg_trg_VoidZoneUse= null
trigger gg_trg_VoidZoneCast= null
trigger gg_trg_VoidZoneTick= null
trigger gg_trg_VoidZoneDeath= null
trigger gg_trg_JinxUse= null
trigger gg_trg_PhoenixDeath= null
trigger gg_trg_PhoenixEggDeath= null
trigger gg_trg_AnkhOfReanimation= null
trigger gg_trg_AnkhOfReanimationDeath= null
trigger gg_trg_InitWaspEggs= null
trigger gg_trg_WaspEggAggro= null
trigger gg_trg_WaspEggDeath= null
trigger gg_trg_MasterOfTheVaultInit= null
trigger gg_trg_MasterOfTheVaultEngage= null
trigger gg_trg_MasterOfTheVaultAITick= null
trigger gg_trg_MasterOfTheVaultDeath= null
trigger gg_trg_OtherwordlyBarrier= null
trigger gg_trg_DarkBeamCast= null
trigger gg_trg_DarkBeamDmg= null
trigger gg_trg_DarkBeamDmgEvent= null
trigger gg_trg_ShadowEruptionCast= null
trigger gg_trg_ShadowEruptionDummyDeath= null
trigger gg_trg_ShadowSpikesCastBegin= null
trigger gg_trg_ShadowSpikesCastStop= null
trigger gg_trg_ShadowSpikesCastFinish= null
trigger gg_trg_ShadowSpikesDummyDeath= null
trigger gg_trg_SummonCorruptWatcherCast= null
trigger gg_trg_CorruptWatcherEnterMap= null
trigger gg_trg_BindingGazeUse= null
trigger gg_trg_BindingGazeDmg= null
trigger gg_trg_BindingGazeDmgEvent= null
trigger gg_trg_SummonOtherwordlyEntity= null
trigger gg_trg_OtherwordlyEntityDeath= null
trigger gg_trg_PatMainHallInit= null
trigger gg_trg_PatMainHallLoad= null
trigger gg_trg_PatMainHallCenter= null
trigger gg_trg_PatMainHallMove= null
trigger gg_trg_ItemAncientTome= null
trigger gg_trg_ItemAbilLifeOrb= null
trigger gg_trg_ItemAbilSoulEater= null
trigger gg_trg_ItemAbilSoulEaterCondition= null
trigger gg_trg_TempLevelUp= null
trigger gg_trg_TempLevelUpMax= null
unit gg_unit_U00I_0045= null
unit gg_unit_O001_0044= null
unit gg_unit_E007_0043= null
unit gg_unit_E001_0042= null
unit gg_unit_E006_0041= null
unit gg_unit_N001_0046= null
unit gg_unit_N00F_0047= null
destructable gg_dest_Ytlc_0351= null
destructable gg_dest_Ytlc_0350= null
destructable gg_dest_Ytlc_0343= null
destructable gg_dest_Ytlc_0321= null
destructable gg_dest_Ytlc_0186= null
destructable gg_dest_Ytlc_3062= null
destructable gg_dest_Ytlc_3061= null
destructable gg_dest_Ytlc_3059= null
destructable gg_dest_Ytlc_3060= null
hashtable SpiritCoilHashtable= null
constant integer SUN_BLADES_ABIL_ID= 'A015'
unit array sunBladesCaster
integer sunBladesWriteIndex= 0
integer sunBladesReadIndex= 0
constant integer SUN_BLADES_BUFF_ID= 'B00J'
constant integer SUN_SHIELD_ABILITY_ID= 'A017'
constant integer SUN_SHIELD_BUFF_ID= 'B00I'
unit arcaneTorrentCaster= null
unit arcaneTorrentTarget= null
unit amplifyCaster= null
constant integer EARTH_SHIELD_ABILITY_ID= 'A01C'
constant integer EARTH_SHIELD_DUMMY_ABILITY_ID= 'A01D'
constant integer EARTH_SHIELD_BUFF_ID= 'B008'
constant integer EARTH_SHIELD_BUFF_LEVEL_ID= 'A01E'
constant integer rakeAbilId= 'A00J'
constant integer rakeDummyAbilId= 'A00I'
constant integer rakeBuffId= 'B00B'
constant integer rakeSFXDummyId= 'e005'


//JASSHelper struct globals:

endglobals


//===========================================================================
// 
// Vault of Darkness K
// 
//   Warcraft III map script
//   Generated by the Warcraft III World Editor
//   Map Author: Wadjet
// 
//===========================================================================

//***************************************************************************
//*
//*  Global Variables
//*
//***************************************************************************


function InitGlobals takes nothing returns nothing
    local integer i= 0
    set udg_ReviveWriteIndex=0
    set udg_ReviveReadIndex=0
    set udg_TempGroup=CreateGroup()
    set udg_DamageAbility=false
    set udg_DamageMagic=false
    set udg_TempInt=0
    set udg_TempReal=0
    set udg_TempGroup2=CreateGroup()
    set udg_TempBool=false
    set udg_VoidZoneWriteIndex=0
    set udg_VoidZoneReadIndex=0
    set udg_TempReal2=0
    set udg_SunBlessingLearnedGroup=CreateGroup()
    set udg_SunBlessingCasterIndex=0
    set i=0
    loop
        exitwhen ( i > 1 )
        set udg_SunBlessingTargetGroup[i]=CreateGroup()
        set i=i + 1
    endloop

    set udg_IronRavenGroup=CreateGroup()
    set udg_MaxPlayers=5
    set udg_GolemGroup=CreateGroup()
    set udg_ItemIdMagicLamp='I003'
    set udg_ItemIdScaleOfBalance='I004'
    set udg_DarkBeamMultiplier=0
    set udg_ShadowSpikesDummyGroup=CreateGroup()
    set udg_ShadowSpikesFinished=false
    set udg_ShadowstormWriteIndex=0
    set udg_ShadowstormReadIndex=0
    set udg_ItemIdSoulEater='I005'
    set udg_FrozenSpheresGroup=CreateGroup()
    set udg_FrozenSpheresDirection=0
    set udg_HealingStreamGroup=CreateGroup()
    set udg_HealingStreamMultiplier=0
    set udg_HealingStreamBounceCount=0
    set udg_PlayerHeroes=CreateGroup()
    set udg_SinisterReflectionGroup=CreateGroup()
    set udg_OpenMainGateTimer=CreateTimer()
    set udg_ClonesTick=0
    set udg_ClonesHasMovedCaster=false
    set udg_ClonesNumClones=0
    set udg_ClonesStartAngle=0
    set udg_ClonesTickInterval=0
    set udg_CircleOfCultistsGroup=CreateGroup()
    set udg_TranqTotemCasterGroup=CreateGroup()
    set udg_TranqTotemGroup=CreateGroup()
    set udg_HeroSelectGroup=CreateGroup()
    set udg_DoubleClickTimerP1=CreateTimer()
    set i=0
    loop
        exitwhen ( i > 1 )
        set udg_HasClicked[i]=false
        set i=i + 1
    endloop

    set udg_DoubleClickTimerP2=CreateTimer()
    set udg_DoubleClickTimerP3=CreateTimer()
    set udg_DoubleClickTimerP4=CreateTimer()
    set udg_DoubleClickTimerP5=CreateTimer()
    set udg_HeroPicksLeft=5
    set i=0
    loop
        exitwhen ( i > 1 )
        set udg_PlayerNumHeroes[i]=0
        set i=i + 1
    endloop

    set udg_WheelOfDeathGroup=CreateGroup()
    set udg_PatMainHall=CreateGroup()
    set udg_PatMainHallTimer=CreateTimer()
    set i=0
    loop
        exitwhen ( i > 1 )
        set udg_SlaughterTPCount[i]=0
        set i=i + 1
    endloop

    set udg_SlaughterWriteIndex=0
    set udg_SlaughterReadIndex=0
    set udg_DummyUnitId='u000'
    set udg_IsCastingGroup=CreateGroup()
    set udg_TempString=""
    set udg_SiphonAuraBuffId='B00G'
    set udg_AvatarAbilId='A01V'
    set i=0
    loop
        exitwhen ( i > 1 )
        set udg_AvatarLifeBonus[i]=0
        set i=i + 1
    endloop

    set udg_AvatarWriteIndex=0
    set udg_AvatarReadIndex=0
    set udg_StormShieldCharges=0
    set udg_ItemIdGaiaSeed='I007'
    set udg_ItemIdIdolOfResistance='I008'
    set udg_ItemIdBloodtaintedCrystal='I009'
    set udg_ItemIdLifeOrb='I00A'
    set udg_InterruptAbilId='A00Y'
    set udg_InterruptAbilOrder="thunderbolt"
    set udg_ImpaleDummyGroup=CreateGroup()
    set udg_AbilShockwaveId='A00L'
    set udg_AbilSoulCoilId='A020'
    set udg_CreepRegenIdleTime=30
    set i=0
    loop
        exitwhen ( i > 1 )
        set udg_LevelCompleted[i]=false
        set i=i + 1
    endloop

    set udg_NumLevels=7
    set udg_SunfireBeamAbilId='A027'
    set udg_FireDruidBossId='e002'
    set udg_SunfireBeamDummyId='u00J'
    set udg_CryptLordBossId='n004'
    set udg_FountainOfBloodAbilId='A028'
    set udg_SphinxBossId='u001'
    set udg_SwitcherooAbilId='A004'
    set udg_EarthSpearAbilId='A02B'
    set udg_GolemUnitId='n008'
    set udg_EarthSpearDummyAbilId='A02A'
    set udg_AscensionAbilId='A02C'
    set udg_AscensionBuffId='B00Y'
    set udg_FountainOfBloodCasterGroup=CreateGroup()
    set udg_SolarRaysAbilId='A02D'
    set udg_SolarRaysDummyAbilId='A02E'
    set udg_SolarRaysDummyGroup=CreateGroup()
    set udg_TeleportFireDruidAbilId='A02F'
    set udg_SoulCoilDummyAbilId='A021'
    set udg_LichBossId='n000'
    set udg_EarthSpearDummyId='u00L'
endfunction

//***************************************************************************
//*
//*  Custom Script Code
//*
//***************************************************************************

//***************************************************************************
//*
//*  Sound Assets
//*
//***************************************************************************

function InitSounds takes nothing returns nothing
    set gg_snd_Ambience_Dungeon=CreateSound("SND/Ambience_Dungeon.wav", false, true, true, 1, 1, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Ambience_Dungeon, 59976)
    call SetSoundChannel(gg_snd_Ambience_Dungeon, 10)
    call SetSoundVolume(gg_snd_Ambience_Dungeon, 100)
    call SetSoundPitch(gg_snd_Ambience_Dungeon, 1.0)
    call SetSoundDistances(gg_snd_Ambience_Dungeon, 300.0, 1000.0)
    call SetSoundDistanceCutoff(gg_snd_Ambience_Dungeon, 600.0)
    call SetSoundConeAngles(gg_snd_Ambience_Dungeon, 0.0, 0.0, 127)
    call SetSoundConeOrientation(gg_snd_Ambience_Dungeon, 0.0, 0.0, 0.0)
    set gg_snd_MoonWellWhat1=CreateSound("Buildings/NightElf/MoonWell/MoonWellWhat1.flac", false, true, true, 1, 1, "DefaultEAXON")
    call SetSoundParamsFromLabel(gg_snd_MoonWellWhat1, "MoonWellWhat")
    call SetSoundDuration(gg_snd_MoonWellWhat1, 2972)
    call SetSoundVolume(gg_snd_MoonWellWhat1, 100)
    call SetSoundPitch(gg_snd_MoonWellWhat1, 1.0)
    call SetSoundDistances(gg_snd_MoonWellWhat1, 300.0, 500.0)
    call SetSoundDistanceCutoff(gg_snd_MoonWellWhat1, 3000.0)
    set gg_snd_Music_AgonWastes="SND\\Music_AgonWastes.mp3"
    set gg_snd_Music_AhnQirajIntro="SND/Music_AhnQirajIntro.mp3"
    set gg_snd_QuestCompleted=CreateSound("Sound/Interface/QuestCompleted.flac", false, false, false, 1, 1, "DoodadsEAX")
    call SetSoundParamsFromLabel(gg_snd_QuestCompleted, "QuestCompleted")
    call SetSoundDuration(gg_snd_QuestCompleted, 5154)
    call SetSoundVolume(gg_snd_QuestCompleted, 80)
    set gg_snd_RockGolemWhat2=CreateSound("Units/Creeps/RockGolem/RockGolemWhat2.flac", false, true, true, 1, 1, "DefaultEAXON")
    call SetSoundParamsFromLabel(gg_snd_RockGolemWhat2, "RockGolemWhat")
    call SetSoundDuration(gg_snd_RockGolemWhat2, 2083)
    call SetSoundVolume(gg_snd_RockGolemWhat2, 100)
    call SetSoundDistances(gg_snd_RockGolemWhat2, 300.0, 500.0)
    call SetSoundDistanceCutoff(gg_snd_RockGolemWhat2, 3000.0)
    set gg_snd_Voice_Azir_AncientPowerCourses=CreateSound("SND/Voice_Azir_AncientPowerCourses.mp3", false, false, false, 1, 1, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Azir_AncientPowerCourses, 3813)
    call SetSoundChannel(gg_snd_Voice_Azir_AncientPowerCourses, 0)
    call SetSoundVolume(gg_snd_Voice_Azir_AncientPowerCourses, 127)
    call SetSoundPitch(gg_snd_Voice_Azir_AncientPowerCourses, 1.0)
    set gg_snd_Voice_Azir_DeathHow=CreateSound("SND/Voice_Azir_DeathHow.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Azir_DeathHow, 4153)
    call SetSoundChannel(gg_snd_Voice_Azir_DeathHow, 0)
    call SetSoundVolume(gg_snd_Voice_Azir_DeathHow, 127)
    call SetSoundPitch(gg_snd_Voice_Azir_DeathHow, 1.0)
    set gg_snd_Voice_Azir_SeeWhatISee=CreateSound("SND/Voice_Azir_SeeWhatISee.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Azir_SeeWhatISee, 2481)
    call SetSoundChannel(gg_snd_Voice_Azir_SeeWhatISee, 0)
    call SetSoundVolume(gg_snd_Voice_Azir_SeeWhatISee, 127)
    call SetSoundPitch(gg_snd_Voice_Azir_SeeWhatISee, 1.0)
    set gg_snd_Voice_Azir_TrustInMyVision=CreateSound("SND/Voice_Azir_TrustInMyVision.mp3", false, false, false, 1, 1, "DoodadsEAX")
    call SetSoundDuration(gg_snd_Voice_Azir_TrustInMyVision, 2168)
    call SetSoundChannel(gg_snd_Voice_Azir_TrustInMyVision, 0)
    call SetSoundVolume(gg_snd_Voice_Azir_TrustInMyVision, 127)
    call SetSoundPitch(gg_snd_Voice_Azir_TrustInMyVision, 1.0)
    set gg_snd_Voice_Azir_YouDareOppose=CreateSound("SND/Voice_Azir_YouDareOppose.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Azir_YouDareOppose, 3422)
    call SetSoundChannel(gg_snd_Voice_Azir_YouDareOppose, 0)
    call SetSoundVolume(gg_snd_Voice_Azir_YouDareOppose, 127)
    call SetSoundPitch(gg_snd_Voice_Azir_YouDareOppose, 1.0)
    set gg_snd_Voice_Azir_YourSacrifice=CreateSound("SND/Voice_Azir_YourSacrifice.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Azir_YourSacrifice, 3500)
    call SetSoundChannel(gg_snd_Voice_Azir_YourSacrifice, 0)
    call SetSoundVolume(gg_snd_Voice_Azir_YourSacrifice, 127)
    call SetSoundPitch(gg_snd_Voice_Azir_YourSacrifice, 1.0)
    set gg_snd_Voice_Lich_JudgedForDefiling=CreateSound("SND/Voice_Lich_JudgedForDefiling.wav", false, true, true, 1, 1, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Lich_JudgedForDefiling, 3889)
    call SetSoundChannel(gg_snd_Voice_Lich_JudgedForDefiling, 1)
    call SetSoundVolume(gg_snd_Voice_Lich_JudgedForDefiling, 127)
    call SetSoundPitch(gg_snd_Voice_Lich_JudgedForDefiling, 0.9)
    call SetSoundDistances(gg_snd_Voice_Lich_JudgedForDefiling, 600.0, 3500.0)
    call SetSoundDistanceCutoff(gg_snd_Voice_Lich_JudgedForDefiling, 3000.0)
    call SetSoundConeAngles(gg_snd_Voice_Lich_JudgedForDefiling, 0.0, 0.0, 127)
    call SetSoundConeOrientation(gg_snd_Voice_Lich_JudgedForDefiling, 0.0, 0.0, 0.0)
    set gg_snd_Voice_Lich_LawsOfTheAncient=CreateSound("SND/Voice_Lich_LawsOfTheAncient.wav", false, true, true, 1, 1, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Lich_LawsOfTheAncient, 3227)
    call SetSoundChannel(gg_snd_Voice_Lich_LawsOfTheAncient, 1)
    call SetSoundVolume(gg_snd_Voice_Lich_LawsOfTheAncient, 127)
    call SetSoundPitch(gg_snd_Voice_Lich_LawsOfTheAncient, 0.9)
    call SetSoundDistances(gg_snd_Voice_Lich_LawsOfTheAncient, 600.0, 3500.0)
    call SetSoundDistanceCutoff(gg_snd_Voice_Lich_LawsOfTheAncient, 3000.0)
    call SetSoundConeAngles(gg_snd_Voice_Lich_LawsOfTheAncient, 0.0, 0.0, 127)
    call SetSoundConeOrientation(gg_snd_Voice_Lich_LawsOfTheAncient, 0.0, 0.0, 0.0)
    set gg_snd_Voice_Lich_ServeToTheLast=CreateSound("SND/Voice_Lich_ServeToTheLast.wav", false, true, true, 1, 1, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Lich_ServeToTheLast, 3012)
    call SetSoundChannel(gg_snd_Voice_Lich_ServeToTheLast, 1)
    call SetSoundVolume(gg_snd_Voice_Lich_ServeToTheLast, 127)
    call SetSoundPitch(gg_snd_Voice_Lich_ServeToTheLast, 0.9)
    call SetSoundDistances(gg_snd_Voice_Lich_ServeToTheLast, 600.0, 3500.0)
    call SetSoundDistanceCutoff(gg_snd_Voice_Lich_ServeToTheLast, 3000.0)
    call SetSoundConeAngles(gg_snd_Voice_Lich_ServeToTheLast, 0.0, 0.0, 127)
    call SetSoundConeOrientation(gg_snd_Voice_Lich_ServeToTheLast, 0.0, 0.0, 0.0)
    set gg_snd_Voice_Lich_Trespassers=CreateSound("SND/Voice_Lich_Trespassers.wav", false, true, true, 1, 1, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Voice_Lich_Trespassers, 2571)
    call SetSoundChannel(gg_snd_Voice_Lich_Trespassers, 1)
    call SetSoundVolume(gg_snd_Voice_Lich_Trespassers, 127)
    call SetSoundPitch(gg_snd_Voice_Lich_Trespassers, 0.9)
    call SetSoundDistances(gg_snd_Voice_Lich_Trespassers, 600.0, 3500.0)
    call SetSoundDistanceCutoff(gg_snd_Voice_Lich_Trespassers, 3000.0)
    call SetSoundConeAngles(gg_snd_Voice_Lich_Trespassers, 0.0, 0.0, 127)
    call SetSoundConeOrientation(gg_snd_Voice_Lich_Trespassers, 0.0, 0.0, 0.0)
    set gg_snd_Yogg_BowDown=CreateSound("SND/Yogg_BowDown.mp3", false, false, false, 1, 1, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_BowDown, 9456)
    call SetSoundChannel(gg_snd_Yogg_BowDown, 0)
    call SetSoundVolume(gg_snd_Yogg_BowDown, 127)
    call SetSoundPitch(gg_snd_Yogg_BowDown, 1.0)
    set gg_snd_Yogg_DestroyThemMinion=CreateSound("SND/Yogg_DestroyThemMinion.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_DestroyThemMinion, 9874)
    call SetSoundChannel(gg_snd_Yogg_DestroyThemMinion, 0)
    call SetSoundVolume(gg_snd_Yogg_DestroyThemMinion, 127)
    call SetSoundPitch(gg_snd_Yogg_DestroyThemMinion, 1.0)
    set gg_snd_Yogg_EternalSuffering=CreateSound("SND/Yogg_EternalSuffering.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_EternalSuffering, 6582)
    call SetSoundChannel(gg_snd_Yogg_EternalSuffering, 0)
    call SetSoundVolume(gg_snd_Yogg_EternalSuffering, 127)
    call SetSoundPitch(gg_snd_Yogg_EternalSuffering, 1.0)
    set gg_snd_Yogg_Laugh=CreateSound("SND/Yogg_Laugh.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_Laugh, 14262)
    call SetSoundChannel(gg_snd_Yogg_Laugh, 0)
    call SetSoundVolume(gg_snd_Yogg_Laugh, 127)
    call SetSoundPitch(gg_snd_Yogg_Laugh, 1.0)
    set gg_snd_Yogg_Madness=CreateSound("SND/Yogg_Madness.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_Madness, 8202)
    call SetSoundChannel(gg_snd_Yogg_Madness, 0)
    call SetSoundVolume(gg_snd_Yogg_Madness, 127)
    call SetSoundPitch(gg_snd_Yogg_Madness, 1.0)
    set gg_snd_Yogg_Sound00=CreateSound("SND/Yogg_Sound00.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_Sound00, 8620)
    call SetSoundChannel(gg_snd_Yogg_Sound00, 0)
    call SetSoundVolume(gg_snd_Yogg_Sound00, 127)
    call SetSoundPitch(gg_snd_Yogg_Sound00, 1.0)
    set gg_snd_Yogg_Sound01=CreateSound("SND/Yogg_Sound01.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_Sound01, 6060)
    call SetSoundChannel(gg_snd_Yogg_Sound01, 0)
    call SetSoundVolume(gg_snd_Yogg_Sound01, 127)
    call SetSoundPitch(gg_snd_Yogg_Sound01, 1.0)
    set gg_snd_Yogg_YourWill=CreateSound("SND/Yogg_YourWill.mp3", false, false, false, 0, 0, "DefaultEAXON")
    call SetSoundDuration(gg_snd_Yogg_YourWill, 9717)
    call SetSoundChannel(gg_snd_Yogg_YourWill, 0)
    call SetSoundVolume(gg_snd_Yogg_YourWill, 127)
    call SetSoundPitch(gg_snd_Yogg_YourWill, 1.0)
endfunction

//***************************************************************************
//*
//*  Destructable Objects
//*
//***************************************************************************

function CreateAllDestructables takes nothing returns nothing
    local destructable d
    local trigger t
    local real life
    set gg_dest_Ytlc_0351=BlzCreateDestructableWithSkin('Ytlc', 256.0, 1280.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_0350=BlzCreateDestructableWithSkin('Ytlc', 128.0, 1280.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_0343=BlzCreateDestructableWithSkin('Ytlc', 0.0, 1280.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_0321=BlzCreateDestructableWithSkin('Ytlc', - 128.0, 1280.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_0186=BlzCreateDestructableWithSkin('Ytlc', - 256.0, 1280.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_3062=BlzCreateDestructableWithSkin('Ytlc', 1152.0, 12864.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_3061=BlzCreateDestructableWithSkin('Ytlc', 1280.0, 12864.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_3059=BlzCreateDestructableWithSkin('Ytlc', 1536.0, 12864.0, 270.000, 1.000, 0, 'Ytlc')
    set gg_dest_Ytlc_3060=BlzCreateDestructableWithSkin('Ytlc', 1408.0, 12864.0, 270.000, 1.000, 0, 'Ytlc')
endfunction

//***************************************************************************
//*
//*  Items
//*
//***************************************************************************

function CreateAllItems takes nothing returns nothing
    local integer itemID

    call BlzCreateItemWithSkin('I000', 10779.1, - 545.1, 'I000')
    call BlzCreateItemWithSkin('I001', 10807.3, - 469.6, 'I001')
    call BlzCreateItemWithSkin('I002', 10847.0, - 530.6, 'I002')
    call BlzCreateItemWithSkin('I003', 10763.2, - 495.7, 'I003')
    call BlzCreateItemWithSkin('I004', 10631.6, - 480.7, 'I004')
    call BlzCreateItemWithSkin('I005', 10701.1, - 475.2, 'I005')
    call BlzCreateItemWithSkin('I006', 10848.5, - 740.5, 'I006')
    call BlzCreateItemWithSkin('I006', 10794.4, - 676.4, 'I006')
    call BlzCreateItemWithSkin('I006', 10822.7, - 767.9, 'I006')
    call BlzCreateItemWithSkin('I006', 10836.5, - 686.3, 'I006')
    call BlzCreateItemWithSkin('I006', 10781.5, - 764.8, 'I006')
    call BlzCreateItemWithSkin('I006', 10806.9, - 724.9, 'I006')
    call BlzCreateItemWithSkin('I006', 10772.2, - 718.0, 'I006')
    call BlzCreateItemWithSkin('I007', 10724.4, - 557.2, 'I007')
    call BlzCreateItemWithSkin('I008', 10651.9, - 554.6, 'I008')
    call BlzCreateItemWithSkin('I00A', 10597.6, - 738.0, 'I00A')
    call BlzCreateItemWithSkin('I00A', 10630.8, - 703.1, 'I00A')
    call BlzCreateItemWithSkin('I00A', 10598.8, - 703.1, 'I00A')
    call BlzCreateItemWithSkin('I00A', 10634.5, - 658.7, 'I00A')
    call BlzCreateItemWithSkin('I00A', 10594.5, - 660.9, 'I00A')
    call BlzCreateItemWithSkin('I00A', 10634.8, - 742.3, 'I00A')
endfunction

//***************************************************************************
//*
//*  Unit Creation
//*
//***************************************************************************

//===========================================================================
function CreateUnitsForPlayer6 takes nothing returns nothing
    local player p= Player(6)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set gg_unit_E006_0041=BlzCreateUnitWithSkin(p, 'E006', 9822.9, 414.6, 314.586, 'E006')
    call SetHeroLevel(gg_unit_E006_0041, 10, false)
    call SetUnitState(gg_unit_E006_0041, UNIT_STATE_MANA, 200)
    call SetUnitColor(gg_unit_E006_0041, ConvertPlayerColor(5))
    call SelectHeroSkill(gg_unit_E006_0041, 'A015')
    call SelectHeroSkill(gg_unit_E006_0041, 'A015')
    call SelectHeroSkill(gg_unit_E006_0041, 'A015')
    call IssueImmediateOrder(gg_unit_E006_0041, "")
    call SelectHeroSkill(gg_unit_E006_0041, 'A01A')
    call SelectHeroSkill(gg_unit_E006_0041, 'A01A')
    call SelectHeroSkill(gg_unit_E006_0041, 'A01A')
    call IssueImmediateOrder(gg_unit_E006_0041, "")
    call SelectHeroSkill(gg_unit_E006_0041, 'A017')
    call SelectHeroSkill(gg_unit_E006_0041, 'A017')
    call IssueImmediateOrder(gg_unit_E006_0041, "")
    call SelectHeroSkill(gg_unit_E006_0041, 'A016')
    call SelectHeroSkill(gg_unit_E006_0041, 'A016')
    call IssueImmediateOrder(gg_unit_E006_0041, "")
    set gg_unit_E001_0042=BlzCreateUnitWithSkin(p, 'E001', 9687.0, 259.2, 331.569, 'E001')
    call SetHeroLevel(gg_unit_E001_0042, 10, false)
    call SetUnitState(gg_unit_E001_0042, UNIT_STATE_MANA, 200)
    call SetUnitColor(gg_unit_E001_0042, ConvertPlayerColor(20))
    call SelectHeroSkill(gg_unit_E001_0042, 'A00J')
    call SelectHeroSkill(gg_unit_E001_0042, 'A00J')
    call SelectHeroSkill(gg_unit_E001_0042, 'A00J')
    call IssueImmediateOrder(gg_unit_E001_0042, "")
    call IssueImmediateOrder(gg_unit_E001_0042, "")
    call SelectHeroSkill(gg_unit_E001_0042, 'A016')
    call IssueImmediateOrder(gg_unit_E001_0042, "")
    call SelectHeroSkill(gg_unit_E001_0042, 'A01I')
    call SelectHeroSkill(gg_unit_E001_0042, 'A01I')
    call SelectHeroSkill(gg_unit_E001_0042, 'A01I')
    call SelectHeroSkill(gg_unit_E001_0042, 'A01I')
    call IssueImmediateOrder(gg_unit_E001_0042, "")
    call SelectHeroSkill(gg_unit_E001_0042, 'A01J')
    call IssueImmediateOrder(gg_unit_E001_0042, "")
    set gg_unit_E007_0043=BlzCreateUnitWithSkin(p, 'E007', 10785.7, 414.7, 225.719, 'E007')
    call SetHeroLevel(gg_unit_E007_0043, 10, false)
    call SetUnitColor(gg_unit_E007_0043, ConvertPlayerColor(3))
    call IssueImmediateOrder(gg_unit_E007_0043, "")
    call SelectHeroSkill(gg_unit_E007_0043, 'A01G')
    call IssueImmediateOrder(gg_unit_E007_0043, "")
    call SelectHeroSkill(gg_unit_E007_0043, 'A01O')
    call SelectHeroSkill(gg_unit_E007_0043, 'A01O')
    call SelectHeroSkill(gg_unit_E007_0043, 'A01O')
    call IssueImmediateOrder(gg_unit_E007_0043, "")
    call SelectHeroSkill(gg_unit_E007_0043, 'A01S')
    call SelectHeroSkill(gg_unit_E007_0043, 'A01S')
    call SelectHeroSkill(gg_unit_E007_0043, 'A01S')
    call IssueImmediateOrder(gg_unit_E007_0043, "")
    call SelectHeroSkill(gg_unit_E007_0043, 'A01N')
    call SelectHeroSkill(gg_unit_E007_0043, 'A01N')
    call IssueImmediateOrder(gg_unit_E007_0043, "")
    call SelectHeroSkill(gg_unit_E007_0043, 'A01Y')
    call SelectHeroSkill(gg_unit_E007_0043, 'A01Y')
    call IssueImmediateOrder(gg_unit_E007_0043, "")
    set gg_unit_O001_0044=BlzCreateUnitWithSkin(p, 'O001', 10063.9, 516.3, 292.287, 'O001')
    call SetHeroLevel(gg_unit_O001_0044, 10, false)
    call SetUnitColor(gg_unit_O001_0044, ConvertPlayerColor(10))
    call SelectHeroSkill(gg_unit_O001_0044, 'A00X')
    call SelectHeroSkill(gg_unit_O001_0044, 'A00X')
    call SelectHeroSkill(gg_unit_O001_0044, 'A00X')
    call IssueImmediateOrder(gg_unit_O001_0044, "")
    call SelectHeroSkill(gg_unit_O001_0044, 'A001')
    call SelectHeroSkill(gg_unit_O001_0044, 'A001')
    call IssueImmediateOrder(gg_unit_O001_0044, "")
    call SelectHeroSkill(gg_unit_O001_0044, 'A01C')
    call SelectHeroSkill(gg_unit_O001_0044, 'A01C')
    call IssueImmediateOrder(gg_unit_O001_0044, "")
    call SelectHeroSkill(gg_unit_O001_0044, 'A01T')
    call SelectHeroSkill(gg_unit_O001_0044, 'A01T')
    call SelectHeroSkill(gg_unit_O001_0044, 'A01T')
    call IssueImmediateOrder(gg_unit_O001_0044, "")
    call SelectHeroSkill(gg_unit_O001_0044, 'A01G')
    call SelectHeroSkill(gg_unit_O001_0044, 'A01G')
    call SelectHeroSkill(gg_unit_O001_0044, 'A01G')
    call IssueImmediateOrder(gg_unit_O001_0044, "")
    set gg_unit_U00I_0045=BlzCreateUnitWithSkin(p, 'U00I', 10932.2, 266.1, 208.703, 'U00I')
    call SetHeroLevel(gg_unit_U00I_0045, 10, false)
    call SetUnitColor(gg_unit_U00I_0045, ConvertPlayerColor(11))
    call SelectHeroSkill(gg_unit_U00I_0045, 'A011')
    call SelectHeroSkill(gg_unit_U00I_0045, 'A011')
    call IssueImmediateOrder(gg_unit_U00I_0045, "")
    call SelectHeroSkill(gg_unit_U00I_0045, 'A013')
    call SelectHeroSkill(gg_unit_U00I_0045, 'A013')
    call IssueImmediateOrder(gg_unit_U00I_0045, "")
    call SelectHeroSkill(gg_unit_U00I_0045, 'A014')
    call SelectHeroSkill(gg_unit_U00I_0045, 'A014')
    call SelectHeroSkill(gg_unit_U00I_0045, 'A014')
    call IssueImmediateOrder(gg_unit_U00I_0045, "")
    call SelectHeroSkill(gg_unit_U00I_0045, 'A00D')
    call SelectHeroSkill(gg_unit_U00I_0045, 'A00D')
    call SelectHeroSkill(gg_unit_U00I_0045, 'A00D')
    call IssueImmediateOrder(gg_unit_U00I_0045, "")
    set gg_unit_N001_0046=BlzCreateUnitWithSkin(p, 'N001', 10305.4, 579.6, 270.120, 'N001')
    call SetHeroLevel(gg_unit_N001_0046, 10, false)
    call SetUnitColor(gg_unit_N001_0046, ConvertPlayerColor(23))
    call SelectHeroSkill(gg_unit_N001_0046, 'A00F')
    call SelectHeroSkill(gg_unit_N001_0046, 'A00F')
    call IssueImmediateOrder(gg_unit_N001_0046, "")
    call SelectHeroSkill(gg_unit_N001_0046, 'A01N')
    call SelectHeroSkill(gg_unit_N001_0046, 'A01N')
    call SelectHeroSkill(gg_unit_N001_0046, 'A01N')
    call IssueImmediateOrder(gg_unit_N001_0046, "")
    call SelectHeroSkill(gg_unit_N001_0046, 'A01C')
    call SelectHeroSkill(gg_unit_N001_0046, 'A01C')
    call SelectHeroSkill(gg_unit_N001_0046, 'A01C')
    call IssueImmediateOrder(gg_unit_N001_0046, "")
    call SelectHeroSkill(gg_unit_N001_0046, 'A01W')
    call SelectHeroSkill(gg_unit_N001_0046, 'A01W')
    call SelectHeroSkill(gg_unit_N001_0046, 'A01W')
    call IssueImmediateOrder(gg_unit_N001_0046, "")
    call SelectHeroSkill(gg_unit_N001_0046, 'A023')
    call SelectHeroSkill(gg_unit_N001_0046, 'A023')
    call SelectHeroSkill(gg_unit_N001_0046, 'A023')
    call IssueImmediateOrder(gg_unit_N001_0046, "")
    call SelectHeroSkill(gg_unit_N001_0046, 'A024')
    call SelectHeroSkill(gg_unit_N001_0046, 'A024')
    call IssueImmediateOrder(gg_unit_N001_0046, "")
    set gg_unit_N00F_0047=BlzCreateUnitWithSkin(p, 'N00F', 10555.0, 513.1, 247.171, 'N00F')
    call SetHeroLevel(gg_unit_N00F_0047, 10, false)
    call SetUnitColor(gg_unit_N00F_0047, ConvertPlayerColor(9))
    call SelectHeroSkill(gg_unit_N00F_0047, 'A01Q')
    call SelectHeroSkill(gg_unit_N00F_0047, 'A01Q')
    call SelectHeroSkill(gg_unit_N00F_0047, 'A01Q')
    call IssueImmediateOrder(gg_unit_N00F_0047, "")
    call SelectHeroSkill(gg_unit_N00F_0047, 'A002')
    call SelectHeroSkill(gg_unit_N00F_0047, 'A002')
    call SelectHeroSkill(gg_unit_N00F_0047, 'A002')
    call IssueImmediateOrder(gg_unit_N00F_0047, "")
    call SelectHeroSkill(gg_unit_N00F_0047, 'A01T')
    call SelectHeroSkill(gg_unit_N00F_0047, 'A01T')
    call IssueImmediateOrder(gg_unit_N00F_0047, "")
    call SelectHeroSkill(gg_unit_N00F_0047, 'A01V')
    call SelectHeroSkill(gg_unit_N00F_0047, 'A01V')
    call IssueImmediateOrder(gg_unit_N00F_0047, "")
endfunction

//===========================================================================
function CreateNeutralHostileBuildings takes nothing returns nothing
    local player p= Player(PLAYER_NEUTRAL_AGGRESSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=BlzCreateUnitWithSkin(p, 'nfgo', - 3776.0, 17984.0, 270.000, 'nfgo')
endfunction

//===========================================================================
function CreateNeutralHostile takes nothing returns nothing
    local player p= Player(PLAYER_NEUTRAL_AGGRESSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=BlzCreateUnitWithSkin(p, 'u001', 7422.5, 10494.4, 261.416, 'u001')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n000', - 1.6, 9.2, 270.000, 'n000')
    call SetUnitColor(u, ConvertPlayerColor(10))
    set u=BlzCreateUnitWithSkin(p, 'n005', - 2502.2, 10415.9, 318.445, 'n005')
    call SetUnitColor(u, ConvertPlayerColor(9))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2450.3, - 1318.4, 250.986, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 3087.6, - 1694.8, 348.721, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2036.5, - 2002.5, 159.710, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2655.7, - 2385.2, 85.870, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2987.4, - 2201.7, 47.722, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 3075.9, - 2011.7, 25.618, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2460.8, - 2376.3, 104.507, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2132.2, - 2193.1, 139.973, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2033.4, - 1676.4, 191.054, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2120.3, - 1509.3, 209.650, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 2713.8, - 1325.5, 282.300, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 3008.7, - 1538.7, 327.652, 'u003')
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'n007', - 451.5, - 931.1, 280.000, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 365.7, - 917.2, 260.000, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u001', 7588.9, 10459.8, 244.743, 'u001')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 2308.1, 6452.7, 244.368, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 2144.7, 2491.1, 169.267, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n00G', - 2602.2, 6337.4, 315.000, 'n00G')
    set u=BlzCreateUnitWithSkin(p, 'n007', 2094.8, 2159.1, 152.389, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 1855.6, 1949.9, 123.857, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e002', - 9598.6, 6202.8, 0.000, 'e002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n008', 10811.7, - 1500.8, 171.843, 'n008')
    set u=BlzCreateUnitWithSkin(p, 'n00A', - 519.3, 16034.6, 269.513, 'n00A')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n00B', 624.8, 16033.9, 264.214, 'n00B')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u001', 7076.8, 10471.3, 295.432, 'u001')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u001', 7233.1, 10500.2, 280.202, 'u001')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n002', 6787.5, 3079.7, 182.370, 'n002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u004', 1339.0, 5782.1, 270.000, 'u004')
    call SetUnitState(u, UNIT_STATE_MANA, 350)
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u00B', - 8703.7, 16640.1, 329.830, 'u00B')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n003', 1265.1, 5884.8, 270.000, 'n003')
    call SetUnitState(u, UNIT_STATE_MANA, 350)
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n003', 1412.3, 5886.9, 270.000, 'n003')
    call SetUnitState(u, UNIT_STATE_MANA, 350)
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u006', 2497.3, 4675.0, 140.700, 'u006')
    call SetUnitState(u, UNIT_STATE_MANA, 350)
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 2314.2, 4844.5, 145.897, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 2301.7, 4478.2, 176.286, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 2676.2, 4855.3, 96.316, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u006', 185.6, 7011.3, 312.830, 'u006')
    call SetUnitState(u, UNIT_STATE_MANA, 350)
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 361.8, 6798.3, 312.683, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 1.3, 6794.1, 271.802, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n007', 381.9, 7144.0, 355.374, 'n007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u003', 2488.7, 6602.4, 92.158, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'n002', 195.9, 4663.8, 270.000, 'n002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 121.3, 4479.9, 33.001, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', - 112.2, 4876.7, 323.778, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 190.7, 5046.2, 267.681, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 520.3, 4850.6, 208.154, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 509.3, 4468.4, 147.282, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 189.2, 4299.2, 92.158, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'n002', 2495.4, 6967.0, 270.000, 'n002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u003', 2178.2, 6783.1, 33.001, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 2187.3, 7179.9, 323.778, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 2490.2, 7349.4, 267.681, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 2819.8, 7153.8, 208.154, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'u003', 2808.8, 6771.6, 147.282, 'u003')
    call SetUnitState(u, UNIT_STATE_MANA, 100)
    call SetUnitColor(u, ConvertPlayerColor(8))
    set u=BlzCreateUnitWithSkin(p, 'h001', - 948.2, 13659.7, 207.395, 'h001')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n006', 507.5, 9760.9, 270.940, 'n006')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 2833.5, 5926.1, 67.267, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 2794.9, 6152.9, 293.899, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 2577.7, 6044.3, 347.343, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 2369.6, 6234.4, 87.884, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 1610.4, 3961.2, 244.368, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n00G', - 1637.6, 3688.4, 125.000, 'n00G')
    set u=BlzCreateUnitWithSkin(p, 'e004', - 2088.0, 3453.3, 3.226, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 2125.9, 3685.7, 121.391, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 1880.0, 3552.8, 223.662, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 1804.1, 3846.3, 23.545, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u004', - 4365.0, 4013.7, 0.000, 'u004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 4798.0, 4414.1, 257.820, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 4923.1, 4291.2, 12.810, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 4790.6, 3777.4, 11.993, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 4604.2, 4199.4, 255.666, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 4116.2, 4493.0, 255.442, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'e004', - 4635.5, 3627.4, 98.255, 'e004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n006', 2182.9, 9735.6, 265.652, 'n006')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u009', 5726.4, 6966.9, 93.799, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'u009', 5817.9, 8532.9, 0.365, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'n002', 7307.8, 7909.4, 183.617, 'n002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u009', 7902.0, 3707.7, 92.436, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'u009', 8865.0, 3659.4, 1.563, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'n002', 9398.2, 4655.3, 266.358, 'n002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u00F', 9894.7, 3216.8, 228.292, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u009', 9450.1, 6804.3, 3.301, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'u009', 8933.5, 8454.8, 177.217, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'u00F', 5764.5, 3167.4, 230.006, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 5757.9, 5391.9, 62.327, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 5129.1, 8260.6, 293.146, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 7967.3, 8264.2, 271.008, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 7657.7, 6306.1, 237.685, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 8808.9, 6293.0, 221.206, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 8279.0, 3379.7, 283.434, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 8911.7, 5200.1, 85.828, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u007', 3802.7, 10348.0, 99.517, 'u007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u00F', 9701.5, 7470.9, 292.992, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 6206.4, 7851.1, 162.921, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 4962.5, 4167.4, 343.454, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u00F', 7286.6, 4142.7, 6.988, 'u00F')
    set u=BlzCreateUnitWithSkin(p, 'u007', 3691.9, 10176.7, 328.435, 'u007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u009', - 6303.4, 14884.1, 276.621, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'u009', - 5796.8, 14886.9, 273.278, 'u009')
    call SetUnitColor(u, ConvertPlayerColor(11))
    set u=BlzCreateUnitWithSkin(p, 'u007', 3729.4, 10094.7, 38.618, 'u007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u007', 3846.3, 10091.8, 25.753, 'u007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u007', 3952.8, 10203.6, 32.455, 'u007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u007', 3984.3, 10348.0, 185.993, 'u007')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', 7428.6, - 1360.0, 3.047, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', 7795.2, - 1474.0, 331.960, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', 7515.6, - 1665.8, 72.516, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n00I', 9041.6, - 2444.0, 53.510, 'n00I')
    call SetUnitColor(u, ConvertPlayerColor(20))
    set u=BlzCreateUnitWithSkin(p, 'n00I', 9454.3, - 2367.0, 93.975, 'n00I')
    call SetUnitColor(u, ConvertPlayerColor(20))
    set u=BlzCreateUnitWithSkin(p, 'u002', 7672.4, - 1216.5, 280.186, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', 7760.1, - 1697.4, 102.302, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', 7570.5, - 1469.2, 194.122, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'n009', 6123.8, - 2501.4, 158.080, 'n009')
    set u=BlzCreateUnitWithSkin(p, 'n009', 5898.8, - 2717.6, 93.156, 'n009')
    set u=BlzCreateUnitWithSkin(p, 'n009', 6097.4, - 3001.6, 63.404, 'n009')
    set u=BlzCreateUnitWithSkin(p, 'n008', 809.1, - 2514.9, 232.948, 'n008')
    set u=BlzCreateUnitWithSkin(p, 'n008', - 366.1, - 2468.3, 359.448, 'n008')
    set u=BlzCreateUnitWithSkin(p, 'n008', 529.6, - 3350.0, 325.940, 'n008')
    set u=BlzCreateUnitWithSkin(p, 'n009', 6199.5, - 2790.9, 246.277, 'n009')
    set u=BlzCreateUnitWithSkin(p, 'n00J', 1068.1, 11448.2, 288.121, 'n00J')
    set u=BlzCreateUnitWithSkin(p, 'n00J', 1360.0, 11456.2, 270.757, 'n00J')
    set u=BlzCreateUnitWithSkin(p, 'n00J', 1616.5, 11438.1, 246.617, 'n00J')
    set u=BlzCreateUnitWithSkin(p, 'n004', 8072.7, 383.5, 295.196, 'n004')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 876.6, - 3924.1, 193.995, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 700.8, - 4051.1, 256.552, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1339.2, - 4121.4, 10.475, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1071.6, - 4347.0, 301.818, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 916.7, - 3713.2, 190.530, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1302.6, - 4351.6, 42.521, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1588.8, - 4032.8, 105.112, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1105.4, - 3960.6, 80.650, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1144.6, - 3663.9, 84.276, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1100.7, - 4162.0, 161.698, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 832.9, - 4238.7, 307.812, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
    set u=BlzCreateUnitWithSkin(p, 'u002', - 1317.9, - 3864.6, 143.736, 'u002')
    call SetUnitColor(u, ConvertPlayerColor(24))
endfunction

//===========================================================================
function CreateNeutralPassive takes nothing returns nothing
    local player p= Player(PLAYER_NEUTRAL_PASSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=BlzCreateUnitWithSkin(p, 'n00D', - 715.3, 2978.7, 315.000, 'n00D')
    set u=BlzCreateUnitWithSkin(p, 'n00D', 1729.2, - 3271.2, 270.978, 'n00D')
    set u=BlzCreateUnitWithSkin(p, 'n00D', - 7614.1, 3837.3, 345.810, 'n00D')
    set u=BlzCreateUnitWithSkin(p, 'n00D', 5162.6, 10058.2, 266.679, 'n00D')
    set u=BlzCreateUnitWithSkin(p, 'n00D', 1712.1, 13914.2, 217.441, 'n00D')
    set u=BlzCreateUnitWithSkin(p, 'n00D', - 684.7, 9938.7, 266.868, 'n00D')
    set u=BlzCreateUnitWithSkin(p, 'n00D', - 7754.8, 14927.2, 303.785, 'n00D')
endfunction

//===========================================================================
function CreatePlayerBuildings takes nothing returns nothing
endfunction

//===========================================================================
function CreatePlayerUnits takes nothing returns nothing
    call CreateUnitsForPlayer6()
endfunction

//===========================================================================
function CreateAllUnits takes nothing returns nothing
    call CreateNeutralHostileBuildings()
    call CreatePlayerBuildings()
    call CreateNeutralHostile()
    call CreateNeutralPassive()
    call CreateUnitsForPlayer6() // INLINED!!
endfunction

//***************************************************************************
//*
//*  Regions
//*
//***************************************************************************

function CreateRegions takes nothing returns nothing
    local weathereffect we

    set gg_rct_AbilFireDruidBossTpOrigin=Rect(- 9280.0, 6144.0, - 9152.0, 6272.0)
    set gg_rct_AbilLichBossClonesOrigin=Rect(- 64.0, - 128.0, 64.0, 0.0)
    set gg_rct_AmbienceDungeon00=Rect(- 960.0, 1728.0, 2176.0, 4576.0)
    call SetSoundPosition(gg_snd_Ambience_Dungeon, 608.0, 3152.0, - 11.6)
    call RegisterStackedSound(gg_snd_Ambience_Dungeon, true, 3136.0, 2848.0)
    set gg_rct_AmbienceDungeon02=Rect(- 1024.0, 3520.0, 3712.0, 8224.0)
    set gg_rct_Center=Rect(- 64.0, - 64.0, 64.0, 64.0)
    set gg_rct_EnvAQDoorBig0=Rect(- 320.0, 1216.0, 320.0, 1344.0)
    set gg_rct_EnvAQDoorSmall0A=Rect(1088.0, 12800.0, 1248.0, 12928.0)
    set gg_rct_EnvAQDoorSmall0B=Rect(1248.0, 12800.0, 1408.0, 12928.0)
    set gg_rct_EnvAQDoorSmall0C=Rect(1408.0, 12800.0, 1568.0, 12928.0)
    set gg_rct_HeroSelection=Rect(9600.0, - 96.0, 11040.0, 704.0)
    set gg_rct_LandmarkCircleOfCultists=Rect(- 3328.0, - 2624.0, - 1792.0, - 1088.0)
    set gg_rct_LandmarkCircleOfCultistsAggro=Rect(- 2848.0, - 2144.0, - 2272.0, - 1568.0)
    set gg_rct_Level01CamBounds=Rect(5472.0, - 3552.0, 11552.0, 1152.0)
    set gg_rct_Level01Exit=Rect(7808.0, 704.0, 8576.0, 832.0)
    set gg_rct_Level01Revive=Rect(10528.0, - 384.0, 10656.0, - 256.0)
    set gg_rct_Level02CamBounds=Rect(- 10176.0, 3040.0, - 1312.0, 7264.0)
    set gg_rct_Level02Exit=Rect(- 7456.0, 7072.0, - 6688.0, 7200.0)
    set gg_rct_Level02Revive=Rect(- 6816.0, 3648.0, - 6688.0, 3776.0)
    set gg_rct_Level02Start=Rect(- 7072.0, 3648.0, - 6848.0, 3872.0)
    set gg_rct_Level03CamBounds=Rect(- 1792.0, - 4576.0, 1920.0, 1632.0)
    set gg_rct_Level03Exit=Rect(- 384.0, 1280.0, 384.0, 1408.0)
    set gg_rct_Level03Revive=Rect(1440.0, - 3616.0, 1568.0, - 3488.0)
    set gg_rct_Level03Start=Rect(1696.0, - 3712.0, 1952.0, - 3488.0)
    set gg_rct_Level04CamBounds=Rect(4256.0, 8704.0, 10528.0, 11168.0)
    set gg_rct_Level04Exit=Rect(9088.0, 9472.0, 9344.0, 10080.0)
    set gg_rct_Level04Revive=Rect(5248.0, 9728.0, 5376.0, 9856.0)
    set gg_rct_Level04Start=Rect(4992.0, 9632.0, 5248.0, 9856.0)
    set gg_rct_Level05CamBounds=Rect(- 1952.0, 12960.0, 2400.0, 16864.0)
    set gg_rct_Level05Exit=Rect(- 736.0, 13728.0, - 576.0, 14432.0)
    set gg_rct_Level05Revive=Rect(1408.0, 13536.0, 1536.0, 13664.0)
    set gg_rct_Level05Start=Rect(1184.0, 13248.0, 1440.0, 13472.0)
    set gg_rct_Level06CamBounds=Rect(- 4416.0, 9184.0, - 64.0, 12096.0)
    set gg_rct_Level06Exit=Rect(- 3040.0, 12032.0, - 2016.0, 12192.0)
    set gg_rct_Level06Revive=Rect(- 416.0, 9792.0, - 288.0, 9920.0)
    set gg_rct_Level06Start=Rect(- 448.0, 9536.0, - 160.0, 9792.0)
    set gg_rct_Level07CamBounds=Rect(- 10784.0, 13760.0, - 6464.0, 18368.0)
    set gg_rct_Level07Revive=Rect(- 7296.0, 14272.0, - 7168.0, 14400.0)
    set gg_rct_Level07Start=Rect(- 7104.0, 14304.0, - 6816.0, 14560.0)
    set gg_rct_PatrolMainHallCenter=Rect(1216.0, 5696.0, 1472.0, 5952.0)
    set gg_rct_PatrolMainHallEast=Rect(3264.0, 5696.0, 3520.0, 5952.0)
    set gg_rct_PatrolMainHallNorth=Rect(1216.0, 7872.0, 1472.0, 8128.0)
    set gg_rct_PatrolMainHallSouth=Rect(1216.0, 3648.0, 1472.0, 3904.0)
    set gg_rct_PatrolMainHallWest=Rect(- 832.0, 5696.0, - 576.0, 5952.0)
    set gg_rct_WeatherGreenFogHeavy00=Rect(4384.0, 2816.0, 10304.0, 8768.0)
    set we=AddWeatherEffect(gg_rct_WeatherGreenFogHeavy00, 'FDgh')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherOutlandWindLight00=Rect(- 128.0, - 1792.0, 0.0, - 1664.0)
    set we=AddWeatherEffect(gg_rct_WeatherOutlandWindLight00, 'WOlw')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherOutlandWindLight01=Rect(- 1088.0, - 1792.0, - 960.0, - 1664.0)
    set we=AddWeatherEffect(gg_rct_WeatherOutlandWindLight01, 'WOlw')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherOutlandWindLight02=Rect(768.0, - 1152.0, 896.0, - 1024.0)
    set we=AddWeatherEffect(gg_rct_WeatherOutlandWindLight02, 'WOlw')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherOutlandWindLight03=Rect(0.0, - 2752.0, 128.0, - 2624.0)
    set we=AddWeatherEffect(gg_rct_WeatherOutlandWindLight03, 'WOlw')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherOutlandWindLight04=Rect(1024.0, - 3424.0, 1152.0, - 3296.0)
    set we=AddWeatherEffect(gg_rct_WeatherOutlandWindLight04, 'WOlw')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherOutlandWindLight05=Rect(- 256.0, - 5184.0, - 128.0, - 5056.0)
    set we=AddWeatherEffect(gg_rct_WeatherOutlandWindLight05, 'WOlw')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherOutlandWindLight06=Rect(736.0, - 5472.0, 864.0, - 5344.0)
    set we=AddWeatherEffect(gg_rct_WeatherOutlandWindLight06, 'WOlw')
    call EnableWeatherEffect(we, true)
    set gg_rct_WeatherWhiteFogHeavy00=Rect(- 1280.0, 9440.0, - 128.0, 9920.0)
    set we=AddWeatherEffect(gg_rct_WeatherWhiteFogHeavy00, 'FDwh')
    call EnableWeatherEffect(we, true)
endfunction

//***************************************************************************
//*
//*  Cameras
//*
//***************************************************************************

function CreateCameras takes nothing returns nothing

    set gg_cam_TopDown=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_ROTATION, 89.7, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_ANGLE_OF_ATTACK, 270.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_TARGET_DISTANCE, 1650.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_NEARZ, 16.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_LOCAL_PITCH, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_LOCAL_YAW, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_TopDown, CAMERA_FIELD_LOCAL_ROLL, 0.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_TopDown, 4340.1, 1636.5, 0.0)

endfunction

//***************************************************************************
//*
//*  Triggers
//*
//***************************************************************************

//===========================================================================
// Trigger: IsUnitCasting
//===========================================================================
function IsUnitCasting takes unit u returns boolean
    return IsUnitInGroup(u, udg_IsCastingGroup)
endfunction
//===========================================================================
function InitTrig_IsUnitCasting takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: IsCastingBegin
//===========================================================================
function Trig_IsCastingBegin_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_IsCastingBegin_Actions takes nothing returns nothing
    call GroupAddUnitSimple(GetTriggerUnit(), udg_IsCastingGroup)
endfunction

//===========================================================================
function InitTrig_IsCastingBegin takes nothing returns nothing
    set gg_trg_IsCastingBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_IsCastingBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_IsCastingBegin, Condition(function Trig_IsCastingBegin_Conditions))
    call TriggerAddAction(gg_trg_IsCastingBegin, function Trig_IsCastingBegin_Actions)
endfunction

//===========================================================================
// Trigger: IsCastingCleanup
//===========================================================================
function Trig_IsCastingCleanup_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_IsCastingCleanup_Actions takes nothing returns nothing
    call GroupRemoveUnitSimple(GetTriggerUnit(), udg_IsCastingGroup)
endfunction

//===========================================================================
function InitTrig_IsCastingCleanup takes nothing returns nothing
    set gg_trg_IsCastingCleanup=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_IsCastingCleanup, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_IsCastingCleanup, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_IsCastingCleanup, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_IsCastingCleanup, Condition(function Trig_IsCastingCleanup_Conditions))
    call TriggerAddAction(gg_trg_IsCastingCleanup, function Trig_IsCastingCleanup_Actions)
endfunction

//===========================================================================
// Trigger: ShouldUnitUseAbility
//===========================================================================
function ShouldUnitUseAbility takes unit u,integer abilId,real lifePercent returns boolean
    if GetUnitAbilityLevel(u, abilId) > 0 then
    if BlzGetUnitAbilityCooldownRemaining(u, abilId) == 0.0 then
    if not (IsUnitInGroup((u), udg_IsCastingGroup)) then // INLINED!!
    if GetUnitState(u, UNIT_STATE_LIFE) / GetUnitState(u, UNIT_STATE_MAX_LIFE) <= lifePercent then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

//===========================================================================
function InitTrig_ShouldUnitUseAbility takes nothing returns nothing
    set gg_trg_ShouldUnitUseAbility=CreateTrigger()
endfunction

//===========================================================================
// Trigger: DispelUnit
//===========================================================================
function DispelUnit takes unit target,boolean buffs,boolean debuffs returns nothing
    if buffs then
        call UnitRemoveAbility(target, 'B002') // Rejuvenation (Sphinx Councillor)
        call UnitRemoveAbility(target, EARTH_SHIELD_BUFF_ID)
        call UnitRemoveAbility(target, EARTH_SHIELD_BUFF_LEVEL_ID)
        call UnitRemoveAbility(target, 'B00J') // Sunfire Blades
        call UnitRemoveAbility(target, 'B00K') // Sunfire Blessing
        call UnitRemoveAbility(target, 'B00H') // Wheel of Death
    endif
    if debuffs then
        call UnitRemoveAbility(target, 'Bapl') // Plague
        call UnitRemoveAbility(target, 'B005') // Jinx
        call UnitRemoveAbility(target, 'B00N') // Dark Slumber
    endif
endfunction
//===========================================================================
function InitTrig_DispelUnit takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: EnemyUseAbility
//===========================================================================
function IsAbilityCooldownDone takes unit u,integer abilityId returns boolean
    return BlzGetUnitAbilityCooldownRemaining(u, abilityId) == 0.0
endfunction

function SetEnemyAbilityAvailability takes unit enemy,real hpPercentUse,integer abilityId returns nothing
    local real percentHealth= GetUnitState(enemy, UNIT_STATE_LIFE) / GetUnitState(enemy, UNIT_STATE_MAX_LIFE)
    local integer abilityLevel= GetUnitAbilityLevel(enemy, abilityId)
    
    if percentHealth > hpPercentUse and abilityLevel > 0 then
        call UnitRemoveAbility(enemy, abilityId)
    elseif percentHealth <= hpPercentUse and abilityLevel == 0 then
        call UnitAddAbility(enemy, abilityId)
    endif
endfunction



function EnemyUseInstantAbility takes unit enemy,integer abilityId,string order,real hpPercentUse returns nothing
    call SetEnemyAbilityAvailability(enemy , hpPercentUse , abilityId)
    
    if (BlzGetUnitAbilityCooldownRemaining((enemy ), ( abilityId)) == 0.0) then // INLINED!!
        call IssueImmediateOrder(enemy, order)
    endif
endfunction

function EnemyUseTargetPointAbility takes unit enemy,integer abilityId,string order,real hpPercentUse,real x,real y returns nothing
    call SetEnemyAbilityAvailability(enemy , hpPercentUse , abilityId)
    
    if (BlzGetUnitAbilityCooldownRemaining((enemy ), ( abilityId)) == 0.0) then // INLINED!!
        call IssuePointOrder(enemy, order, x, y)
    endif
endfunction

function EnemyUseTargetUnitAbility takes unit enemy,integer abilityId,string order,real hpPercentUse,unit target returns nothing
    call SetEnemyAbilityAvailability(enemy , hpPercentUse , abilityId)
    
    if (BlzGetUnitAbilityCooldownRemaining((enemy ), ( abilityId)) == 0.0) then // INLINED!!
        call IssueTargetOrder(enemy, order, target)
    endif
endfunction

//===========================================================================
function InitTrig_EnemyUseAbility takes nothing returns nothing
endfunction


//===========================================================================
// Trigger: IsUnitStatusImmune
//===========================================================================
function CreateImmuneFloatingText takes unit target returns nothing
    local string text= "Immune"
    local location targLoc= GetUnitLoc(target)
    local location textLoc= PolarProjectionBJ(targLoc, ( 10.00 * I2R(StringLength(text)) ), 180.00)
    local texttag ttag= CreateTextTag()
    
    call SetTextTagTextBJ(ttag, text, 11.0)
    call SetTextTagPosBJ(ttag, textLoc, 200.0)
    call SetTextTagColorBJ(ttag, 50.0, 50.0, 100.0, 0.0)
    call SetTextTagVelocityBJ(ttag, 60.0, 90.0)
    call SetTextTagPermanentBJ(ttag, false)
    call SetTextTagLifespanBJ(ttag, 2.0)
    call SetTextTagFadepointBJ(ttag, 1.0)
    
    set text=null
    call RemoveLocation(targLoc)
    set targLoc=null
    call RemoveLocation(textLoc)
    set textLoc=null
    set ttag=null
endfunction

function IsUnitStatusImmune takes unit target returns boolean
    if GetUnitAbilityLevel(target, 'Avul') > 0 then
    if GetUnitAbilityLevel(target, 'B00H') > 0 then // Wheel of Death
        call CreateImmuneFloatingText(target)
        return true
    endif
    endif
    return false
endfunction
//===========================================================================
function InitTrig_IsUnitStatusImmune takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: InterruptTarget
//===========================================================================
function InterruptTarget takes unit target,unit caster returns nothing
    local location l= null
    local unit dummy= null
    
    if not IsUnitStatusImmune(target) then
        set l=GetUnitLoc(target)
        set dummy=CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(target), GetUnitY(target), 0.0)
        call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
        call UnitAddAbility(dummy, udg_InterruptAbilId)
        call IssueTargetOrder(dummy, udg_InterruptAbilOrder, target)
    endif
    
    call RemoveLocation(l)
    set l=null
    set dummy=null
endfunction
//===========================================================================
function InitTrig_InterruptTarget takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: GetUnitDamage
//===========================================================================
function GetUnitDamage takes unit u returns integer
    local integer min= BlzGetUnitBaseDamage(u, 0) + BlzGetUnitDiceNumber(u, 0)
    local integer max= BlzGetUnitBaseDamage(u, 0) + BlzGetUnitDiceNumber(u, 0) * BlzGetUnitDiceSides(u, 0)
    return GetRandomInt(min, max)
endfunction
//===========================================================================
function InitTrig_GetUnitDamage takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: GetUnitLifePercentage
//===========================================================================
function GetUnitLifePercentage takes unit u returns real
    return GetUnitState(u, UNIT_STATE_LIFE) / GetUnitState(u, UNIT_STATE_MAX_LIFE)
endfunction

//===========================================================================
function InitTrig_GetUnitLifePercentage takes nothing returns nothing
    set gg_trg_GetUnitLifePercentage=CreateTrigger()
endfunction

//===========================================================================
// Trigger: GetUnitLifeRegeneration
//===========================================================================
function GetUnitLifeRegeneration takes unit u returns real
    local real lifeRegen= 0.
    local real multiplier= 1.
    local integer inventoryIndex= 0

    //----- Hero/Unit -----//
    if IsUnitType(u, UNIT_TYPE_HERO) then
        set lifeRegen=lifeRegen + 1. + 0.03 * GetHeroStr(u, true)
    else
        set lifeRegen=lifeRegen + 1. + ( I2R(GetUnitLevel(u)) / 10. )
    endif

    //----- Items -----//
    loop
        exitwhen inventoryIndex > 5
        if GetItemTypeId(UnitItemInSlot(u, inventoryIndex)) == udg_ItemIdGaiaSeed then
            set lifeRegen=lifeRegen + 1.0
        endif
        set inventoryIndex=inventoryIndex + 1
    endloop

    if GetInventoryIndexOfItemTypeBJ(u, udg_ItemIdScaleOfBalance) > 0 and GetUnitManaPercent(u) > GetUnitLifePercent(u) then
        set lifeRegen=lifeRegen + 2.
    endif

    //----- Plague -----//
    if GetUnitAbilityLevel(u, 'Bapl') > 0 then
        set multiplier=0.
    endif

    if multiplier < 0. then
        set multiplier=0.
    endif
    set lifeRegen=lifeRegen * multiplier

    return lifeRegen
endfunction
//===========================================================================
function InitTrig_GetUnitLifeRegeneration takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: GetUnitMagicDamageReduction
//===========================================================================
function GetUnitMagicDamageReduction takes unit u returns real
    local real damageReduction= 0.
    local integer inventoryIndex= 0
    
    //----- Amplify -----//
    if GetUnitAbilityLevel(u, 'B00O') > 0 then
        set damageReduction=damageReduction - ( 0.1 + 0.05 * GetUnitAbilityLevel(amplifyCaster, 'A01S') )
    endif
    
    //----- Sun Shield -----//
    if GetUnitAbilityLevel(u, SUN_SHIELD_BUFF_ID) > 0 then
        set damageReduction=damageReduction + 0.4 + 0.1 * GetUnitAbilityLevel(u, SUN_SHIELD_ABILITY_ID)
    endif

    //----- Items -----//
    loop
        exitwhen inventoryIndex > 5
        if GetItemTypeId(UnitItemInSlot(u, inventoryIndex)) == udg_ItemIdIdolOfResistance then
            set damageReduction=damageReduction + 0.1
        endif
        set inventoryIndex=inventoryIndex + 1
    endloop

    if damageReduction > 1. then
        set damageReduction=1.
    endif

    return damageReduction
endfunction
//===========================================================================
function InitTrig_GetUnitMagicDamageReduction takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: GetUnitManaRegeneration
//===========================================================================
function GetUnitManaRegeneration takes unit u returns real
    local real manaRegen= 0.
    local real multiplier= 1.
    local integer inventoryIndex= 0

    //----- Hero/Unit -----//
    if IsUnitType(u, UNIT_TYPE_HERO) then
        set manaRegen=manaRegen + 1.0 + ( 0.01 * 1.5 ) * GetHeroInt(u, true)
    else
        set manaRegen=manaRegen + 1.0 + ( I2R(GetUnitLevel(u)) / 10. )
    endif
    
    //----- Siphon Aura -----//
    if GetUnitAbilityLevel(u, udg_SiphonAuraBuffId) > 0 then
        set multiplier=multiplier - 0.5
    endif

    //----- Items -----//
    loop
        exitwhen inventoryIndex > 5
        if GetItemTypeId(UnitItemInSlot(u, inventoryIndex)) == udg_ItemIdMagicLamp then
            set multiplier=multiplier + 0.2
        endif
        set inventoryIndex=inventoryIndex + 1
    endloop

    if GetInventoryIndexOfItemTypeBJ(u, udg_ItemIdScaleOfBalance) > 0 and GetUnitLifePercent(u) > GetUnitManaPercent(u) then
        set multiplier=multiplier + 0.5
    endif

    if multiplier < 0. then
        set multiplier=0.
    endif
    set manaRegen=manaRegen * multiplier

    return manaRegen
endfunction
//===========================================================================
function InitTrig_GetUnitManaRegeneration takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: GetUnitSpellPower
//===========================================================================
function GetUnitSpellPower takes unit u returns real
    local real spellPower= 0.
    local real multiplier= 1.
    local integer inventoryIndex= 0

    if IsUnitType(u, UNIT_TYPE_HERO) then
        set spellPower=spellPower + I2R(GetHeroInt(u, true))
    endif
    
    //----- Fire Totem Aura -----//
    if GetUnitAbilityLevel(u, 'B009') > 0 then
        set multiplier=multiplier + ( 0.05 + 0.05 * GetUnitAbilityLevel(udg_FireTotemCaster, 'A01G') )
    endif

    //----- Items -----//
    loop
        exitwhen inventoryIndex > 5
        if GetItemTypeId(UnitItemInSlot(u, inventoryIndex)) == udg_ItemIdLifeOrb then
            set spellPower=spellPower + 40.0
        endif
        set inventoryIndex=inventoryIndex + 1
    endloop
    
    if GetInventoryIndexOfItemTypeBJ(u, udg_ItemIdBloodtaintedCrystal) > 0 then
        set spellPower=spellPower + 0.05 * GetUnitState(u, UNIT_STATE_MAX_LIFE)
    endif

    if multiplier < 0. then
        set multiplier=0.
    endif
    set spellPower=spellPower * multiplier

    return spellPower
endfunction
//===========================================================================
function InitTrig_GetUnitSpellPower takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: HealUnit
//===========================================================================
function HealUnit takes unit source,unit target,real amount returns nothing
    local real multiplier= 1.
    local integer inventoryIndex= 0
    
    //----- Amplify -----//
    if GetUnitAbilityLevel(target, 'B00O') > 0 then
        set multiplier=multiplier + 0.1 + 0.05 * GetUnitAbilityLevel(amplifyCaster, 'A01S')
    endif
    
    //----- Earth Shield -----//
    if GetUnitAbilityLevel(target, EARTH_SHIELD_BUFF_ID) > 0 then
        set multiplier=multiplier + ( 0.05 + 0.05 * GetUnitAbilityLevel(target, EARTH_SHIELD_BUFF_LEVEL_ID) )
    endif

    //----- Rend -----//
    if GetUnitAbilityLevel(target, 'B00C') > 0 then
        set multiplier=multiplier - ( 0.25 + 0.15 * GetUnitAbilityLevel(target, 'A00K') )
    endif
    
    //----- Jinx -----//
    if GetUnitAbilityLevel(target, 'B005') > 0 then
        set amount=0.
    endif

    if multiplier < 0. then
        set multiplier=0.
    endif

    set amount=amount * multiplier

    if GetUnitState(target, UNIT_STATE_LIFE) > 0. then
        call SetUnitState(target, UNIT_STATE_LIFE, GetUnitState(target, UNIT_STATE_LIFE) + amount)
    endif
endfunction
//===========================================================================
function InitTrig_HealUnit takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: RegenerateLife
//
// This function is basically the same as Heal(), except that it does not consider effects that modify healing amount.
//===========================================================================
function RegenerateLife takes unit u,real amount returns nothing
    if GetUnitState(u, UNIT_STATE_LIFE) > 0. then
        call SetUnitState(u, UNIT_STATE_LIFE, GetUnitState(u, UNIT_STATE_LIFE) + amount)
    endif
endfunction
//===========================================================================
function InitTrig_RegenerateLife takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: RestoreMana
//===========================================================================
function RestoreMana takes unit u,real amount returns nothing
    local real multiplier= 1.
    local real maxMana= GetUnitState(u, UNIT_STATE_MAX_MANA)
    local real mana= GetUnitState(u, UNIT_STATE_MANA)

    if multiplier < 0. then
        set multiplier=0.
    endif

    set amount=amount * multiplier

    if GetUnitState(u, UNIT_STATE_LIFE) > 0. and maxMana > 0. and mana < maxMana then
        call SetUnitState(u, UNIT_STATE_MANA, mana + amount)
    endif
endfunction
//===========================================================================
function InitTrig_RestoreMana takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: SpellTargetEnemyFilter
//===========================================================================
function SpellTargetEnemyFilter takes unit target,unit caster returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(caster)) then
    if GetUnitState(target, UNIT_STATE_LIFE) > 0.0 then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
    if not IsUnitHidden(target) then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

//===========================================================================
function InitTrig_SpellTargetEnemyFilter takes nothing returns nothing
endfunction

//===========================================================================
// Trigger: UnitDamageTargetMagic
//===========================================================================
function UnitDamageTargetMagic takes unit source,unit target,real amount returns nothing
    local real multiplier= 1. - GetUnitMagicDamageReduction(target)

    if multiplier < 0. then
        set multiplier=0.
    endif
    set amount=amount * multiplier

    if GetUnitState(target, UNIT_STATE_LIFE) > 0. then
        set udg_DamageMagic=true
        call UnitDamageTarget(source, target, amount, false, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNKNOWN, WEAPON_TYPE_WHOKNOWS)
        set udg_DamageMagic=false
        //call DisplayTextToForce(GetPlayersAll(), GetUnitName(source) + " dealt " + R2S(amount) + " magic damage to " + GetUnitName(target))
    endif
endfunction
//===========================================================================
function InitTrig_UnitDamageTargetMagic takes nothing returns nothing
endfunction
//===========================================================================
// Trigger: Init
//===========================================================================
function Trig_Init_Actions takes nothing returns nothing
    set udg_ReviveRect=gg_rct_Level01Revive
    call SetTerrainFogExBJ(0, 1300.00, 2900.00, 0, 90.00, 90.00, 60.00)
    call SetSkyModel("Environment\\Sky\\DalaranSky\\DalaranSky.mdl")
    call EnableMinimapFilterButtons(false, false)
    call ClearMapMusicBJ()
    call EndThematicMusicBJ()
    call StopMusicBJ(false)
    call EnableDawnDusk(false)
    call StopSound(bj_dayAmbientSound, true, true)
    call StopSound(bj_nightAmbientSound, true, true)
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_MaxPlayers
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetCameraFieldForPlayer(ConvertedPlayer(GetForLoopIndexA()), CAMERA_FIELD_TARGET_DISTANCE, 2200.00, 0)
        call CameraSetSmoothingFactorBJ(2.50)
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
endfunction

//===========================================================================
function InitTrig_Init takes nothing returns nothing
    set gg_trg_Init=CreateTrigger()
    call TriggerAddAction(gg_trg_Init, function Trig_Init_Actions)
endfunction

//===========================================================================
// Trigger: InitInGame
//===========================================================================
function Trig_InitInGame_Actions takes nothing returns nothing
    call ClearMapMusicBJ()
    call EndThematicMusicBJ()
    call StopMusicBJ(false)
    call PlayMusicBJ(gg_snd_Music_AgonWastes)
endfunction

//===========================================================================
function InitTrig_InitInGame takes nothing returns nothing
    set gg_trg_InitInGame=CreateTrigger()
    call TriggerRegisterTimerEventSingle(gg_trg_InitInGame, 0.01)
    call TriggerAddAction(gg_trg_InitInGame, function Trig_InitInGame_Actions)
endfunction

//===========================================================================
// Trigger: Regeneration
//===========================================================================
function Regeneration_Actions takes nothing returns nothing
    local group g= CreateGroup()
    local unit u= null
    call GroupEnumUnitsInRect(g, GetWorldBounds(), null)
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        call RegenerateLife(u , GetUnitLifeRegeneration(u) * 0.5)
        call RestoreMana(u , GetUnitManaRegeneration(u) * 0.5)
        call GroupRemoveUnit(g, u)
    endloop
    call DestroyGroup(g)
    set g=null
    set u=null
endfunction

//===========================================================================
function InitTrig_Regeneration takes nothing returns nothing
    set gg_trg_Regeneration=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_Regeneration, 0.5)
    call TriggerAddAction(gg_trg_Regeneration, function Regeneration_Actions)
endfunction
//===========================================================================
// Trigger: Zoom
//===========================================================================
function Trig_Zoom_Actions takes nothing returns nothing
    call SetCameraFieldForPlayer(GetTriggerPlayer(), CAMERA_FIELD_TARGET_DISTANCE, 2200.00, 0.25)
    call CameraSetSmoothingFactorBJ(2.50)
endfunction

//===========================================================================
function InitTrig_Zoom takes nothing returns nothing
    set gg_trg_Zoom=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(gg_trg_Zoom, Player(0), "-zoom", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_Zoom, Player(1), "-zoom", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_Zoom, Player(2), "-zoom", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_Zoom, Player(3), "-zoom", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_Zoom, Player(4), "-zoom", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_Zoom, Player(5), "-zoom", true)
    call TriggerAddAction(gg_trg_Zoom, function Trig_Zoom_Actions)
endfunction

//===========================================================================
// Trigger: LevelsInit
//===========================================================================
function Trig_LevelsInit_Actions takes nothing returns nothing
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_MaxPlayers
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetCameraBoundsToRectForPlayerBJ(ConvertedPlayer(GetForLoopIndexA()), gg_rct_Level01CamBounds)
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_NumLevels
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_LevelCompleted[GetForLoopIndexA()]=false
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
endfunction

//===========================================================================
function InitTrig_LevelsInit takes nothing returns nothing
    set gg_trg_LevelsInit=CreateTrigger()
    call TriggerAddAction(gg_trg_LevelsInit, function Trig_LevelsInit_Actions)
endfunction

//===========================================================================
// Trigger: NextLevel
//===========================================================================
function Trig_NextLevel_Func006A takes nothing returns nothing
    call ReviveHeroLoc(GetEnumUnit(), udg_TempPoint, true)
    call SetUnitPositionLoc(GetEnumUnit(), udg_TempPoint)
endfunction

function Trig_NextLevel_Actions takes nothing returns nothing
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 2, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call SetUserControlForceOff(GetPlayersAll())
    call TriggerSleepAction(2)
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_MaxPlayers
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetCameraBoundsToRectForPlayerBJ(ConvertedPlayer(GetForLoopIndexA()), udg_NextLevelCamBounds)
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    set udg_TempPoint=GetRectCenter(udg_NextLevelStartRect)
    call ForGroupBJ(udg_PlayerHeroes, function Trig_NextLevel_Func006A)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 2, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(2)
    call SetUserControlForceOn(GetPlayersAll())
endfunction

//===========================================================================
function InitTrig_NextLevel takes nothing returns nothing
    set gg_trg_NextLevel=CreateTrigger()
    call TriggerAddAction(gg_trg_NextLevel, function Trig_NextLevel_Actions)
endfunction

//===========================================================================
// Trigger: Level01Exit
//===========================================================================
function Trig_Level01Exit_Conditions takes nothing returns boolean
    if ( not ( udg_LevelCompleted[1] == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_PlayerHeroes) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level01Exit_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_ReviveRect=gg_rct_Level02Revive
    set udg_NextLevelCamBounds=gg_rct_Level02CamBounds
    set udg_NextLevelStartRect=gg_rct_Level02Start
    call ConditionalTriggerExecute(gg_trg_NextLevel)
    // Level 02 Settings TODO: Move this to specific init trig
    call ClearMapMusicBJ()
    call EndThematicMusicBJ()
    call StopMusicBJ(false)
    call PlayMusicBJ(gg_snd_Music_AhnQirajIntro)
endfunction

//===========================================================================
function InitTrig_Level01Exit takes nothing returns nothing
    set gg_trg_Level01Exit=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Level01Exit, gg_rct_Level01Exit)
    call TriggerAddCondition(gg_trg_Level01Exit, Condition(function Trig_Level01Exit_Conditions))
    call TriggerAddAction(gg_trg_Level01Exit, function Trig_Level01Exit_Actions)
endfunction

//===========================================================================
// Trigger: Level02Exit
//===========================================================================
function Trig_Level02Exit_Conditions takes nothing returns boolean
    if ( not ( udg_LevelCompleted[2] == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_PlayerHeroes) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level02Exit_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_ReviveRect=gg_rct_Level03Revive
    set udg_NextLevelCamBounds=gg_rct_Level03CamBounds
    set udg_NextLevelStartRect=gg_rct_Level03Start
    call ConditionalTriggerExecute(gg_trg_NextLevel)
endfunction

//===========================================================================
function InitTrig_Level02Exit takes nothing returns nothing
    set gg_trg_Level02Exit=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Level02Exit, gg_rct_Level02Exit)
    call TriggerAddCondition(gg_trg_Level02Exit, Condition(function Trig_Level02Exit_Conditions))
    call TriggerAddAction(gg_trg_Level02Exit, function Trig_Level02Exit_Actions)
endfunction

//===========================================================================
// Trigger: Level03Exit
//===========================================================================
function Trig_Level03Exit_Conditions takes nothing returns boolean
    if ( not ( udg_LevelCompleted[3] == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_PlayerHeroes) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level03Exit_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_ReviveRect=gg_rct_Level04Revive
    set udg_NextLevelCamBounds=gg_rct_Level04CamBounds
    set udg_NextLevelStartRect=gg_rct_Level04Start
    call ConditionalTriggerExecute(gg_trg_NextLevel)
endfunction

//===========================================================================
function InitTrig_Level03Exit takes nothing returns nothing
    set gg_trg_Level03Exit=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Level03Exit, gg_rct_Level03Exit)
    call TriggerAddCondition(gg_trg_Level03Exit, Condition(function Trig_Level03Exit_Conditions))
    call TriggerAddAction(gg_trg_Level03Exit, function Trig_Level03Exit_Actions)
endfunction

//===========================================================================
// Trigger: Level04Exit
//===========================================================================
function Trig_Level04Exit_Conditions takes nothing returns boolean
    if ( not ( udg_LevelCompleted[4] == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_PlayerHeroes) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level04Exit_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_ReviveRect=gg_rct_Level05Revive
    set udg_NextLevelCamBounds=gg_rct_Level05CamBounds
    set udg_NextLevelStartRect=gg_rct_Level05Start
    call ConditionalTriggerExecute(gg_trg_NextLevel)
endfunction

//===========================================================================
function InitTrig_Level04Exit takes nothing returns nothing
    set gg_trg_Level04Exit=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Level04Exit, gg_rct_Level04Exit)
    call TriggerAddCondition(gg_trg_Level04Exit, Condition(function Trig_Level04Exit_Conditions))
    call TriggerAddAction(gg_trg_Level04Exit, function Trig_Level04Exit_Actions)
endfunction

//===========================================================================
// Trigger: Level05Exit
//===========================================================================
function Trig_Level05Exit_Conditions takes nothing returns boolean
    if ( not ( udg_LevelCompleted[5] == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_PlayerHeroes) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level05Exit_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_ReviveRect=gg_rct_Level06Revive
    set udg_NextLevelCamBounds=gg_rct_Level06CamBounds
    set udg_NextLevelStartRect=gg_rct_Level06Start
    call ConditionalTriggerExecute(gg_trg_NextLevel)
endfunction

//===========================================================================
function InitTrig_Level05Exit takes nothing returns nothing
    set gg_trg_Level05Exit=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Level05Exit, gg_rct_Level05Exit)
    call TriggerAddCondition(gg_trg_Level05Exit, Condition(function Trig_Level05Exit_Conditions))
    call TriggerAddAction(gg_trg_Level05Exit, function Trig_Level05Exit_Actions)
endfunction

//===========================================================================
// Trigger: Level06Exit
//===========================================================================
function Trig_Level06Exit_Conditions takes nothing returns boolean
    if ( not ( udg_LevelCompleted[6] == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_PlayerHeroes) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level06Exit_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_ReviveRect=gg_rct_Level07Revive
    set udg_NextLevelCamBounds=gg_rct_Level07CamBounds
    set udg_NextLevelStartRect=gg_rct_Level07Start
    call ConditionalTriggerExecute(gg_trg_NextLevel)
endfunction

//===========================================================================
function InitTrig_Level06Exit takes nothing returns nothing
    set gg_trg_Level06Exit=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Level06Exit, gg_rct_Level06Exit)
    call TriggerAddCondition(gg_trg_Level06Exit, Condition(function Trig_Level06Exit_Conditions))
    call TriggerAddAction(gg_trg_Level06Exit, function Trig_Level06Exit_Actions)
endfunction

//===========================================================================
// Trigger: Level01Complete
//===========================================================================
function Trig_Level01Complete_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n004' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level01Complete_Actions takes nothing returns nothing
    set udg_LevelCompleted[1]=true
endfunction

//===========================================================================
function InitTrig_Level01Complete takes nothing returns nothing
    set gg_trg_Level01Complete=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Level01Complete, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Level01Complete, Condition(function Trig_Level01Complete_Conditions))
    call TriggerAddAction(gg_trg_Level01Complete, function Trig_Level01Complete_Actions)
endfunction

//===========================================================================
// Trigger: Level02Complete
//===========================================================================
function Trig_Level02Complete_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'e002' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level02Complete_Actions takes nothing returns nothing
    set udg_LevelCompleted[2]=true
endfunction

//===========================================================================
function InitTrig_Level02Complete takes nothing returns nothing
    set gg_trg_Level02Complete=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Level02Complete, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Level02Complete, Condition(function Trig_Level02Complete_Conditions))
    call TriggerAddAction(gg_trg_Level02Complete, function Trig_Level02Complete_Actions)
endfunction

//===========================================================================
// Trigger: Level03Complete
//===========================================================================
function Trig_Level03Complete_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n000' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level03Complete_Actions takes nothing returns nothing
    set udg_LevelCompleted[3]=true
endfunction

//===========================================================================
function InitTrig_Level03Complete takes nothing returns nothing
    set gg_trg_Level03Complete=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Level03Complete, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Level03Complete, Condition(function Trig_Level03Complete_Conditions))
    call TriggerAddAction(gg_trg_Level03Complete, function Trig_Level03Complete_Actions)
endfunction

//===========================================================================
// Trigger: Level04Complete
//===========================================================================
function Trig_Level04Complete_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u001' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level04Complete_Func001002002 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'u001' )
endfunction

function Trig_Level04Complete_Func002C takes nothing returns boolean
    if ( not ( IsUnitGroupDeadBJ(udg_TempGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level04Complete_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsInRectMatching(GetPlayableMapRect(), Condition(function Trig_Level04Complete_Func001002002))
    if ( Trig_Level04Complete_Func002C() ) then
        set udg_LevelCompleted[4]=true
    else
    endif
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_Level04Complete takes nothing returns nothing
    set gg_trg_Level04Complete=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Level04Complete, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Level04Complete, Condition(function Trig_Level04Complete_Conditions))
    call TriggerAddAction(gg_trg_Level04Complete, function Trig_Level04Complete_Actions)
endfunction

//===========================================================================
// Trigger: Level05Complete
//===========================================================================
function Trig_Level05Complete_Func002C takes nothing returns boolean
    if ( ( GetUnitTypeId(GetTriggerUnit()) == 'n00A' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetTriggerUnit()) == 'n00B' ) ) then
        return true
    endif
    return false
endfunction

function Trig_Level05Complete_Conditions takes nothing returns boolean
    if ( not Trig_Level05Complete_Func002C() ) then
        return false
    endif
    return true
endfunction

function Trig_Level05Complete_Actions takes nothing returns nothing
    set udg_LevelCompleted[5]=true
endfunction

//===========================================================================
function InitTrig_Level05Complete takes nothing returns nothing
    set gg_trg_Level05Complete=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Level05Complete, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Level05Complete, Condition(function Trig_Level05Complete_Conditions))
    call TriggerAddAction(gg_trg_Level05Complete, function Trig_Level05Complete_Actions)
endfunction

//===========================================================================
// Trigger: Level06Complete
//===========================================================================
function Trig_Level06Complete_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n005' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level06Complete_Actions takes nothing returns nothing
    set udg_LevelCompleted[6]=true
endfunction

//===========================================================================
function InitTrig_Level06Complete takes nothing returns nothing
    set gg_trg_Level06Complete=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Level06Complete, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Level06Complete, Condition(function Trig_Level06Complete_Conditions))
    call TriggerAddAction(gg_trg_Level06Complete, function Trig_Level06Complete_Actions)
endfunction

//===========================================================================
// Trigger: Level07Complete
//===========================================================================
function Trig_Level07Complete_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u00B' ) ) then
        return false
    endif
    return true
endfunction

function Trig_Level07Complete_Actions takes nothing returns nothing
    set udg_LevelCompleted[7]=true
    call PlaySoundBJ(gg_snd_QuestCompleted)
    call DisplayTextToForce(GetPlayersAll(), "TRIGSTR_2419")
endfunction

//===========================================================================
function InitTrig_Level07Complete takes nothing returns nothing
    set gg_trg_Level07Complete=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Level07Complete, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Level07Complete, Condition(function Trig_Level07Complete_Conditions))
    call TriggerAddAction(gg_trg_Level07Complete, function Trig_Level07Complete_Actions)
endfunction

//===========================================================================
// Trigger: InitCircleOfCultists
//===========================================================================
function Trig_InitCircleOfCultists_Func002002002 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'u003' )
endfunction

function Trig_InitCircleOfCultists_Func003Func001C takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetEnumUnit(), udg_CircleOfCultistsGroup) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_InitCircleOfCultists_Func003Func002C takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A010', GetEnumUnit()) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_InitCircleOfCultists_Func003A takes nothing returns nothing
    if ( Trig_InitCircleOfCultists_Func003Func001C() ) then
        call GroupAddUnitSimple(GetEnumUnit(), udg_CircleOfCultistsGroup)
    else
    endif
    if ( Trig_InitCircleOfCultists_Func003Func002C() ) then
        call UnitAddAbilityBJ('A010', GetEnumUnit())
    else
    endif
    call SetUnitFacingToFaceLocTimed(GetEnumUnit(), udg_TempPoint, 0)
    call IssueImmediateOrderBJ(GetEnumUnit(), "channel")
endfunction

function Trig_InitCircleOfCultists_Actions takes nothing returns nothing
    set udg_TempPoint=GetRectCenter(gg_rct_LandmarkCircleOfCultistsAggro)
    set udg_TempGroup=GetUnitsInRectMatching(gg_rct_LandmarkCircleOfCultists, Condition(function Trig_InitCircleOfCultists_Func002002002))
    call ForGroupBJ(udg_TempGroup, function Trig_InitCircleOfCultists_Func003A)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_InitCircleOfCultists takes nothing returns nothing
    set gg_trg_InitCircleOfCultists=CreateTrigger()
    call TriggerRegisterGameLoadedEventBJ(gg_trg_InitCircleOfCultists)
    call TriggerAddAction(gg_trg_InitCircleOfCultists, function Trig_InitCircleOfCultists_Actions)
endfunction

//===========================================================================
// Trigger: CircleOfCultistsAggro
//===========================================================================
function Trig_CircleOfCultistsAggro_Conditions takes nothing returns boolean
    if ( not ( IsUnitEnemy(GetTriggerUnit(), Player(PLAYER_NEUTRAL_AGGRESSIVE)) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_CircleOfCultistsAggro_Func002A takes nothing returns nothing
    call IssueImmediateOrderBJ(GetEnumUnit(), "stop")
    call UnitRemoveAbilityBJ('A010', GetEnumUnit())
endfunction

function Trig_CircleOfCultistsAggro_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call ForGroupBJ(udg_CircleOfCultistsGroup, function Trig_CircleOfCultistsAggro_Func002A)
endfunction

//===========================================================================
function InitTrig_CircleOfCultistsAggro takes nothing returns nothing
    set gg_trg_CircleOfCultistsAggro=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_CircleOfCultistsAggro, gg_rct_LandmarkCircleOfCultistsAggro)
    call TriggerAddCondition(gg_trg_CircleOfCultistsAggro, Condition(function Trig_CircleOfCultistsAggro_Conditions))
    call TriggerAddAction(gg_trg_CircleOfCultistsAggro, function Trig_CircleOfCultistsAggro_Actions)
endfunction

//===========================================================================
// Trigger: CircleOfCultistsAttacked
//===========================================================================
function Trig_CircleOfCultistsAttacked_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_CircleOfCultistsGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_CircleOfCultistsAttacked_Actions takes nothing returns nothing
    call GroupRemoveUnitSimple(GetTriggerUnit(), udg_CircleOfCultistsGroup)
    call IssueImmediateOrderBJ(GetTriggerUnit(), "stop")
    call UnitRemoveAbilityBJ('A010', GetTriggerUnit())
endfunction

//===========================================================================
function InitTrig_CircleOfCultistsAttacked takes nothing returns nothing
    set gg_trg_CircleOfCultistsAttacked=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CircleOfCultistsAttacked, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_CircleOfCultistsAttacked, Condition(function Trig_CircleOfCultistsAttacked_Conditions))
    call TriggerAddAction(gg_trg_CircleOfCultistsAttacked, function Trig_CircleOfCultistsAttacked_Actions)
endfunction

//===========================================================================
// Trigger: OpenMainGateStart
//===========================================================================
function Trig_OpenMainGateStart_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n000' ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_OpenMainGateStart_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call SetDoodadAnimationRectBJ("Death", 'D00M', gg_rct_EnvAQDoorBig0)
    call StartTimerBJ(udg_OpenMainGateTimer, false, 9.32)
endfunction

//===========================================================================
function InitTrig_OpenMainGateStart takes nothing returns nothing
    set gg_trg_OpenMainGateStart=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_OpenMainGateStart, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_OpenMainGateStart, Condition(function Trig_OpenMainGateStart_Conditions))
    call TriggerAddAction(gg_trg_OpenMainGateStart, function Trig_OpenMainGateStart_Actions)
endfunction

//===========================================================================
// Trigger: OpenMainGateFinish
//===========================================================================
function Trig_OpenMainGateFinish_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call RemoveDestructable(gg_dest_Ytlc_0186)
    call RemoveDestructable(gg_dest_Ytlc_0321)
    call RemoveDestructable(gg_dest_Ytlc_0343)
    call RemoveDestructable(gg_dest_Ytlc_0350)
    call RemoveDestructable(gg_dest_Ytlc_0351)
    call SetDoodadAnimationRectBJ("Stand Alternate", 'D00M', gg_rct_EnvAQDoorBig0)
    call ClearMapMusicBJ()
    call EndThematicMusicBJ()
    call StopMusicBJ(true)
endfunction

//===========================================================================
function InitTrig_OpenMainGateFinish takes nothing returns nothing
    set gg_trg_OpenMainGateFinish=CreateTrigger()
    call TriggerRegisterTimerExpireEventBJ(gg_trg_OpenMainGateFinish, udg_OpenMainGateTimer)
    call TriggerAddAction(gg_trg_OpenMainGateFinish, function Trig_OpenMainGateFinish_Actions)
endfunction

//===========================================================================
// Trigger: OpenGateToTriangle
//===========================================================================
function Trig_OpenGateToTriangle_Func005C takes nothing returns boolean
    if ( ( GetUnitTypeId(GetTriggerUnit()) == 'e002' ) ) then
        return true
    endif
    if ( ( GetUnitTypeId(GetTriggerUnit()) == 'u001' ) ) then
        return true
    endif
    return false
endfunction

function Trig_OpenGateToTriangle_Conditions takes nothing returns boolean
    if ( not Trig_OpenGateToTriangle_Func005C() ) then
        return false
    endif
    return true
endfunction

function Trig_OpenGateToTriangle_Func001002002001001 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'e002' )
endfunction

function Trig_OpenGateToTriangle_Func001002002001002 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'e003' )
endfunction

function Trig_OpenGateToTriangle_Func001002002001 takes nothing returns boolean
    return GetBooleanOr((GetUnitTypeId(GetFilterUnit()) == 'e002'), (GetUnitTypeId(GetFilterUnit()) == 'e003')) // INLINED!!
endfunction

function Trig_OpenGateToTriangle_Func001002002002 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'u001' )
endfunction

function Trig_OpenGateToTriangle_Func001002002 takes nothing returns boolean
    return GetBooleanOr((GetBooleanOr((GetUnitTypeId(GetFilterUnit()) == 'e002'), (GetUnitTypeId(GetFilterUnit()) == 'e003'))), (GetUnitTypeId(GetFilterUnit()) == 'u001')) // INLINED!!
endfunction

function Trig_OpenGateToTriangle_Func002C takes nothing returns boolean
    if ( not ( IsUnitGroupEmptyBJ(udg_TempGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_OpenGateToTriangle_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsInRectMatching(GetPlayableMapRect(), Condition(function Trig_OpenGateToTriangle_Func001002002))
    if ( Trig_OpenGateToTriangle_Func002C() ) then
        call DisableTrigger(GetTriggeringTrigger())
        call SetDoodadAnimationRectBJ("Death", 'D00C', gg_rct_EnvAQDoorSmall0A)
        call SetDoodadAnimationRectBJ("Death", 'D00C', gg_rct_EnvAQDoorSmall0B)
        call SetDoodadAnimationRectBJ("Death", 'D00C', gg_rct_EnvAQDoorSmall0C)
        call RemoveDestructable(gg_dest_Ytlc_3059)
        call RemoveDestructable(gg_dest_Ytlc_3060)
        call RemoveDestructable(gg_dest_Ytlc_3061)
        call RemoveDestructable(gg_dest_Ytlc_3062)
    else
    endif
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_OpenGateToTriangle takes nothing returns nothing
    set gg_trg_OpenGateToTriangle=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_OpenGateToTriangle, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_OpenGateToTriangle, Condition(function Trig_OpenGateToTriangle_Conditions))
    call TriggerAddAction(gg_trg_OpenGateToTriangle, function Trig_OpenGateToTriangle_Actions)
endfunction

//===========================================================================
// Trigger: HeroSelectInit
//===========================================================================
function Trig_HeroSelectInit_Func003A takes nothing returns nothing
    call GroupAddUnitSimple(GetEnumUnit(), udg_HeroSelectGroup)
    set udg_TempPoint=GetUnitLoc(GetEnumUnit())
    call CreateNUnitsAtLoc(1, 'u000', Player(PLAYER_NEUTRAL_AGGRESSIVE), udg_TempPoint, bj_UNIT_FACING)
    call UnitApplyTimedLifeBJ(2.00, 'BTLF', GetLastCreatedUnit())
    call UnitAddAbilityBJ('A00V', GetLastCreatedUnit())
    call IssueTargetOrderBJ(GetLastCreatedUnit(), "thunderbolt", GetEnumUnit())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

function Trig_HeroSelectInit_Actions takes nothing returns nothing
    call SetPlayerName(Player(6), "TRIGSTR_1410")
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_MaxPlayers
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerAllianceStateBJ(ConvertedPlayer(GetForLoopIndexA()), Player(6), bj_ALLIANCE_ALLIED_VISION)
        call SetPlayerAllianceStateBJ(Player(6), ConvertedPlayer(GetForLoopIndexA()), bj_ALLIANCE_ALLIED_UNITS)
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    call ForGroupBJ(GetUnitsInRectAll(gg_rct_HeroSelection), function Trig_HeroSelectInit_Func003A)
    call ConditionalTriggerExecute(gg_trg_SetPlayerNumHeroes)
    call ConditionalTriggerExecute(gg_trg_SetHeroSelectMaxAbils)
    // Create Floating Text
    set udg_TempString="Double-click on a hero to select it."
    set udg_TempPoint=GetRectCenter(gg_rct_HeroSelection)
    set udg_TempPoint2=PolarProjectionBJ(udg_TempPoint, ( 10.00 * I2R(StringLength(udg_TempString)) ), 180.00)
    call CreateTextTagLocBJ(udg_TempString, udg_TempPoint2, 0, 10, 90.00, 90.00, 35.00, 0)
    set udg_HeroSelectFloatingText=GetLastCreatedTextTag()
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call RemoveLocation(udg_TempPoint2)
    set udg_TempPoint2=null
endfunction

//===========================================================================
function InitTrig_HeroSelectInit takes nothing returns nothing
    set gg_trg_HeroSelectInit=CreateTrigger()
    call TriggerAddAction(gg_trg_HeroSelectInit, function Trig_HeroSelectInit_Actions)
endfunction

//===========================================================================
// Trigger: HeroSelectSetSeleted
//===========================================================================
function Trig_HeroSelectSetSeleted_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_HeroSelectGroup) == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( GetPlayerAlliance(Player(6), GetTriggerPlayer(), ALLIANCE_SHARED_CONTROL) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func001Func005Func002C takes nothing returns boolean
    if ( not ( udg_PlayerNumHeroes[GetConvertedPlayerId(GetTriggerPlayer())] > 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func001Func005C takes nothing returns boolean
    if ( not ( udg_PlayerNumHeroes[GetConvertedPlayerId(GetTriggerPlayer())] == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func001Func006C takes nothing returns boolean
    if ( not ( udg_PlayerNumHeroes[GetConvertedPlayerId(GetTriggerPlayer())] <= 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func001Func017C takes nothing returns boolean
    if ( not ( CountUnitsInGroup(udg_PlayerHeroes) >= udg_MaxPlayers ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func001C takes nothing returns boolean
    if ( not ( udg_HasClicked[GetConvertedPlayerId(GetTriggerPlayer())] == true ) ) then
        return false
    endif
    if ( not ( GetTriggerUnit() == udg_LastClickedUnit[GetConvertedPlayerId(GetTriggerPlayer())] ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func005Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetConvertedPlayerId(GetTriggerPlayer()) == 5 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func005Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetConvertedPlayerId(GetTriggerPlayer()) == 4 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func005Func001Func001C takes nothing returns boolean
    if ( not ( GetConvertedPlayerId(GetTriggerPlayer()) == 3 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func005Func001C takes nothing returns boolean
    if ( not ( GetConvertedPlayerId(GetTriggerPlayer()) == 2 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Func005C takes nothing returns boolean
    if ( not ( GetConvertedPlayerId(GetTriggerPlayer()) == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HeroSelectSetSeleted_Actions takes nothing returns nothing
    if ( Trig_HeroSelectSetSeleted_Func001C() ) then
        call GroupRemoveUnitSimple(GetTriggerUnit(), udg_HeroSelectGroup)
        set udg_TempPoint=GetRectCenter(udg_ReviveRect)
        call CreateNUnitsAtLoc(1, GetUnitTypeId(GetTriggerUnit()), GetTriggerPlayer(), udg_TempPoint, bj_UNIT_FACING)
        set udg_PlayerNumHeroes[GetConvertedPlayerId(GetTriggerPlayer())]=( udg_PlayerNumHeroes[GetConvertedPlayerId(GetTriggerPlayer())] - 1 )
        if ( Trig_HeroSelectSetSeleted_Func001Func005C() ) then
            call DisplayTextToForce(GetForceOfPlayer(ConvertedPlayer(GetConvertedPlayerId(GetTriggerPlayer()))), "TRIGSTR_2386")
        else
            if ( Trig_HeroSelectSetSeleted_Func001Func005Func002C() ) then
                call DisplayTextToForce(GetForceOfPlayer(ConvertedPlayer(GetConvertedPlayerId(GetTriggerPlayer()))), ( "You have |cffFFFF66" + ( I2S(udg_PlayerNumHeroes[GetConvertedPlayerId(GetTriggerPlayer())]) + "|r picks left." ) ))
            else
            endif
        endif
        if ( Trig_HeroSelectSetSeleted_Func001Func006C() ) then
            call PanCameraToTimedLocForPlayer(ConvertedPlayer(GetConvertedPlayerId(GetTriggerPlayer())), udg_TempPoint, 0)
            call AddSpecialEffectLocBJ(udg_TempPoint, "Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl")
            call DestroyEffectBJ(GetLastCreatedEffectBJ())
            call SetPlayerAllianceStateBJ(ConvertedPlayer(GetConvertedPlayerId(GetTriggerPlayer())), Player(6), bj_ALLIANCE_ALLIED)
            call SetPlayerAllianceStateBJ(Player(6), ConvertedPlayer(GetConvertedPlayerId(GetTriggerPlayer())), bj_ALLIANCE_ALLIED)
        else
        endif
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
        call GroupAddUnitSimple(GetLastCreatedUnit(), udg_PlayerHeroes)
        set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
        call AddSpecialEffectLocBJ(udg_TempPoint, "Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl")
        call DestroyEffectBJ(GetLastCreatedEffectBJ())
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
        call RemoveUnit(GetTriggerUnit())
        call ConditionalTriggerExecute(gg_trg_SetHeroColors)
        if ( Trig_HeroSelectSetSeleted_Func001Func017C() ) then
            call DestroyTextTagBJ(udg_HeroSelectFloatingText)
        else
        endif
    else
    endif
    set udg_LastClickedUnit[GetConvertedPlayerId(GetTriggerPlayer())]=GetTriggerUnit()
    set udg_HasClicked[GetConvertedPlayerId(GetTriggerPlayer())]=true
    // Start Double Click Timer
    if ( Trig_HeroSelectSetSeleted_Func005C() ) then
        call StartTimerBJ(udg_DoubleClickTimerP1, false, 0.50)
    else
        if ( Trig_HeroSelectSetSeleted_Func005Func001C() ) then
            call StartTimerBJ(udg_DoubleClickTimerP2, false, 0.50)
        else
            if ( Trig_HeroSelectSetSeleted_Func005Func001Func001C() ) then
                call StartTimerBJ(udg_DoubleClickTimerP3, false, 0.50)
            else
                if ( Trig_HeroSelectSetSeleted_Func005Func001Func001Func001C() ) then
                    call StartTimerBJ(udg_DoubleClickTimerP4, false, 0.50)
                else
                    if ( Trig_HeroSelectSetSeleted_Func005Func001Func001Func001Func001C() ) then
                        call StartTimerBJ(udg_DoubleClickTimerP5, false, 0.50)
                    else
                    endif
                endif
            endif
        endif
    endif
endfunction

//===========================================================================
function InitTrig_HeroSelectSetSeleted takes nothing returns nothing
    set gg_trg_HeroSelectSetSeleted=CreateTrigger()
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_HeroSelectSetSeleted, Player(0), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_HeroSelectSetSeleted, Player(1), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_HeroSelectSetSeleted, Player(2), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_HeroSelectSetSeleted, Player(3), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_HeroSelectSetSeleted, Player(4), true)
    call TriggerAddCondition(gg_trg_HeroSelectSetSeleted, Condition(function Trig_HeroSelectSetSeleted_Conditions))
    call TriggerAddAction(gg_trg_HeroSelectSetSeleted, function Trig_HeroSelectSetSeleted_Actions)
endfunction

//===========================================================================
// Trigger: SetHeroSelectMaxAbils
//===========================================================================
function Trig_SetHeroSelectMaxAbils_Actions takes nothing returns nothing
    // Beastmaster
    call SetUnitAbilityLevelSwapped('A01Q', gg_unit_N00F_0047, 4)
    call SetUnitAbilityLevelSwapped('A002', gg_unit_N00F_0047, 4)
    call SetUnitAbilityLevelSwapped('A01T', gg_unit_N00F_0047, 4)
    call SetUnitAbilityLevelSwapped('A01V', gg_unit_N00F_0047, 4)
    // Death Knight
    call SetUnitAbilityLevelSwapped('A014', gg_unit_U00I_0045, 4)
    call SetUnitAbilityLevelSwapped('A00D', gg_unit_U00I_0045, 4)
    call SetUnitAbilityLevelSwapped('A011', gg_unit_U00I_0045, 4)
    call SetUnitAbilityLevelSwapped('A013', gg_unit_U00I_0045, 4)
    // Demon Hunter
    call SetUnitAbilityLevelSwapped('A015', gg_unit_E006_0041, 4)
    call SetUnitAbilityLevelSwapped('A01A', gg_unit_E006_0041, 4)
    call SetUnitAbilityLevelSwapped('A017', gg_unit_E006_0041, 4)
    call SetUnitAbilityLevelSwapped('A016', gg_unit_E006_0041, 4)
    // Furion
    call SetUnitAbilityLevelSwapped('A01O', gg_unit_E007_0043, 4)
    call SetUnitAbilityLevelSwapped('A01S', gg_unit_E007_0043, 4)
    call SetUnitAbilityLevelSwapped('A01Y', gg_unit_E007_0043, 4)
    call SetUnitAbilityLevelSwapped('A01N', gg_unit_E007_0043, 4)
    // Sea Witch
    call SetUnitAbilityLevelSwapped('A01W', gg_unit_N001_0046, 4)
    call SetUnitAbilityLevelSwapped('A023', gg_unit_N001_0046, 4)
    call SetUnitAbilityLevelSwapped('A024', gg_unit_N001_0046, 4)
    call SetUnitAbilityLevelSwapped('A00F', gg_unit_N001_0046, 4)
    // Shadow Hunter
    call SetUnitAbilityLevelSwapped('A00X', gg_unit_O001_0044, 4)
    call SetUnitAbilityLevelSwapped('A01G', gg_unit_O001_0044, 4)
    call SetUnitAbilityLevelSwapped('A01C', gg_unit_O001_0044, 4)
    call SetUnitAbilityLevelSwapped('A001', gg_unit_O001_0044, 4)
    // Warden
    call SetUnitAbilityLevelSwapped('A00J', gg_unit_E001_0042, 4)
    call SetUnitAbilityLevelSwapped('A01I', gg_unit_E001_0042, 4)
    call SetUnitAbilityLevelSwapped('A01J', gg_unit_E001_0042, 4)
endfunction

//===========================================================================
function InitTrig_SetHeroSelectMaxAbils takes nothing returns nothing
    set gg_trg_SetHeroSelectMaxAbils=CreateTrigger()
    call TriggerAddAction(gg_trg_SetHeroSelectMaxAbils, function Trig_SetHeroSelectMaxAbils_Actions)
endfunction

//===========================================================================
// Trigger: SetPlayerNumHeroes
//===========================================================================
function Trig_SetPlayerNumHeroes_Func001Func001C takes nothing returns boolean
    if ( not ( GetPlayerController(ConvertedPlayer(GetForLoopIndexA())) == MAP_CONTROL_USER ) ) then
        return false
    endif
    if ( not ( GetPlayerSlotState(ConvertedPlayer(GetForLoopIndexA())) == PLAYER_SLOT_STATE_PLAYING ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetPlayerNumHeroes_Func002C takes nothing returns boolean
    if ( not ( udg_HeroPicksLeft > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetPlayerNumHeroes_Actions takes nothing returns nothing
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_MaxPlayers
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ( Trig_SetPlayerNumHeroes_Func001Func001C() ) then
            set udg_PlayerNumHeroes[GetForLoopIndexA()]=( udg_PlayerNumHeroes[GetForLoopIndexA()] + 1 )
            set udg_HeroPicksLeft=( udg_HeroPicksLeft - 1 )
        else
        endif
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    if ( Trig_SetPlayerNumHeroes_Func002C() ) then
        call ConditionalTriggerExecute(gg_trg_SetPlayerNumHeroes)
    else
    endif
endfunction

//===========================================================================
function InitTrig_SetPlayerNumHeroes takes nothing returns nothing
    set gg_trg_SetPlayerNumHeroes=CreateTrigger()
    call TriggerAddAction(gg_trg_SetPlayerNumHeroes, function Trig_SetPlayerNumHeroes_Actions)
endfunction

//===========================================================================
// Trigger: DoubleClickTimeoutP1
//===========================================================================
function Trig_DoubleClickTimeoutP1_Actions takes nothing returns nothing
    set udg_HasClicked[1]=false
endfunction

//===========================================================================
function InitTrig_DoubleClickTimeoutP1 takes nothing returns nothing
    set gg_trg_DoubleClickTimeoutP1=CreateTrigger()
    call TriggerRegisterTimerExpireEventBJ(gg_trg_DoubleClickTimeoutP1, udg_DoubleClickTimerP1)
    call TriggerAddAction(gg_trg_DoubleClickTimeoutP1, function Trig_DoubleClickTimeoutP1_Actions)
endfunction

//===========================================================================
// Trigger: DoubleClickTimeoutP2
//===========================================================================
function Trig_DoubleClickTimeoutP2_Actions takes nothing returns nothing
    set udg_HasClicked[2]=false
endfunction

//===========================================================================
function InitTrig_DoubleClickTimeoutP2 takes nothing returns nothing
    set gg_trg_DoubleClickTimeoutP2=CreateTrigger()
    call TriggerRegisterTimerExpireEventBJ(gg_trg_DoubleClickTimeoutP2, udg_DoubleClickTimerP2)
    call TriggerAddAction(gg_trg_DoubleClickTimeoutP2, function Trig_DoubleClickTimeoutP2_Actions)
endfunction

//===========================================================================
// Trigger: DoubleClickTimeoutP3
//===========================================================================
function Trig_DoubleClickTimeoutP3_Actions takes nothing returns nothing
    set udg_HasClicked[3]=false
endfunction

//===========================================================================
function InitTrig_DoubleClickTimeoutP3 takes nothing returns nothing
    set gg_trg_DoubleClickTimeoutP3=CreateTrigger()
    call TriggerRegisterTimerExpireEventBJ(gg_trg_DoubleClickTimeoutP3, udg_DoubleClickTimerP3)
    call TriggerAddAction(gg_trg_DoubleClickTimeoutP3, function Trig_DoubleClickTimeoutP3_Actions)
endfunction

//===========================================================================
// Trigger: DoubleClickTimeoutP4
//===========================================================================
function Trig_DoubleClickTimeoutP4_Actions takes nothing returns nothing
    set udg_HasClicked[4]=false
endfunction

//===========================================================================
function InitTrig_DoubleClickTimeoutP4 takes nothing returns nothing
    set gg_trg_DoubleClickTimeoutP4=CreateTrigger()
    call TriggerRegisterTimerExpireEventBJ(gg_trg_DoubleClickTimeoutP4, udg_DoubleClickTimerP4)
    call TriggerAddAction(gg_trg_DoubleClickTimeoutP4, function Trig_DoubleClickTimeoutP4_Actions)
endfunction

//===========================================================================
// Trigger: DoubleClickTimeoutP5
//===========================================================================
function Trig_DoubleClickTimeoutP5_Actions takes nothing returns nothing
    set udg_HasClicked[5]=false
endfunction

//===========================================================================
function InitTrig_DoubleClickTimeoutP5 takes nothing returns nothing
    set gg_trg_DoubleClickTimeoutP5=CreateTrigger()
    call TriggerRegisterTimerExpireEventBJ(gg_trg_DoubleClickTimeoutP5, udg_DoubleClickTimerP5)
    call TriggerAddAction(gg_trg_DoubleClickTimeoutP5, function Trig_DoubleClickTimeoutP5_Actions)
endfunction

//===========================================================================
// Trigger: HeroRevive
//===========================================================================
function Revive takes nothing returns nothing
    local rect r= udg_ReviveRect
    
    call DestroyTimer(GetExpiredTimer())
    
    call ReviveHero(udg_ReviveHero[udg_ReviveReadIndex], GetRectCenterX(r), GetRectCenterY(r), true)
    set udg_ReviveReadIndex=udg_ReviveReadIndex + 1
    
    set r=null
    if udg_ReviveWriteIndex == udg_ReviveReadIndex then
        set udg_ReviveWriteIndex=0
        set udg_ReviveReadIndex=0
    endif
endfunction

function HeroRevive_Conditions takes nothing returns boolean
    if IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) then
    if not IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) then
    if not IsUnitIllusion(GetTriggerUnit()) then
        return true
    endif
    endif
    endif
    return false
endfunction

function HeroRevive_Actions takes nothing returns nothing
    local real reviveTime= 0.
    set udg_ReviveHero[udg_ReviveWriteIndex]=GetTriggerUnit()
    set reviveTime=15. + I2R(GetHeroLevel(udg_ReviveHero[udg_ReviveWriteIndex]))
    call DisplayTextToPlayer(GetOwningPlayer(udg_ReviveHero[udg_ReviveWriteIndex]), 0, 0, GetHeroProperName(udg_ReviveHero[udg_ReviveWriteIndex]) + " revives in " + I2S(R2I(reviveTime)) + " seconds.")
    set udg_ReviveWriteIndex=udg_ReviveWriteIndex + 1
    call TimerStart(CreateTimer(), reviveTime, false, function Revive)
endfunction
//===========================================================================
function InitTrig_HeroRevive takes nothing returns nothing
    set gg_trg_HeroRevive=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_HeroRevive, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_HeroRevive, Condition(function HeroRevive_Conditions))
    call TriggerAddAction(gg_trg_HeroRevive, function HeroRevive_Actions)
endfunction
//===========================================================================
// Trigger: SetHeroColors
//===========================================================================
function Trig_SetHeroColors_Func001Func001Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnumUnit()) == 'E007' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetHeroColors_Func001Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnumUnit()) == 'N001' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetHeroColors_Func001Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnumUnit()) == 'E006' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetHeroColors_Func001Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnumUnit()) == 'O001' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetHeroColors_Func001Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnumUnit()) == 'E001' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetHeroColors_Func001Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnumUnit()) == 'U00I' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetHeroColors_Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnumUnit()) == 'N00F' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SetHeroColors_Func001A takes nothing returns nothing
    if ( Trig_SetHeroColors_Func001Func001C() ) then
        call SetUnitColor(GetEnumUnit(), PLAYER_COLOR_LIGHT_BLUE)
    else
        if ( Trig_SetHeroColors_Func001Func001Func001C() ) then
            call SetUnitColor(GetEnumUnit(), PLAYER_COLOR_BROWN)
        else
            if ( Trig_SetHeroColors_Func001Func001Func001Func001C() ) then
                call SetUnitColor(GetEnumUnit(), PLAYER_COLOR_COAL)
            else
                if ( Trig_SetHeroColors_Func001Func001Func001Func001Func001C() ) then
                    call SetUnitColor(GetEnumUnit(), PLAYER_COLOR_AQUA)
                else
                    if ( Trig_SetHeroColors_Func001Func001Func001Func001Func001Func001C() ) then
                        call SetUnitColor(GetEnumUnit(), PLAYER_COLOR_ORANGE)
                    else
                        if ( Trig_SetHeroColors_Func001Func001Func001Func001Func001Func001Func001C() ) then
                            call SetUnitColor(GetEnumUnit(), PLAYER_COLOR_PEANUT)
                        else
                            if ( Trig_SetHeroColors_Func001Func001Func001Func001Func001Func001Func001Func001C() ) then
                                call SetUnitColor(GetEnumUnit(), PLAYER_COLOR_PURPLE)
                            else
                            endif
                        endif
                    endif
                endif
            endif
        endif
    endif
endfunction

function Trig_SetHeroColors_Actions takes nothing returns nothing
    call ForGroupBJ(udg_PlayerHeroes, function Trig_SetHeroColors_Func001A)
endfunction

//===========================================================================
function InitTrig_SetHeroColors takes nothing returns nothing
    set gg_trg_SetHeroColors=CreateTrigger()
    call TriggerAddAction(gg_trg_SetHeroColors, function Trig_SetHeroColors_Actions)
endfunction

//===========================================================================
// Trigger: ThunderheadCast
//===========================================================================
function Trig_ThunderheadCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01Q' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ThunderheadCast_Actions takes nothing returns nothing
    set udg_ThunderheadCaster=GetTriggerUnit()
    call EnableTrigger(gg_trg_ThunderheadDmg)
    set udg_TempPoint=PolarProjectionBJ(GetUnitLoc(GetSpellTargetUnit()), 150.00, GetRandomDirectionDeg())
    call CreateNUnitsAtLoc(1, 'u000', GetOwningPlayer(udg_ThunderheadCaster), udg_TempPoint, bj_UNIT_FACING)
    call SetUnitFlyHeightBJ(GetLastCreatedUnit(), 1000.00, 0.00)
    call UnitApplyTimedLifeBJ(3.00, 'BTLF', GetLastCreatedUnit())
    call UnitAddAbilityBJ('A01P', GetLastCreatedUnit())
    call IssueTargetOrderBJ(GetLastCreatedUnit(), "thunderbolt", GetSpellTargetUnit())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_ThunderheadCast takes nothing returns nothing
    set gg_trg_ThunderheadCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ThunderheadCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_ThunderheadCast, Condition(function Trig_ThunderheadCast_Conditions))
    call TriggerAddAction(gg_trg_ThunderheadCast, function Trig_ThunderheadCast_Actions)
endfunction

//===========================================================================
// Trigger: ThunderheadDmg
//===========================================================================
function Trig_ThunderheadDmg_Conditions takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A01P', GetEventDamageSource()) > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ThunderheadDmg_Func005002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_ThunderheadCaster)) == true )
endfunction

function Trig_ThunderheadDmg_Func007A takes nothing returns nothing
    call UnitDamageTargetMagic(udg_ThunderheadCaster , GetEnumUnit() , 150.0 + 50.0 * GetUnitAbilityLevel(udg_ThunderheadCaster, 'A01Q') + 0.8 * GetUnitSpellPower(udg_ThunderheadCaster))
endfunction

function Trig_ThunderheadDmg_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_TempPoint=GetUnitLoc(BlzGetEventDamageTarget())
    call AddSpecialEffectLocBJ(udg_TempPoint, "MDX\\Effects\\ThunderheadImpact.mdx")
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(250.00, udg_TempPoint, Condition(function Trig_ThunderheadDmg_Func005002003))
    set udg_DamageAbility=true
    call ForGroupBJ(udg_TempGroup, function Trig_ThunderheadDmg_Func007A)
    set udg_DamageAbility=false
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_ThunderheadDmg takes nothing returns nothing
    set gg_trg_ThunderheadDmg=CreateTrigger()
    call TriggerAddCondition(gg_trg_ThunderheadDmg, Condition(function Trig_ThunderheadDmg_Conditions))
    call TriggerAddAction(gg_trg_ThunderheadDmg, function Trig_ThunderheadDmg_Actions)
endfunction

//===========================================================================
// Trigger: ThunderheadDmgEvent
//===========================================================================
//===========================================================================
function InitTrig_ThunderheadDmgEvent takes nothing returns nothing
    local integer i= 0
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_ThunderheadDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
endfunction
//===========================================================================
// Trigger: SpiritBeastsCast
//===========================================================================
function Trig_SpiritBeastsCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A002'
endfunction

function Trig_SpiritBeastsCast_Actions takes nothing returns nothing
    set udg_SpiritBeastsCaster=GetTriggerUnit()
endfunction

//===========================================================================
function InitTrig_SpiritBeastsCast takes nothing returns nothing
    set gg_trg_SpiritBeastsCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SpiritBeastsCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SpiritBeastsCast, Condition(function Trig_SpiritBeastsCast_Conditions))
    call TriggerAddAction(gg_trg_SpiritBeastsCast, function Trig_SpiritBeastsCast_Actions)
endfunction

//===========================================================================
// Trigger: SpiritBeastsScale
//===========================================================================
function Trig_SpiritBeastsScale_Conditions takes nothing returns boolean
    return GetUnitTypeId(GetTriggerUnit()) == 'o002'
endfunction

function Trig_SpiritBeastsScale_Actions takes nothing returns nothing
    local unit u= GetTriggerUnit()
    local real bonus= 0.3 + 0.05 * GetUnitAbilityLevel(udg_SpiritBeastsCaster, 'A002')
    call BlzSetUnitMaxHP(u, R2I(bonus * BlzGetUnitMaxHP(udg_SpiritBeastsCaster)))
    call BlzSetUnitBaseDamage(u, R2I(bonus * BlzGetUnitBaseDamage(udg_SpiritBeastsCaster, 0)), 0)
    call SetUnitState(u, UNIT_STATE_LIFE, GetUnitState(u, UNIT_STATE_MAX_LIFE))
    call SetUnitColor(u, GetPlayerColor(Player(9)))
    set u=null
endfunction

//===========================================================================
function InitTrig_SpiritBeastsScale takes nothing returns nothing
    set gg_trg_SpiritBeastsScale=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_SpiritBeastsScale, GetWorldBounds())
    call TriggerAddCondition(gg_trg_SpiritBeastsScale, Condition(function Trig_SpiritBeastsScale_Conditions))
    call TriggerAddAction(gg_trg_SpiritBeastsScale, function Trig_SpiritBeastsScale_Actions)
endfunction

//===========================================================================
// Trigger: StormShieldCast
//===========================================================================
function Trig_StormShieldCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01T'
endfunction

function Trig_StormShieldCast_Actions takes nothing returns nothing
    set udg_StormShieldCharges=3
endfunction

//===========================================================================
function InitTrig_StormShieldCast takes nothing returns nothing
    set gg_trg_StormShieldCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_StormShieldCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_StormShieldCast, Condition(function Trig_StormShieldCast_Conditions))
    call TriggerAddAction(gg_trg_StormShieldCast, function Trig_StormShieldCast_Actions)
endfunction

//===========================================================================
// Trigger: StormShieldDmg
//===========================================================================
function Trig_StormShieldDmg_Conditions takes nothing returns boolean
    if GetUnitAbilityLevel(GetTriggerUnit(), 'B00S') > 0 then
    if udg_StormShieldCharges > 0 then
        return true
    endif
    endif
    return false
endfunction

function Trig_StormShieldDmg_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit target= GetEventDamageSource()
    local unit dummy= CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(caster), GetUnitY(caster), 0.0)
    
    call UnitAddAbility(dummy, 'A01X')
    call IssueTargetOrder(dummy, "chainlightning", target)
    call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
    
    call UnitDamageTargetMagic(caster , target , 25.0 + 25.0 * GetUnitAbilityLevel(caster, 'A01T') + 0.3 * GetUnitSpellPower(caster))
    set udg_StormShieldCharges=udg_StormShieldCharges - 1
    if udg_StormShieldCharges <= 0 then
        call UnitRemoveAbility(caster, 'B00S')
    endif
    
    set caster=null
    set target=null
    set dummy=null
endfunction

//===========================================================================
function InitTrig_StormShieldDmg takes nothing returns nothing
    local integer i= 0
    set gg_trg_StormShieldDmg=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_StormShieldDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_StormShieldDmg, Condition(function Trig_StormShieldDmg_Conditions))
    call TriggerAddAction(gg_trg_StormShieldDmg, function Trig_StormShieldDmg_Actions)
endfunction

//===========================================================================
// Trigger: AvatarCast
//===========================================================================
function AvatarTimerEnd takes nothing returns nothing
    local real lifePercent= GetUnitState(udg_AvatarCaster, UNIT_STATE_LIFE) / GetUnitState(udg_AvatarCaster, UNIT_STATE_MAX_LIFE)
    call DestroyTimer(GetExpiredTimer())
    
    call BlzSetUnitMaxHP(udg_AvatarCaster, BlzGetUnitMaxHP(udg_AvatarCaster) - udg_AvatarLifeBonus[udg_AvatarReadIndex])
    set udg_AvatarReadIndex=udg_AvatarReadIndex + 1
    call SetUnitState(udg_AvatarCaster, UNIT_STATE_LIFE, GetUnitState(udg_AvatarCaster, UNIT_STATE_MAX_LIFE) * lifePercent)
    
    if udg_AvatarWriteIndex == udg_AvatarReadIndex then
        set udg_AvatarWriteIndex=0
        set udg_AvatarReadIndex=0
    endif
endfunction

function AvatarSetLifeBonus takes unit u returns nothing
    local real lifePercent= GetUnitState(u, UNIT_STATE_LIFE) / GetUnitState(u, UNIT_STATE_MAX_LIFE)
    
    set udg_AvatarLifeBonus[udg_AvatarWriteIndex]=100 + 50 * GetUnitAbilityLevel(u, udg_AvatarAbilId)
    call BlzSetUnitMaxHP(u, BlzGetUnitMaxHP(u) + udg_AvatarLifeBonus[udg_AvatarWriteIndex])
    set udg_AvatarWriteIndex=udg_AvatarWriteIndex + 1
    call SetUnitState(u, UNIT_STATE_LIFE, GetUnitState(u, UNIT_STATE_MAX_LIFE) * lifePercent)
    
    call TimerStart(CreateTimer(), 20.0, false, function AvatarTimerEnd)
endfunction

function AvatarTargetFilter takes unit caster,unit target returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(caster)) then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
        return true
    endif
    endif
    return false
endfunction

function Trig_AvatarCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_AvatarAbilId
endfunction

function Trig_AvatarCast_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit u= null
    local group g= CreateGroup()
    set udg_AvatarCaster=caster
    
    call GroupEnumUnitsInRange(g, GetUnitX(caster), GetUnitY(caster), 350.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if AvatarTargetFilter(caster , u) then
            call UnitDamageTargetMagic(caster , u , 140.0 + 60.0 * GetUnitAbilityLevel(caster, udg_AvatarAbilId) + GetUnitSpellPower(caster))
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    call AvatarSetLifeBonus(caster)
    
    set caster=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_AvatarCast takes nothing returns nothing
    set gg_trg_AvatarCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AvatarCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_AvatarCast, Condition(function Trig_AvatarCast_Conditions))
    call TriggerAddAction(gg_trg_AvatarCast, function Trig_AvatarCast_Actions)
endfunction

//===========================================================================
// Trigger: SpiritCoil
//===========================================================================

constant function SpiritCoil_GetSpellID takes nothing returns integer
    return 'A014'
endfunction
//-----Projectile dummy-----//
constant function SpiritCoil_DummyID takes nothing returns integer
    return 'e000'
endfunction
//-----Projectile death effect-----//
constant function SpiritCoil_Sfx takes nothing returns string
    return "MDX\\Effects\\SpiritCoilImpact.mdl"
endfunction
//-----Attachment point-----//
constant function SpiritCoil_AttachPoint takes nothing returns string
    return "origin"
endfunction
//-----Movement interval-----//
constant function SpiritCoil_Interval takes nothing returns real
    return 0.03125
endfunction
//-----Filter valid units-----//
function SpiritCoil_FilterUnit takes unit caster,unit u returns boolean
    return IsUnitEnemy(u, GetOwningPlayer(caster)) and not IsUnitType(u, UNIT_TYPE_DEAD) and GetUnitAbilityLevel(u, 'Avul') == 0
endfunction
//-----Get Ability Level-----//
function SpiritCoil_SpellLvl takes unit caster returns integer
    return GetUnitAbilityLevel(caster, ('A014')) // Get the spell level of the caster // INLINED!!
endfunction
//-----Main target damage-----//
function SpiritCoil_Damage takes unit u returns real
    return 170 + 45 * (GetUnitAbilityLevel((u), ('A014'))) + 0.8 * GetUnitSpellPower(u) // INLINED!!
endfunction
//-----Area of Effect-----//
function SpiritCoil_AoE takes integer level returns real
    return 135.
endfunction
//-----Projectile Speed-----//
function SpiritCoil_Speed takes integer level returns real
    return 1100 / ( 1 / (0.03125) ) // INLINED!!
endfunction
//-----Projectile Amount-----//
function SpiritCoil_ProjectileAmount takes integer level returns integer
    return 1
endfunction
//-----Offset Angle-----//
function SpiritCoil_OffsetAngle takes integer projectileAmount returns real
    if projectileAmount == 1 then
        return 0.
    elseif projectileAmount < 4 then
        return ( 30. / ( projectileAmount - 1 ) ) * bj_DEGTORAD
    endif
    return ( 60. / ( projectileAmount - 1 ) ) * bj_DEGTORAD
endfunction
//-----Max range allowed-----//
function SpiritCoil_Range takes integer level returns real
    return 900.
endfunction
//===========================================================================
function SpiritCoil_TimerLoop takes nothing returns nothing
    local integer ID
    local integer listmax= LoadInteger(SpiritCoilHashtable, - 1, 0)
    local unit caster
    local unit array dummyProjectile
    local integer i= 0
    local unit u
    local real angle
    local integer level
    local group enumGroup
    local group array tempGroup
    local real t
    local integer j
    local real r
    local integer k
    local real x
    local real y

    // Now we start looping through all the spell instances
    loop
        exitwhen i >= listmax

        // First we load the saved values of a spell instance
        set i=i + 1
        set ID=LoadInteger(SpiritCoilHashtable, - 1, i)
        set caster=LoadUnitHandle(SpiritCoilHashtable, ID, 1)
        set angle=LoadReal(SpiritCoilHashtable, ID, 2)
        set level=(GetUnitAbilityLevel((caster), ('A014'))) // INLINED!!
        set k=SpiritCoil_ProjectileAmount(level)
        set j=0
        loop
            exitwhen j == k
            set dummyProjectile[j]=LoadUnitHandle(SpiritCoilHashtable, ID, j + 5)
            set tempGroup[j]=LoadGroupHandle(SpiritCoilHashtable, ID, j + ( 5 + k ))
            set j=j + 1
        endloop

        set t=LoadReal(SpiritCoilHashtable, ID, 3)

        if t >= SpiritCoil_Range(level) then
            set j=0
            loop
                exitwhen j == k

                if dummyProjectile[j] != null then
                    call DestroyEffect(AddSpecialEffect(("MDX\\Effects\\SpiritCoilImpact.mdl"), GetUnitX(dummyProjectile[j]), GetUnitY(dummyProjectile[j]))) // INLINED!!
                    call KillUnit(dummyProjectile[j])
                    call DestroyGroup(tempGroup[j])
                endif

                set j=j + 1
            endloop

            if listmax != i then
                call SaveInteger(SpiritCoilHashtable, LoadInteger(SpiritCoilHashtable, - 1, listmax), 0, i)
                call SaveInteger(SpiritCoilHashtable, - 1, i, LoadInteger(SpiritCoilHashtable, - 1, listmax))
                call RemoveSavedInteger(SpiritCoilHashtable, - 1, listmax)
                set i=i - 1
            endif

            set listmax=listmax - 1
            call SaveInteger(SpiritCoilHashtable, - 1, 0, listmax)

            if LoadInteger(SpiritCoilHashtable, 0, 0) + 1 == LoadInteger(SpiritCoilHashtable, 0, - 1) then
                call FlushChildHashtable(SpiritCoilHashtable, 0)
                call PauseTimer(LoadTimerHandle(SpiritCoilHashtable, - 2, 0))
            else
                call SaveInteger(SpiritCoilHashtable, 0, 0, LoadInteger(SpiritCoilHashtable, 0, 0) + 1)
                call SaveInteger(SpiritCoilHashtable, 0, LoadInteger(SpiritCoilHashtable, 0, 0), ID)
            endif

            call FlushChildHashtable(SpiritCoilHashtable, ID)

        else

            if IsUnitType(caster, UNIT_TYPE_DEAD) then
                set j=0
                loop
                    exitwhen j == k

                    if dummyProjectile[j] != null then
                        call DestroyEffect(AddSpecialEffect(("MDX\\Effects\\SpiritCoilImpact.mdl"), GetUnitX(dummyProjectile[j]), GetUnitY(dummyProjectile[j]))) // INLINED!!
                        call KillUnit(dummyProjectile[j])
                        call DestroyGroup(tempGroup[j])
                        set tempGroup[j]=null
                    endif

                    set j=j + 1
                endloop

                if listmax != i then
                    call SaveInteger(SpiritCoilHashtable, LoadInteger(SpiritCoilHashtable, - 1, listmax), 0, i)
                    call SaveInteger(SpiritCoilHashtable, - 1, i, LoadInteger(SpiritCoilHashtable, - 1, listmax))
                    call RemoveSavedInteger(SpiritCoilHashtable, - 1, listmax)
                    set i=i - 1
                endif

                set listmax=listmax - 1
                call SaveInteger(SpiritCoilHashtable, - 1, 0, listmax)

                if LoadInteger(SpiritCoilHashtable, 0, 0) + 1 == LoadInteger(SpiritCoilHashtable, 0, - 1) then
                    call FlushChildHashtable(SpiritCoilHashtable, 0)
                    call PauseTimer(LoadTimerHandle(SpiritCoilHashtable, - 2, 0))
                else
                    call SaveInteger(SpiritCoilHashtable, 0, 0, LoadInteger(SpiritCoilHashtable, 0, 0) + 1)
                    call SaveInteger(SpiritCoilHashtable, 0, LoadInteger(SpiritCoilHashtable, 0, 0), ID)
                endif

                call FlushChildHashtable(SpiritCoilHashtable, ID)
            else
                set enumGroup=CreateGroup()

                // Move the projectiles, dealing damage and slowing enemies
                set j=0
                loop
                    exitwhen j == k
                    set r=angle + ( j * 1. - ( k / 2. - 0.5 ) ) * SpiritCoil_OffsetAngle(k)
                    set x=GetUnitX(dummyProjectile[j]) + SpiritCoil_Speed(level) * Cos(r)
                    set y=GetUnitY(dummyProjectile[j]) + SpiritCoil_Speed(level) * Sin(r)

                    if IsTerrainPathable(x, y, PATHING_TYPE_WALKABILITY) and dummyProjectile[j] != null then
                        call DestroyEffect(AddSpecialEffect(("MDX\\Effects\\SpiritCoilImpact.mdl"), GetUnitX(dummyProjectile[j]), GetUnitY(dummyProjectile[j]))) // INLINED!!
                        call KillUnit(dummyProjectile[j])
                        call DestroyGroup(tempGroup[j])
                        set tempGroup[j]=null
                    else
                        call SetUnitX(dummyProjectile[j], x)
                        call SetUnitY(dummyProjectile[j], y)
                        call GroupEnumUnitsInRange(enumGroup, GetUnitX(dummyProjectile[j]), GetUnitY(dummyProjectile[j]), SpiritCoil_AoE(level), null)
                        loop
                            set u=FirstOfGroup(enumGroup)
                            exitwhen u == null

                            if SpiritCoil_FilterUnit(caster , u) and not IsUnitInGroup(u, tempGroup[j]) then
                                set udg_DamageAbility=true
                                call UnitDamageTargetMagic(caster , u , SpiritCoil_Damage(caster))
                                set udg_DamageAbility=false
                                call DestroyEffect(AddSpecialEffectTarget(("MDX\\Effects\\SpiritCoilImpact.mdl"), u, ("origin"))) // INLINED!!
                                call GroupAddUnit(tempGroup[j], u)
                            endif

                            call GroupRemoveUnit(enumGroup, u)
                        endloop
                    endif
                    set j=j + 1
                endloop

                call DestroyGroup(enumGroup)
                set enumGroup=null
                set t=t + SpiritCoil_Speed(level)
                call SaveReal(SpiritCoilHashtable, ID, 3, t)
            endif
        endif

        set caster=null

        set j=0
        loop
            exitwhen j == k
            set tempGroup[j]=null
            set j=j + 1
        endloop

    endloop
endfunction

// Initiate function

function SpiritCoil_Conditions takes nothing returns boolean
    local unit caster
    local integer ID
    local integer listmax
    local real x1
    local real y1
    local real x2
    local real y2
    local real angle
    local player owner
    local integer i
    local integer j
    local unit dummy

    if GetSpellAbilityId() == ('A014') then // INLINED!!
        set caster=GetTriggerUnit()
        set x1=GetUnitX(caster)
        set y1=GetUnitY(caster)
        set x2=GetSpellTargetX()
        set y2=GetSpellTargetY()
        set angle=Atan2(y2 - y1, x2 - x1)
        set owner=GetTriggerPlayer()
        set ID=LoadInteger(SpiritCoilHashtable, 0, 0)
        set j=SpiritCoil_ProjectileAmount((GetUnitAbilityLevel((caster), ('A014')))) // INLINED!!

        // Now we start indexing the spell
        if ID > 0 then
            call SaveInteger(SpiritCoilHashtable, 0, 0, ID - 1)
            set ID=LoadInteger(SpiritCoilHashtable, 0, ID)
        else
            set ID=LoadInteger(SpiritCoilHashtable, 0, - 1) + 1
            call SaveInteger(SpiritCoilHashtable, 0, - 1, ID)
            if ID == 1 then
                call TimerStart(LoadTimerHandle(SpiritCoilHashtable, - 2, 0), (0.03125), true, function SpiritCoil_TimerLoop) // INLINED!!
            endif
        endif

        // Save the values related to this spell instance
        call SaveUnitHandle(SpiritCoilHashtable, ID, 1, caster)

        set i=0

        loop
            exitwhen i == j
            set dummy=CreateUnit(owner, ('e000'), x1, y1, ( angle + ( i * 1. - ( j / 2. - 0.5 ) ) * SpiritCoil_OffsetAngle(j) ) * bj_RADTODEG) // INLINED!!
            call UnitAddAbility(dummy, 'Arav')
            call UnitRemoveAbility(dummy, 'Arav')
            call SetUnitFlyHeight(dummy, 100, 0.00)
            call SaveUnitHandle(SpiritCoilHashtable, ID, i + 5, dummy)
            call SaveGroupHandle(SpiritCoilHashtable, ID, i + ( 5 + j ), CreateGroup())
            set i=i + 1
        endloop

        call SaveReal(SpiritCoilHashtable, ID, 2, angle)
        call SaveReal(SpiritCoilHashtable, ID, 3, 0)

        set listmax=LoadInteger(SpiritCoilHashtable, - 1, 0) + 1
        call SaveInteger(SpiritCoilHashtable, - 1, 0, listmax)
        call SaveInteger(SpiritCoilHashtable, - 1, listmax, ID)
        call SaveInteger(SpiritCoilHashtable, ID, 0, listmax)

        set caster=null
        set owner=null
        set dummy=null
    endif
    return false
endfunction
//===========================================================================
function InitTrig_SpiritCoil takes nothing returns nothing
    local trigger t= CreateTrigger()
    
    set SpiritCoilHashtable=InitHashtable()
    call SaveTimerHandle(SpiritCoilHashtable, - 2, 0, CreateTimer())
    call TriggerRegisterAnyUnitEventBJ(t, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(t, Condition(function SpiritCoil_Conditions))
    
    set t=null
endfunction
//===========================================================================
// Trigger: DarkSlumber
//===========================================================================
function Trig_DarkSlumber_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A00D'
endfunction

function Trig_DarkSlumber_Actions takes nothing returns nothing
    local unit target= GetSpellTargetUnit()
    
    if IsUnitType(target, UNIT_TYPE_ANCIENT) then
        call TriggerSleepAction(0.0) // Delay to allow the buff to appear before attempting to remove it.
        call UnitRemoveAbility(target, 'B00N')
    endif
    
    set target=null
endfunction

//===========================================================================
function InitTrig_DarkSlumber takes nothing returns nothing
    set gg_trg_DarkSlumber=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_DarkSlumber, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_DarkSlumber, Condition(function Trig_DarkSlumber_Conditions))
    call TriggerAddAction(gg_trg_DarkSlumber, function Trig_DarkSlumber_Actions)
endfunction

//===========================================================================
// Trigger: SiphonAura
//===========================================================================
function Trig_SiphonAura_Conditions takes nothing returns boolean
    if udg_DamageMagic then
    if GetUnitAbilityLevel(GetEventDamageSource(), 'B00G') > 0 then
        return true
    endif
    endif
    return false
endfunction

function Trig_SiphonAura_Actions takes nothing returns nothing
    local unit source= GetEventDamageSource()
    call HealUnit(source , source , ( 0.40 + 0.15 * GetUnitAbilityLevel(source, 'A011') ) * GetEventDamage())
    call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\HealGreen.mdx", source, "origin"))
    set source=null
endfunction

//===========================================================================
function InitTrig_SiphonAura takes nothing returns nothing
    local integer i= 0
    set gg_trg_SiphonAura=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_SiphonAura, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_SiphonAura, Condition(function Trig_SiphonAura_Conditions))
    call TriggerAddAction(gg_trg_SiphonAura, function Trig_SiphonAura_Actions)
endfunction

//===========================================================================
// Trigger: WheelOfDeathCast
//===========================================================================
function Trig_WheelOfDeathCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A013' ) ) then
        return false
    endif
    return true
endfunction

function Trig_WheelOfDeathCast_Actions takes nothing returns nothing
    call DispelUnit(GetTriggerUnit() , false , true)
    call GroupAddUnitSimple(GetTriggerUnit(), udg_WheelOfDeathGroup)
    call EnableTrigger(gg_trg_WheelOfDeathTick)
endfunction

//===========================================================================
function InitTrig_WheelOfDeathCast takes nothing returns nothing
    set gg_trg_WheelOfDeathCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_WheelOfDeathCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_WheelOfDeathCast, Condition(function Trig_WheelOfDeathCast_Conditions))
    call TriggerAddAction(gg_trg_WheelOfDeathCast, function Trig_WheelOfDeathCast_Actions)
endfunction

//===========================================================================
// Trigger: WheelOfDeathTick
//===========================================================================
function Trig_WheelOfDeathTick_Func001Func001Func002Func003002003001 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_TempUnit)) == true )
endfunction

function Trig_WheelOfDeathTick_Func001Func001Func002Func003002003002 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_WheelOfDeathTick_Func001Func001Func002Func003002003 takes nothing returns boolean
    return GetBooleanAnd((IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_TempUnit)) == true), (IsUnitAliveBJ(GetFilterUnit()) == true)) // INLINED!!
endfunction

function Trig_WheelOfDeathTick_Func001Func001Func002Func004A takes nothing returns nothing
    set udg_DamageAbility=true
    call UnitDamageTargetMagic(udg_TempUnit , GetEnumUnit() , ( 240.0 + 60.0 * GetUnitAbilityLevel(udg_TempUnit, 'A013') + 1.2 * GetUnitSpellPower(udg_TempUnit) ) / 8.0)
    set udg_DamageAbility=false
endfunction

function Trig_WheelOfDeathTick_Func001Func001Func002C takes nothing returns boolean
    if ( not ( UnitHasBuffBJ(udg_TempUnit, 'B00H') == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_WheelOfDeathTick_Func001Func001A takes nothing returns nothing
    set udg_TempUnit=GetEnumUnit()
    if ( Trig_WheelOfDeathTick_Func001Func001Func002C() ) then
        set udg_TempPoint=GetUnitLoc(udg_TempUnit)
        set udg_TempGroup=GetUnitsInRangeOfLocMatching(375.00, udg_TempPoint, Condition(function Trig_WheelOfDeathTick_Func001Func001Func002Func003002003))
        call ForGroupBJ(udg_TempGroup, function Trig_WheelOfDeathTick_Func001Func001Func002Func004A)
        call DestroyGroup(udg_TempGroup)
        set udg_TempGroup=null
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
    else
        call GroupRemoveUnitSimple(udg_TempUnit, udg_WheelOfDeathGroup)
    endif
endfunction

function Trig_WheelOfDeathTick_Func001C takes nothing returns boolean
    if ( not ( IsUnitGroupEmptyBJ(udg_WheelOfDeathGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_WheelOfDeathTick_Actions takes nothing returns nothing
    if ( Trig_WheelOfDeathTick_Func001C() ) then
        call DisableTrigger(GetTriggeringTrigger())
    else
        call ForGroupBJ(udg_WheelOfDeathGroup, function Trig_WheelOfDeathTick_Func001Func001A)
    endif
endfunction

//===========================================================================
function InitTrig_WheelOfDeathTick takes nothing returns nothing
    set gg_trg_WheelOfDeathTick=CreateTrigger()
    call DisableTrigger(gg_trg_WheelOfDeathTick)
    call TriggerRegisterTimerEventPeriodic(gg_trg_WheelOfDeathTick, 1.00)
    call TriggerAddAction(gg_trg_WheelOfDeathTick, function Trig_WheelOfDeathTick_Actions)
endfunction

//===========================================================================
// Trigger: SunBladesCast
//===========================================================================

function SunBladesSwapAttackTargetsAllowed takes unit u returns nothing
    local integer attack1TargetsAllowed= BlzGetUnitWeaponIntegerField(u, UNIT_WEAPON_IF_ATTACK_TARGETS_ALLOWED, 0)
    call BlzSetUnitWeaponIntegerFieldBJ(u, UNIT_WEAPON_IF_ATTACK_TARGETS_ALLOWED, 0, BlzGetUnitWeaponIntegerField(u, UNIT_WEAPON_IF_ATTACK_TARGETS_ALLOWED, 1))
    call BlzSetUnitWeaponIntegerFieldBJ(u, UNIT_WEAPON_IF_ATTACK_TARGETS_ALLOWED, 1, attack1TargetsAllowed)
endfunction

function SunBladesEnd takes nothing returns nothing
    call DestroyTimer(GetExpiredTimer())
    
    call SunBladesSwapAttackTargetsAllowed(sunBladesCaster[sunBladesReadIndex])
    call BlzSetUnitWeaponBooleanFieldBJ(sunBladesCaster[sunBladesReadIndex], UNIT_WEAPON_BF_ATTACKS_ENABLED, 1, false) // Disable Attack 2.
    
    set sunBladesReadIndex=sunBladesReadIndex + 1
    if sunBladesWriteIndex == sunBladesReadIndex then
        set sunBladesWriteIndex=0
        set sunBladesReadIndex=0
    endif
endfunction

function Trig_SunBladesCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A015'
endfunction

function Trig_SunBladesCast_Actions takes nothing returns nothing
    local real abilDur= 0.0
    local integer attack2TargetsAllowed= 0
    set sunBladesCaster[sunBladesWriteIndex]=GetTriggerUnit()
    
    call SunBladesSwapAttackTargetsAllowed(sunBladesCaster[sunBladesWriteIndex])
    call BlzSetUnitWeaponBooleanFieldBJ(sunBladesCaster[sunBladesWriteIndex], UNIT_WEAPON_BF_ATTACKS_ENABLED, 1, true) // Enable Attack 2.
    
    set abilDur=BlzGetAbilityRealLevelField(BlzGetUnitAbility(sunBladesCaster[sunBladesWriteIndex], SUN_BLADES_ABIL_ID), ABILITY_RLF_DURATION_NORMAL, GetUnitAbilityLevel(sunBladesCaster[sunBladesWriteIndex], SUN_BLADES_ABIL_ID) - 1)
    call TimerStart(CreateTimer(), abilDur, false, function SunBladesEnd)
    set sunBladesWriteIndex=sunBladesWriteIndex + 1
endfunction

//===========================================================================
function InitTrig_SunBladesCast takes nothing returns nothing
    set gg_trg_SunBladesCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SunBladesCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SunBladesCast, Condition(function Trig_SunBladesCast_Conditions))
    call TriggerAddAction(gg_trg_SunBladesCast, function Trig_SunBladesCast_Actions)
endfunction

//===========================================================================
// Trigger: SunBladesDmgEvt
//===========================================================================

function SunBladesTargetFilter takes unit target,unit source returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(source)) then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
    if not IsUnitHidden(target) then
        return true
    endif
    endif
    endif
    return false
endfunction

function Trig_SunBladesDmgEvt_Conditions takes nothing returns boolean
    if not udg_DamageAbility then
    if not udg_DamageMagic then
    if GetUnitAbilityLevel(GetEventDamageSource(), SUN_BLADES_BUFF_ID) > 0 then
    if IsUnitEnemy(GetTriggerUnit(), GetOwningPlayer(GetEventDamageSource())) then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

function Trig_SunBladesDmgEvt_Actions takes nothing returns nothing
    local unit source= GetEventDamageSource()
    local unit target= GetTriggerUnit()
    local group g= CreateGroup()
    local unit u= null
    call GroupEnumUnitsInRange(g, GetUnitX(target), GetUnitY(target), 225.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if SunBladesTargetFilter(target , source) then
            set udg_DamageAbility=true
            call UnitDamageTargetMagic(source , u , 15.0 + 5.0 * GetUnitAbilityLevel(source, SUN_BLADES_ABIL_ID) + 0.2 * GetUnitSpellPower(source))
            set udg_DamageAbility=false
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Incinerate\\FireLordDeathExplode.mdl", GetUnitX(target), GetUnitY(target)))
    
    set source=null
    set target=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_SunBladesDmgEvt takes nothing returns nothing
    local integer i= 0
    set gg_trg_SunBladesDmgEvt=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_SunBladesDmgEvt, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_SunBladesDmgEvt, Condition(function Trig_SunBladesDmgEvt_Conditions))
    call TriggerAddAction(gg_trg_SunBladesDmgEvt, function Trig_SunBladesDmgEvt_Actions)
endfunction

//===========================================================================
// Trigger: SunBlessingLearn
//===========================================================================
function Trig_SunBlessingLearn_Conditions takes nothing returns boolean
    if ( not ( GetLearnedSkillBJ() == 'A01A' ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_SunBlessingLearnedGroup) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_SunBlessingLearn_Actions takes nothing returns nothing
    call GroupAddUnitSimple(GetTriggerUnit(), udg_SunBlessingLearnedGroup)
    set udg_SunBlessingCaster[udg_SunBlessingCasterIndex]=GetTriggerUnit()
    set udg_SunBlessingCasterIndex=( udg_SunBlessingCasterIndex + 1 )
endfunction

//===========================================================================
function InitTrig_SunBlessingLearn takes nothing returns nothing
    set gg_trg_SunBlessingLearn=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SunBlessingLearn, EVENT_PLAYER_HERO_SKILL)
    call TriggerAddCondition(gg_trg_SunBlessingLearn, Condition(function Trig_SunBlessingLearn_Conditions))
    call TriggerAddAction(gg_trg_SunBlessingLearn, function Trig_SunBlessingLearn_Actions)
endfunction

//===========================================================================
// Trigger: SunBlessingCast
//===========================================================================
function Trig_SunBlessingCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01A' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SunBlessingCast_Func001Func001C takes nothing returns boolean
    if ( not ( GetTriggerUnit() == udg_SunBlessingCaster[GetForLoopIndexA()] ) ) then
        return false
    endif
    return true
endfunction

function Trig_SunBlessingCast_Actions takes nothing returns nothing
    set bj_forLoopAIndex=0
    set bj_forLoopAIndexEnd=udg_SunBlessingCasterIndex
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ( Trig_SunBlessingCast_Func001Func001C() ) then
            call GroupAddUnitSimple(GetSpellTargetUnit(), udg_SunBlessingTargetGroup[GetForLoopIndexA()])
            set udg_TempPoint=GetUnitLoc(GetSpellTargetUnit())
            call CreateNUnitsAtLoc(1, 'u000', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, bj_UNIT_FACING)
            call UnitAddAbilityBJ('A00E', GetLastCreatedUnit())
            call SetUnitAbilityLevelSwapped('A00E', GetLastCreatedUnit(), GetUnitAbilityLevelSwapped('A01A', GetTriggerUnit()))
            call IssueTargetOrderBJ(GetLastCreatedUnit(), "bloodlust", GetSpellTargetUnit())
            call UnitApplyTimedLifeBJ(2.00, 'BTLF', GetLastCreatedUnit())
            call EnableTrigger(gg_trg_SunBlessingTick)
            call RemoveLocation(udg_TempPoint)
            set udg_TempPoint=null
        else
        endif
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
endfunction

//===========================================================================
function InitTrig_SunBlessingCast takes nothing returns nothing
    set gg_trg_SunBlessingCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SunBlessingCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SunBlessingCast, Condition(function Trig_SunBlessingCast_Conditions))
    call TriggerAddAction(gg_trg_SunBlessingCast, function Trig_SunBlessingCast_Actions)
endfunction

//===========================================================================
// Trigger: SunBlessingTick
//===========================================================================
function Trig_SunBlessingTick_Func002Func002Func001Func002C takes nothing returns boolean
    if ( not ( udg_SlaughterCaster[GetForLoopIndexA()] == null ) ) then
        return false
    endif
    return true
endfunction

function Trig_SunBlessingTick_Func002Func002Func001C takes nothing returns boolean
    if ( not ( UnitHasBuffBJ(GetEnumUnit(), 'B00K') == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_SunBlessingTick_Func002Func002A takes nothing returns nothing
    if ( Trig_SunBlessingTick_Func002Func002Func001C() ) then
        set udg_TempBool=true
        if ( Trig_SunBlessingTick_Func002Func002Func001Func002C() ) then
            call HealUnit(GetEnumUnit() , GetEnumUnit() , 0.05 * ( 150.0 + 50.0 * GetUnitAbilityLevel(udg_TempUnit, 'A01A') + 0.6 * GetUnitSpellPower(GetEnumUnit()) ))
        else
            call HealUnit(udg_TempUnit , GetEnumUnit() , 0.05 * ( 150.0 + 50.0 * GetUnitAbilityLevel(udg_TempUnit, 'A01A') + 0.6 * GetUnitSpellPower(udg_TempUnit) ))
        endif
    else
    endif
endfunction

function Trig_SunBlessingTick_Func003C takes nothing returns boolean
    if ( not ( udg_TempBool == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_SunBlessingTick_Actions takes nothing returns nothing
    set udg_TempBool=false
    set bj_forLoopAIndex=0
    set bj_forLoopAIndexEnd=udg_SunBlessingCasterIndex
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_TempUnit=udg_SunBlessingCaster[GetForLoopIndexA()]
        call ForGroupBJ(udg_SunBlessingTargetGroup[GetForLoopIndexA()], function Trig_SunBlessingTick_Func002Func002A)
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    if ( Trig_SunBlessingTick_Func003C() ) then
        call DisableTrigger(GetTriggeringTrigger())
    else
    endif
endfunction

//===========================================================================
function InitTrig_SunBlessingTick takes nothing returns nothing
    set gg_trg_SunBlessingTick=CreateTrigger()
    call DisableTrigger(gg_trg_SunBlessingTick)
    call TriggerRegisterTimerEventPeriodic(gg_trg_SunBlessingTick, 0.50)
    call TriggerAddAction(gg_trg_SunBlessingTick, function Trig_SunBlessingTick_Actions)
endfunction

//===========================================================================
// Trigger: SunShieldDmgEvt
//===========================================================================

function Trig_SunShieldDmgEvt_Conditions takes nothing returns boolean
    if GetUnitAbilityLevel(GetTriggerUnit(), SUN_SHIELD_BUFF_ID) > 0 then
    if udg_DamageMagic then
        return true
    endif
    endif
    return false
endfunction

function Trig_SunShieldDmgEvt_Actions takes nothing returns nothing
    local unit u= GetTriggerUnit()
    local real mana= GetUnitState(u, UNIT_STATE_MANA)
    local real manaBurned= 10.0
    if mana <= manaBurned then
        set manaBurned=mana
    endif
    call SetUnitState(u, UNIT_STATE_MANA, mana - manaBurned)
    set u=null
endfunction

//===========================================================================
function InitTrig_SunShieldDmgEvt takes nothing returns nothing
    local integer i= 0
    set gg_trg_SunShieldDmgEvt=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_SunShieldDmgEvt, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_SunShieldDmgEvt, Condition(function Trig_SunShieldDmgEvt_Conditions))
    call TriggerAddAction(gg_trg_SunShieldDmgEvt, function Trig_SunShieldDmgEvt_Actions)
endfunction


//===========================================================================
// Trigger: MirageCast
//===========================================================================
function Trig_MirageCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A016'
endfunction

function Trig_MirageCast_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit mirage= null
    local integer aLvl= GetUnitAbilityLevel(caster, 'A016')
    local integer i= 0
    local location castLoc= GetUnitLoc(caster)
    local location spawnLoc= null
    local integer numSpawns= 2 + R2I(GetUnitSpellPower(caster)) / 100
    
    call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\MiniResurrection.mdx", caster, "origin"))
    
    loop
        exitwhen i >= numSpawns
        set spawnLoc=PolarProjectionBJ(castLoc, 120.0, ( I2R(i) * ( 360.0 / I2R(numSpawns) ) ))
        set mirage=CreateUnitAtLoc(GetOwningPlayer(caster), 'e00A', spawnLoc, GetUnitFacing(caster))
        
        call SetUnitColor(mirage, GetPlayerColor(Player(5)))
        call SetUnitVertexColor(mirage, 255, 255, 255, 128)
        call DestroyEffect(AddSpecialEffect("MDX\\Effects\\MiniResurrection.mdx", GetUnitX(mirage), GetUnitY(mirage)))
        call UnitApplyTimedLife(mirage, 'BTLF', 10.0)
        
        call BlzSetUnitMaxHP(mirage, R2I(( 0.30 + 0.05 * I2R(aLvl) ) * GetUnitState(caster, UNIT_STATE_MAX_LIFE)))
        call SetUnitState(mirage, UNIT_STATE_LIFE, GetUnitState(mirage, UNIT_STATE_MAX_LIFE) * ( GetUnitState(caster, UNIT_STATE_LIFE) / GetUnitState(caster, UNIT_STATE_MAX_LIFE) ))
        
        call BlzSetUnitBaseDamage(mirage, R2I(( ( 0.30 + 0.05 * I2R(aLvl) ) * I2R(BlzGetUnitBaseDamage(caster, 1)) )), 0)
        call BlzSetUnitDiceNumber(mirage, BlzGetUnitDiceNumber(caster, 1), 0)
        call BlzSetUnitDiceSides(mirage, BlzGetUnitDiceSides(caster, 1), 0)
        call BlzSetUnitAttackCooldown(mirage, BlzGetUnitAttackCooldown(caster, 1), 1)
        
        call BlzSetUnitIntegerFieldBJ(mirage, UNIT_IF_LEVEL, GetUnitLevel(caster))
        call UnitAddType(mirage, UNIT_TYPE_SUMMONED)
        
        call RemoveLocation(spawnLoc)
        set spawnLoc=null
        
        set i=i + 1
    endloop
    
    set caster=null
    set mirage=null
    call RemoveLocation(castLoc)
    set castLoc=null
endfunction

//===========================================================================
function InitTrig_MirageCast takes nothing returns nothing
    set gg_trg_MirageCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_MirageCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_MirageCast, Condition(function Trig_MirageCast_Conditions))
    call TriggerAddAction(gg_trg_MirageCast, function Trig_MirageCast_Actions)
endfunction

//===========================================================================
// Trigger: MirageDeath
//===========================================================================
function Trig_MirageDeath_Conditions takes nothing returns boolean
    return GetUnitTypeId(GetTriggerUnit()) == 'e00A'
endfunction

function Trig_MirageDeath_Actions takes nothing returns nothing
    local unit dying= GetTriggerUnit()
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\BlinkGoldCaster.mdx", GetUnitX(dying), GetUnitY(dying)))
    call RemoveUnit(dying)
    set dying=null
endfunction

//===========================================================================
function InitTrig_MirageDeath takes nothing returns nothing
    set gg_trg_MirageDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_MirageDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_MirageDeath, Condition(function Trig_MirageDeath_Conditions))
    call TriggerAddAction(gg_trg_MirageDeath, function Trig_MirageDeath_Actions)
endfunction

//===========================================================================
// Trigger: ArcaneTorrent
//===========================================================================

function ArcaneTorrentCreateShard takes nothing returns nothing
    call DestroyTimer(GetExpiredTimer())
    call UnitApplyTimedLife(CreateUnit(GetOwningPlayer(arcaneTorrentCaster), 'e009', GetUnitX(arcaneTorrentTarget), GetUnitY(arcaneTorrentTarget), GetRandomReal(0.0, 360.0)), 'BTLF', 1.0)
endfunction

function Trig_ArcaneTorrent_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01O'
endfunction

function Trig_ArcaneTorrent_Actions takes nothing returns nothing
    local integer numShards= 0
    local integer i= 1
    set arcaneTorrentCaster=GetTriggerUnit()
    set arcaneTorrentTarget=GetSpellTargetUnit()
    set numShards=2 + GetUnitAbilityLevel(arcaneTorrentCaster, 'A01O') + R2I(GetUnitSpellPower(arcaneTorrentCaster) / 40.0)
    
    loop
        exitwhen i > numShards
        call TimerStart(CreateTimer(), I2R(i) * 0.2, false, function ArcaneTorrentCreateShard)
        set i=i + 1
    endloop
endfunction

//===========================================================================
function InitTrig_ArcaneTorrent takes nothing returns nothing
    set gg_trg_ArcaneTorrent=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ArcaneTorrent, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_ArcaneTorrent, Condition(function Trig_ArcaneTorrent_Conditions))
    call TriggerAddAction(gg_trg_ArcaneTorrent, function Trig_ArcaneTorrent_Actions)
endfunction

//===========================================================================
// Trigger: ArcaneTorrentDummyDeath
//
// NOTE: Not MUI.
//===========================================================================
function ArcaneTorrentTargetFilter takes unit target,unit dying returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(dying)) then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
        return true
    endif
    endif
    return false
endfunction

function Trig_ArcaneTorrentDummyDeath_Conditions takes nothing returns boolean
    return GetUnitTypeId(GetTriggerUnit()) == 'e009'
endfunction

function Trig_ArcaneTorrentDummyDeath_Actions takes nothing returns nothing
    local unit dying= GetTriggerUnit()
    local unit u= null
    local location l= GetUnitLoc(dying)
    local group g= CreateGroup()
    local integer i= 0
    
    call GroupEnumUnitsInRange(g, GetLocationX(l), GetLocationY(l), 150.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if ArcaneTorrentTargetFilter(u , dying) then
            call UnitDamageTargetMagic(arcaneTorrentCaster , u , 60.0 + 0.25 * GetUnitSpellPower(arcaneTorrentCaster))
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    set dying=null
    call RemoveLocation(l)
    set l=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_ArcaneTorrentDummyDeath takes nothing returns nothing
    set gg_trg_ArcaneTorrentDummyDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ArcaneTorrentDummyDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_ArcaneTorrentDummyDeath, Condition(function Trig_ArcaneTorrentDummyDeath_Conditions))
    call TriggerAddAction(gg_trg_ArcaneTorrentDummyDeath, function Trig_ArcaneTorrentDummyDeath_Actions)
endfunction

//===========================================================================
// Trigger: Amplify
//===========================================================================

function Trig_Amplify_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01S'
endfunction

function Trig_Amplify_Actions takes nothing returns nothing
    local effect sfx= AddSpecialEffectTarget("MDX\\Effects\\EldritchScroll.mdx", GetSpellTargetUnit(), "origin")
    call BlzSetSpecialEffectScale(sfx, 0.5)
    call DestroyEffect(sfx)
    set amplifyCaster=GetTriggerUnit()
    set sfx=null
endfunction

//===========================================================================
function InitTrig_Amplify takes nothing returns nothing
    set gg_trg_Amplify=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Amplify, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_Amplify, Condition(function Trig_Amplify_Conditions))
    call TriggerAddAction(gg_trg_Amplify, function Trig_Amplify_Actions)
endfunction

//===========================================================================
// Trigger: NetherFlux
//===========================================================================
function Trig_NetherFlux_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01Y'
endfunction

function Trig_NetherFlux_Actions takes nothing returns nothing
    local unit target= GetSpellTargetUnit()
    
    call IssueImmediateOrder(target, "stop")
    
    if IsUnitType(target, UNIT_TYPE_ANCIENT) then
        call TriggerSleepAction(0.0) // Delay to allow the buff to appear before attempting to remove it.
        call UnitRemoveAbility(target, 'B00T')
    endif
    
    set target=null
endfunction

//===========================================================================
function InitTrig_NetherFlux takes nothing returns nothing
    set gg_trg_NetherFlux=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_NetherFlux, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_NetherFlux, Condition(function Trig_NetherFlux_Conditions))
    call TriggerAddAction(gg_trg_NetherFlux, function Trig_NetherFlux_Actions)
endfunction

//===========================================================================
// Trigger: ArcaneNovaFinish
//===========================================================================
function Trig_ArcaneNovaFinish_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01N' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ArcaneNovaFinish_Func009Func001C takes nothing returns boolean
    if ( not ( IsUnitEnemy(GetEnumUnit(), GetOwningPlayer(GetTriggerUnit())) == true ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('Avul', GetEnumUnit()) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ArcaneNovaFinish_Func009A takes nothing returns nothing
    if ( Trig_ArcaneNovaFinish_Func009Func001C() ) then
        set udg_TempInt=( udg_TempInt + 1 )
    else
        call GroupRemoveUnitSimple(GetEnumUnit(), udg_TempGroup)
    endif
endfunction

function Trig_ArcaneNovaFinish_Func010A takes nothing returns nothing
    call UnitDamageTargetMagic(GetTriggerUnit() , GetEnumUnit() , ( 240.0 + 80.0 * GetUnitAbilityLevel(GetTriggerUnit(), 'A01N') + 1.2 * GetUnitSpellPower(GetTriggerUnit()) ) / udg_TempInt)
endfunction

function Trig_ArcaneNovaFinish_Actions takes nothing returns nothing
    set udg_ArcaneNovaPoint=GetSpellTargetLoc()
    call SetUnitAnimation(GetTriggerUnit(), "spell")
    call QueueUnitAnimationBJ(GetTriggerUnit(), "stand")
    call AddSpecialEffectLocBJ(udg_ArcaneNovaPoint, "MDX\\Effects\\ArcaneNova.mdx")
    call BlzSetSpecialEffectScale(GetLastCreatedEffectBJ(), 0.75)
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
    set udg_TempGroup=GetUnitsInRangeOfLocAll(300.00, udg_ArcaneNovaPoint)
    set udg_TempInt=0
    call ForGroupBJ(udg_TempGroup, function Trig_ArcaneNovaFinish_Func009A)
    call ForGroupBJ(udg_TempGroup, function Trig_ArcaneNovaFinish_Func010A)
    call RemoveLocation(udg_ArcaneNovaPoint)
    set udg_ArcaneNovaPoint=null
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_ArcaneNovaFinish takes nothing returns nothing
    set gg_trg_ArcaneNovaFinish=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ArcaneNovaFinish, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_ArcaneNovaFinish, Condition(function Trig_ArcaneNovaFinish_Conditions))
    call TriggerAddAction(gg_trg_ArcaneNovaFinish, function Trig_ArcaneNovaFinish_Actions)
endfunction

//===========================================================================
// Trigger: RayOfLight
//===========================================================================
function Trig_RayOfLight_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01W'
endfunction

function Trig_RayOfLight_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit target= GetSpellTargetUnit()
    local real amount= 250.0 + 75.0 * GetUnitAbilityLevel(caster, 'A01W') + GetUnitSpellPower(caster)
    
    if IsUnitEnemy(target, GetOwningPlayer(caster)) then
        set udg_DamageAbility=true
        call UnitDamageTargetMagic(caster , target , 0.5 * amount)
        set udg_DamageAbility=false
    else
        call HealUnit(caster , target , amount)
    endif
    
    call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\HolyLight.mdx", target, "origin"))
    
    set caster=null
    set target=null
endfunction

//===========================================================================
function InitTrig_RayOfLight takes nothing returns nothing
    set gg_trg_RayOfLight=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_RayOfLight, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_RayOfLight, Condition(function Trig_RayOfLight_Conditions))
    call TriggerAddAction(gg_trg_RayOfLight, function Trig_RayOfLight_Actions)
endfunction

//===========================================================================
// Trigger: ShiningGaze
//===========================================================================
function Trig_ShiningGaze_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A023'
endfunction

function Trig_ShiningGaze_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit target= GetSpellTargetUnit()
    local unit dummy= null
    local integer dummyBlindLevel= 1
    
    call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\GlimpseofMaddness.mdx", caster, "head"))
    
    if not IsUnitStatusImmune(target) then
    
        // Interrupt
        set dummy=CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(target), GetUnitY(target), 0.0)
        call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
        call UnitAddAbility(dummy, udg_InterruptAbilId)
        call IssueTargetOrder(dummy, udg_InterruptAbilOrder, target)
        
        // Blind
        set dummy=CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(target), GetUnitY(target), 0.0)
        call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
        call UnitAddAbility(dummy, 'A025')
        set dummyBlindLevel=GetUnitAbilityLevel(caster, 'A023')
        
        // Lvl 5-8 for bosses; 20% miss chance.
        if IsUnitType(target, UNIT_TYPE_ANCIENT) then
            set dummyBlindLevel=dummyBlindLevel + 4
        endif
        
        call SetUnitAbilityLevel(dummy, 'A025', dummyBlindLevel)
        call IssueTargetOrder(dummy, "curse", target)
        
    endif
    
    set caster=null
    set target=null
    set dummy=null
endfunction

//===========================================================================
function InitTrig_ShiningGaze takes nothing returns nothing
    set gg_trg_ShiningGaze=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShiningGaze, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_ShiningGaze, Condition(function Trig_ShiningGaze_Conditions))
    call TriggerAddAction(gg_trg_ShiningGaze, function Trig_ShiningGaze_Actions)
endfunction

//===========================================================================
// Trigger: HolyShield
//===========================================================================
function Trig_HolyShield_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A024'
endfunction

function Trig_HolyShield_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit target= GetSpellTargetUnit()
    local unit dummy= CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(target), GetUnitY(target), 0.0)
    
    call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
    call UnitAddAbility(dummy, 'A026')
    call SetUnitAbilityLevel(dummy, 'A026', GetUnitAbilityLevel(caster, 'A024'))
    call IssueTargetOrder(dummy, "spiritlink", target)
        
    set caster=null
    set target=null
    set dummy=null
endfunction

//===========================================================================
function InitTrig_HolyShield takes nothing returns nothing
    set gg_trg_HolyShield=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_HolyShield, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_HolyShield, Condition(function Trig_HolyShield_Conditions))
    call TriggerAddAction(gg_trg_HolyShield, function Trig_HolyShield_Actions)
endfunction

//===========================================================================
// Trigger: HolyShieldDmgEvent
//===========================================================================
function Trig_HolyShieldDmgEvent_Conditions takes nothing returns boolean
    return GetUnitAbilityLevel(GetTriggerUnit(), 'B00V') > 0
endfunction

function Trig_HolyShieldDmgEvent_Actions takes nothing returns nothing
    call BlzSetEventDamage(0.0)
endfunction

//===========================================================================
function InitTrig_HolyShieldDmgEvent takes nothing returns nothing
    local integer i= 0
    set gg_trg_HolyShieldDmgEvent=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_HolyShieldDmgEvent, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_HolyShieldDmgEvent, Condition(function Trig_HolyShieldDmgEvent_Conditions))
    call TriggerAddAction(gg_trg_HolyShieldDmgEvent, function Trig_HolyShieldDmgEvent_Actions)
endfunction


//===========================================================================
// Trigger: RadiantNova
//===========================================================================
function Trig_RadiantNova_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A00F'
endfunction

function RadiantNovaTargetFilter takes unit target,unit caster returns boolean
    if IsUnitAlly(target, GetOwningPlayer(caster)) then
    if not IsUnitHidden(target) then
        return true
    endif
    endif
    return false
endfunction

function Trig_RadiantNova_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local group g= CreateGroup()
    local unit u= null
    local integer numTargets= 0
    local real x= GetSpellTargetX()
    local real y= GetSpellTargetY()
    
    // Count number of targets.
    call GroupEnumUnitsInRange(g, x, y, 300.0, null)
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if RadiantNovaTargetFilter(u , caster) then
            set numTargets=numTargets + 1
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    call GroupClear(g)
    
    // Heal targets by amount divided by number of targets.
    call GroupEnumUnitsInRange(g, x, y, 300.0, null)
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if RadiantNovaTargetFilter(u , caster) then
            call HealUnit(caster , u , ( 375.0 + 75.0 * GetUnitAbilityLevel(caster, 'A00F') + 1.2 * GetUnitSpellPower(caster) ) / I2R(numTargets))
            call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\HealYellow.mdx", u, "origin"))
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    set caster=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_RadiantNova takes nothing returns nothing
    set gg_trg_RadiantNova=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_RadiantNova, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_RadiantNova, Condition(function Trig_RadiantNova_Conditions))
    call TriggerAddAction(gg_trg_RadiantNova, function Trig_RadiantNova_Actions)
endfunction

//===========================================================================
// Trigger: HealingStreamCast
//===========================================================================
function Trig_HealingStreamCast_Func001001 takes nothing returns boolean
    return ( GetSpellAbilityId() == 'A00X' )
endfunction

function Trig_HealingStreamCast_Func001002 takes nothing returns boolean
    return ( GetSpellAbilityId() == 'A00W' )
endfunction

function Trig_HealingStreamCast_Func002C takes nothing returns boolean
    if ( ( GetSpellAbilityId() == 'A00X' ) ) then
        return true
    endif
    if ( ( GetSpellAbilityId() == 'A00W' ) ) then
        return true
    endif
    return false
endfunction

function Trig_HealingStreamCast_Conditions takes nothing returns boolean
    if ( not GetBooleanOr((GetSpellAbilityId() == 'A00X'), (GetSpellAbilityId() == 'A00W')) ) then // INLINED!!
        return false
    endif
    if ( not Trig_HealingStreamCast_Func002C() ) then
        return false
    endif
    return true
endfunction

function Trig_HealingStreamCast_Func003C takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00X' ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealingStreamCast_Func010Func001002003 takes nothing returns boolean
    return ( IsUnitAlly(GetFilterUnit(), GetOwningPlayer(udg_HealingStreamCaster)) == true )
endfunction

function Trig_HealingStreamCast_Func010Func003Func001C takes nothing returns boolean
    if ( not ( udg_TempBool == false ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetEnumUnit(), udg_HealingStreamGroup) == false ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetEnumUnit()) < 100.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealingStreamCast_Func010Func003A takes nothing returns nothing
    if ( Trig_HealingStreamCast_Func010Func003Func001C() ) then
        set udg_TempBool=true
        call CreateNUnitsAtLoc(1, 'u000', GetOwningPlayer(udg_HealingStreamCaster), udg_TempPoint, bj_UNIT_FACING)
        call UnitApplyTimedLifeBJ(2.00, 'BTLF', GetLastCreatedUnit())
        call UnitAddAbilityBJ('A00W', GetLastCreatedUnit())
        call IssueTargetOrderBJ(GetLastCreatedUnit(), "healingwave", GetEnumUnit())
    else
    endif
endfunction

function Trig_HealingStreamCast_Func010C takes nothing returns boolean
    if ( not ( udg_HealingStreamBounceCount > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealingStreamCast_Actions takes nothing returns nothing
    if ( Trig_HealingStreamCast_Func003C() ) then
        set udg_HealingStreamCaster=GetTriggerUnit()
        set udg_HealingStreamBounceCount=( 2 + GetUnitAbilityLevelSwapped('A00X', GetTriggerUnit()) )
        set udg_HealingStreamMultiplier=1.00
        call GroupClear(udg_HealingStreamGroup)
    else
        set udg_HealingStreamBounceCount=( udg_HealingStreamBounceCount - 1 )
        set udg_HealingStreamMultiplier=( udg_HealingStreamMultiplier - 0.15 )
    endif
    call AddSpecialEffectTargetUnitBJ("origin", GetSpellTargetUnit(), "MDX\\Effects\\HealingStreamTarget.mdx")
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
    set udg_TempPoint=GetUnitLoc(GetSpellTargetUnit())
    call PlaySoundAtPointBJ(gg_snd_MoonWellWhat1, 100, udg_TempPoint, 0)
    call HealUnit(udg_HealingStreamCaster , GetSpellTargetUnit() , ( 250.0 + 50.0 * GetUnitAbilityLevel(udg_HealingStreamCaster, 'A00X') + 0.8 * GetUnitSpellPower(udg_HealingStreamCaster) ) * udg_HealingStreamMultiplier)
    call GroupAddUnitSimple(GetSpellTargetUnit(), udg_HealingStreamGroup)
    if ( Trig_HealingStreamCast_Func010C() ) then
        set udg_TempGroup=GetUnitsInRangeOfLocMatching(500.00, udg_TempPoint, Condition(function Trig_HealingStreamCast_Func010Func001002003))
        set udg_TempBool=false
        call ForGroupBJ(udg_TempGroup, function Trig_HealingStreamCast_Func010Func003A)
        call DestroyGroup(udg_TempGroup)
        set udg_TempGroup=null
    else
    endif
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_HealingStreamCast takes nothing returns nothing
    set gg_trg_HealingStreamCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_HealingStreamCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_HealingStreamCast, Condition(function Trig_HealingStreamCast_Conditions))
    call TriggerAddAction(gg_trg_HealingStreamCast, function Trig_HealingStreamCast_Actions)
endfunction

//===========================================================================
// Trigger: FireTotemCast
//===========================================================================
function FireTotemTargetFilter takes unit caster,unit target returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(caster)) then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
        return true
    endif
    endif
    return false
endfunction

function Trig_FireTotemCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01G'
endfunction

function Trig_FireTotemCast_Actions takes nothing returns nothing
    local unit u= null
    local group g= CreateGroup()
    local real x= GetSpellTargetX()
    local real y= GetSpellTargetY()
    set udg_FireTotemCaster=GetTriggerUnit()
    
    set u=CreateUnit(GetOwningPlayer(udg_FireTotemCaster), 'o004', x, y, 270.0)
    call SetUnitAnimation(u, "birth")
    call QueueUnitAnimation(u, "stand")
    call UnitApplyTimedLife(u, 'BTLF', 15.0)
    call GroupEnumUnitsInRange(g, x, y, 190.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if FireTotemTargetFilter(udg_FireTotemCaster , u) then
            call UnitDamageTargetMagic(udg_FireTotemCaster , u , 140.0 + 40.0 * GetUnitAbilityLevel(udg_FireTotemCaster, 'A01G') + 0.7 * GetUnitSpellPower(udg_FireTotemCaster))
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_FireTotemCast takes nothing returns nothing
    set gg_trg_FireTotemCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FireTotemCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_FireTotemCast, Condition(function Trig_FireTotemCast_Conditions))
    call TriggerAddAction(gg_trg_FireTotemCast, function Trig_FireTotemCast_Actions)
endfunction

//===========================================================================
// Trigger: EarthShield
//===========================================================================

function Trig_EarthShield_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == EARTH_SHIELD_ABILITY_ID
endfunction

function Trig_EarthShield_Actions takes nothing returns nothing
    local unit caster= GetSpellAbilityUnit()
    local unit target= GetSpellTargetUnit()
    local unit dummy= CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(target), GetUnitY(target), 0.0)
    
    call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
    call UnitAddAbility(dummy, EARTH_SHIELD_DUMMY_ABILITY_ID)
    call SetUnitAbilityLevel(dummy, EARTH_SHIELD_DUMMY_ABILITY_ID, GetUnitAbilityLevel(caster, EARTH_SHIELD_ABILITY_ID))
    call IssueTargetOrder(dummy, "innerfire", GetSpellTargetUnit())
    
    if GetUnitAbilityLevel(target, EARTH_SHIELD_BUFF_LEVEL_ID) == 0 then
        call UnitAddAbility(target, EARTH_SHIELD_BUFF_LEVEL_ID)
        call SetUnitAbilityLevel(target, EARTH_SHIELD_BUFF_LEVEL_ID, GetUnitAbilityLevel(caster, EARTH_SHIELD_ABILITY_ID))
    endif
    
    set caster=null
    set target=null
    set dummy=null
endfunction

//===========================================================================
function InitTrig_EarthShield takes nothing returns nothing
    set gg_trg_EarthShield=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_EarthShield, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_EarthShield, Condition(function Trig_EarthShield_Conditions))
    call TriggerAddAction(gg_trg_EarthShield, function Trig_EarthShield_Actions)
endfunction

//===========================================================================
// Trigger: TranqTotemCast
//===========================================================================
function Trig_TranqTotemCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A001' ) ) then
        return false
    endif
    return true
endfunction

function Trig_TranqTotemCast_Func001C takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_TranqTotemCasterGroup) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_TranqTotemCast_Actions takes nothing returns nothing
    if ( Trig_TranqTotemCast_Func001C() ) then
        call GroupAddUnitSimple(GetTriggerUnit(), udg_TranqTotemCasterGroup)
    else
    endif
    set udg_TempPoint=GetSpellTargetLoc()
    call AddSpecialEffectLocBJ(udg_TempPoint, "MDX\\Effects\\HealingTotem.mdx")
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
endfunction

//===========================================================================
function InitTrig_TranqTotemCast takes nothing returns nothing
    set gg_trg_TranqTotemCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_TranqTotemCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_TranqTotemCast, Condition(function Trig_TranqTotemCast_Conditions))
    call TriggerAddAction(gg_trg_TranqTotemCast, function Trig_TranqTotemCast_Actions)
endfunction

//===========================================================================
// Trigger: TranqTotemBirth
//===========================================================================
function Trig_TranqTotemBirth_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'o000' ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_TranqTotemGroup) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_TranqTotemBirth_Func002C takes nothing returns boolean
    if ( not ( IsTriggerEnabled(gg_trg_TranqTotemTick) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_TranqTotemBirth_Actions takes nothing returns nothing
    call GroupAddUnitSimple(GetTriggerUnit(), udg_TranqTotemGroup)
    if ( Trig_TranqTotemBirth_Func002C() ) then
        call EnableTrigger(gg_trg_TranqTotemTick)
    else
    endif
endfunction

//===========================================================================
function InitTrig_TranqTotemBirth takes nothing returns nothing
    set gg_trg_TranqTotemBirth=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_TranqTotemBirth, GetPlayableMapRect())
    call TriggerAddCondition(gg_trg_TranqTotemBirth, Condition(function Trig_TranqTotemBirth_Conditions))
    call TriggerAddAction(gg_trg_TranqTotemBirth, function Trig_TranqTotemBirth_Actions)
endfunction

//===========================================================================
// Trigger: TranqTotemDeath
//===========================================================================
function Trig_TranqTotemDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'o000' ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_TranqTotemGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_TranqTotemDeath_Func002C takes nothing returns boolean
    if ( not ( IsUnitGroupEmptyBJ(udg_TranqTotemGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_TranqTotemDeath_Actions takes nothing returns nothing
    call GroupRemoveUnitSimple(GetTriggerUnit(), udg_TranqTotemGroup)
    if ( Trig_TranqTotemDeath_Func002C() ) then
        call DisableTrigger(gg_trg_TranqTotemTick)
    else
    endif
endfunction

//===========================================================================
function InitTrig_TranqTotemDeath takes nothing returns nothing
    set gg_trg_TranqTotemDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_TranqTotemDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_TranqTotemDeath, Condition(function Trig_TranqTotemDeath_Conditions))
    call TriggerAddAction(gg_trg_TranqTotemDeath, function Trig_TranqTotemDeath_Actions)
endfunction

//===========================================================================
// Trigger: TranqTotemTick
//===========================================================================
function Trig_TranqTotemTick_Func001Func003Func001C takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnumUnit()) == GetOwningPlayer(udg_TempUnit) ) ) then
        return false
    endif
    return true
endfunction

function Trig_TranqTotemTick_Func001Func003A takes nothing returns nothing
    if ( Trig_TranqTotemTick_Func001Func003Func001C() ) then
        set udg_TranqTotemCaster=GetEnumUnit()
    else
    endif
endfunction

function Trig_TranqTotemTick_Func001Func006002003 takes nothing returns boolean
    return ( IsUnitAlly(GetFilterUnit(), GetOwningPlayer(udg_TranqTotemCaster)) == true )
endfunction

function Trig_TranqTotemTick_Func001Func009A takes nothing returns nothing
    call HealUnit(udg_TranqTotemCaster , GetEnumUnit() , ( 240.0 + 40.0 * GetUnitAbilityLevel(udg_TranqTotemCaster, 'A001') + 0.8 * GetUnitSpellPower(udg_TranqTotemCaster) ) / 5.0)
    call RestoreMana(GetEnumUnit() , 5.0)
    call AddSpecialEffectTargetUnitBJ("origin", GetEnumUnit(), "MDX\\Effects\\HealingTotemTarget.mdx")
    call BlzSetSpecialEffectScale(GetLastCreatedEffectBJ(), 0.80)
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
endfunction

function Trig_TranqTotemTick_Func001A takes nothing returns nothing
    set udg_TempUnit=GetEnumUnit()
    // Get Caster
    call ForGroupBJ(udg_TranqTotemCasterGroup, function Trig_TranqTotemTick_Func001Func003A)
    //  
    set udg_TempPoint=GetUnitLoc(GetEnumUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(500.00, udg_TempPoint, Condition(function Trig_TranqTotemTick_Func001Func006002003))
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call ForGroupBJ(udg_TempGroup, function Trig_TranqTotemTick_Func001Func009A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

function Trig_TranqTotemTick_Actions takes nothing returns nothing
    call ForGroupBJ(udg_TranqTotemGroup, function Trig_TranqTotemTick_Func001A)
endfunction

//===========================================================================
function InitTrig_TranqTotemTick takes nothing returns nothing
    set gg_trg_TranqTotemTick=CreateTrigger()
    call DisableTrigger(gg_trg_TranqTotemTick)
    call TriggerRegisterTimerEventPeriodic(gg_trg_TranqTotemTick, 1.00)
    call TriggerAddAction(gg_trg_TranqTotemTick, function Trig_TranqTotemTick_Actions)
endfunction

//===========================================================================
// Trigger: Rake
//===========================================================================

function RakeTargetFilter takes unit source,unit target returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(source)) then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
    if GetUnitState(target, UNIT_STATE_LIFE) > 0.0 then
        return true
    endif
    endif
    endif
    return false
endfunction

function Trig_Rake_Conditions takes nothing returns boolean
    if not udg_DamageAbility then
    if not udg_DamageMagic then
    if GetUnitAbilityLevel(GetEventDamageSource(), rakeBuffId) > 0 then
    if IsUnitEnemy(BlzGetEventDamageTarget(), GetOwningPlayer(GetEventDamageSource())) then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

function Trig_Rake_Actions takes nothing returns nothing
    local unit source= GetEventDamageSource()
    local unit u= BlzGetEventDamageTarget()
    local unit dummy= CreateUnit(GetOwningPlayer(source), rakeSFXDummyId, GetUnitX(u), GetUnitY(u), GetUnitFacing(source))
    local group g= CreateGroup()
    
    call UnitRemoveAbility(source, rakeBuffId)
    call UnitApplyTimedLife(dummy, 'BTLF', 1.0)
    call BlzSetEventDamage(0.0) // To remove original damage on primary target.
    call GroupEnumUnitsInRange(g, GetUnitX(u), GetUnitY(u), 225.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if RakeTargetFilter(source , u) then
            set udg_DamageAbility=true
            call UnitDamageTarget(source, u, 25.0 + 25.0 * GetUnitAbilityLevel(source, rakeAbilId) + GetUnitDamage(source), true, false, ATTACK_TYPE_MELEE, DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS)
            set udg_DamageAbility=false
            set dummy=CreateUnit(GetOwningPlayer(source), udg_DummyUnitId, GetUnitX(u), GetUnitY(u), 0.0)
            call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
            call UnitAddAbility(dummy, rakeDummyAbilId)
            call SetUnitAbilityLevel(dummy, rakeDummyAbilId, GetUnitAbilityLevel(source, rakeAbilId))
            call IssueTargetOrder(dummy, "cripple", u)
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    set source=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_Rake takes nothing returns nothing
    local integer i= 0
    set gg_trg_Rake=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_Rake, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_Rake, Condition(function Trig_Rake_Conditions))
    call TriggerAddAction(gg_trg_Rake, function Trig_Rake_Actions)
endfunction

//===========================================================================
// Trigger: Umbra
//===========================================================================
function Trig_Umbra_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01I'
endfunction

function Trig_Umbra_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit target= GetSpellTargetUnit()
    local unit dummy= CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(target), GetUnitY(target), 0.0)
    local location l= GetUnitLoc(target)

    call DisableTrigger(gg_trg_Rake)
    call BlzStartUnitAbilityCooldown(caster, 'A01I', BlzGetUnitAbilityCooldown(caster, 'A01I', GetUnitAbilityLevel(caster, 'A01I') - 1)) // - 1 for level offset.
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\BlinkRedCaster.mdx", GetUnitX(caster), GetUnitY(caster)))
    
    call SetUnitPositionLoc(caster, l)
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\BlinkRedTarget.mdx", GetUnitX(caster), GetUnitY(caster)))
    
    if IsUnitEnemy(target, GetOwningPlayer(caster)) then
        call InterruptTarget(target , caster)
        
        set udg_DamageAbility=true
        call UnitDamageTargetMagic(caster , target , 40.0 + 40.0 * GetUnitAbilityLevel(caster, 'A01I') + 0.8 * GetUnitSpellPower(caster))
        set udg_DamageAbility=false
        
        call DestroyEffect(AddSpecialEffect("MDX\\Effects\\BlinkRedTarget.mdx", GetUnitX(target), GetUnitY(target)))
    endif
    
    set caster=null
    set target=null
    set dummy=null
    call RemoveLocation(l)
    set l=null
    
    call EnableTrigger(gg_trg_Rake)
endfunction

//===========================================================================
function InitTrig_Umbra takes nothing returns nothing
    set gg_trg_Umbra=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_Umbra, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_Umbra, Condition(function Trig_Umbra_Conditions))
    call TriggerAddAction(gg_trg_Umbra, function Trig_Umbra_Actions)
endfunction

//===========================================================================
// Trigger: SlaughterCast
//===========================================================================
function Trig_SlaughterCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01J' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SlaughterCast_Actions takes nothing returns nothing
    set udg_SlaughterCaster[udg_SlaughterWriteIndex]=GetTriggerUnit()
    set udg_SlaughterPoint[udg_SlaughterWriteIndex]=GetUnitLoc(udg_SlaughterCaster[udg_SlaughterWriteIndex])
    set udg_SlaughterTPCount[udg_SlaughterWriteIndex]=0
    set udg_SlaughterTarget[udg_SlaughterWriteIndex]=null
    set udg_SlaughterWriteIndex=( udg_SlaughterWriteIndex + 1 )
    call EnableTrigger(gg_trg_SlaughterTick)
endfunction

//===========================================================================
function InitTrig_SlaughterCast takes nothing returns nothing
    set gg_trg_SlaughterCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SlaughterCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SlaughterCast, Condition(function Trig_SlaughterCast_Conditions))
    call TriggerAddAction(gg_trg_SlaughterCast, function Trig_SlaughterCast_Actions)
endfunction

//===========================================================================
// Trigger: SlaughterTick
//===========================================================================
function Trig_SlaughterTick_Func001Func001Func004002003001 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_SlaughterCaster[GetForLoopIndexA()])) == true )
endfunction

function Trig_SlaughterTick_Func001Func001Func004002003002001 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_SlaughterTick_Func001Func001Func004002003002002 takes nothing returns boolean
    return ( GetUnitAbilityLevelSwapped('Avul', GetFilterUnit()) == 0 )
endfunction

function Trig_SlaughterTick_Func001Func001Func004002003002 takes nothing returns boolean
    return GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit()) == true), (GetUnitAbilityLevelSwapped('Avul', GetFilterUnit()) == 0)) // INLINED!!
endfunction

function Trig_SlaughterTick_Func001Func001Func004002003 takes nothing returns boolean
    return GetBooleanAnd((IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_SlaughterCaster[GetForLoopIndexA()])) == true), (GetBooleanAnd((IsUnitAliveBJ(GetFilterUnit()) == true), (GetUnitAbilityLevelSwapped('Avul', GetFilterUnit()) == 0)))) // INLINED!!
endfunction

function Trig_SlaughterTick_Func001Func001Func006C takes nothing returns boolean
    if ( not ( IsUnitGroupEmptyBJ(udg_TempGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_SlaughterTick_Func001Func001Func013002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_SlaughterCaster[GetForLoopIndexA()])) == true )
endfunction

function Trig_SlaughterTick_Func001Func001Func015Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('Avul', GetEnumUnit()) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SlaughterTick_Func001Func001Func015A takes nothing returns nothing
    if ( Trig_SlaughterTick_Func001Func001Func015Func001C() ) then
        call UnitDamageTargetBJ(udg_SlaughterCaster[GetForLoopIndexA()], GetEnumUnit(), 40.0 + 0.15 * I2R(GetUnitDamage(udg_SlaughterCaster[GetForLoopIndexA()])), ATTACK_TYPE_MELEE, DAMAGE_TYPE_NORMAL)
        call AddSpecialEffectTargetUnitBJ("chest", GetEnumUnit(), "MDX\\Effects\\BloodImpact.mdx")
        call DestroyEffectBJ(GetLastCreatedEffectBJ())
    else
    endif
endfunction

function Trig_SlaughterTick_Func001Func001Func024Func006C takes nothing returns boolean
    if ( not ( udg_SlaughterWriteIndex == udg_SlaughterReadIndex ) ) then
        return false
    endif
    return true
endfunction

function Trig_SlaughterTick_Func001Func001Func024C takes nothing returns boolean
    if ( not ( udg_SlaughterTPCount[GetForLoopIndexA()] > 20 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SlaughterTick_Func001Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(udg_SlaughterCaster[GetForLoopIndexA()]) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_SlaughterTick_Actions takes nothing returns nothing
    set bj_forLoopAIndex=0
    set bj_forLoopAIndexEnd=( udg_SlaughterWriteIndex - 1 )
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ( Trig_SlaughterTick_Func001Func001C() ) then
            set udg_TempGroup=GetUnitsInRangeOfLocMatching(450.00, udg_SlaughterPoint[GetForLoopIndexA()], Condition(function Trig_SlaughterTick_Func001Func001Func004002003))
            call GroupRemoveUnitSimple(udg_SlaughterTarget[GetForLoopIndexA()], udg_TempGroup)
            if ( Trig_SlaughterTick_Func001Func001Func006C() ) then
                set udg_TempPoint=PolarProjectionBJ(udg_SlaughterPoint[GetForLoopIndexA()], GetRandomReal(0, 500.00), GetRandomReal(0, 360.00))
                set udg_TempReal=GetRandomReal(0, 360.00)
            else
                set udg_TempUnit=GroupPickRandomUnit(udg_TempGroup)
                set udg_SlaughterTarget[GetForLoopIndexA()]=udg_TempUnit
                set udg_TempPoint=GetUnitLoc(udg_TempUnit)
                set udg_TempPoint2=GetUnitLoc(udg_SlaughterCaster[GetForLoopIndexA()])
                set udg_TempReal=AngleBetweenPoints(udg_TempPoint2, udg_TempPoint)
            endif
            call SetUnitPositionLocFacingBJ(udg_SlaughterCaster[GetForLoopIndexA()], udg_TempPoint, udg_TempReal)
            call SetUnitAnimation(udg_SlaughterCaster[GetForLoopIndexA()], "attack")
            call AddSpecialEffectTargetUnitBJ("chest", udg_SlaughterCaster[GetForLoopIndexA()], "MDX\\Effects\\EphemeralSlashRed.mdx")
            call DestroyEffectBJ(GetLastCreatedEffectBJ())
            call DestroyGroup(udg_TempGroup)
            set udg_TempGroup=null
            set udg_TempGroup=GetUnitsInRangeOfLocMatching(175.00, udg_TempPoint, Condition(function Trig_SlaughterTick_Func001Func001Func013002003))
            set udg_DamageAbility=true
            call ForGroupBJ(udg_TempGroup, function Trig_SlaughterTick_Func001Func001Func015A)
            set udg_DamageAbility=false
            call RemoveLocation(udg_TempPoint)
            set udg_TempPoint=null
            call RemoveLocation(udg_TempPoint2)
            set udg_TempPoint2=null
            call DestroyGroup(udg_TempGroup)
            set udg_TempGroup=null
            set udg_SlaughterTPCount[GetForLoopIndexA()]=( udg_SlaughterTPCount[GetForLoopIndexA()] + 1 )
            if ( Trig_SlaughterTick_Func001Func001Func024C() ) then
                call QueueUnitAnimationBJ(udg_SlaughterCaster[GetForLoopIndexA()], "stand")
                call RemoveLocation(udg_SlaughterPoint[GetForLoopIndexA()])
                set udg_SlaughterPoint[GetForLoopIndexA()]=null
                set udg_SlaughterReadIndex=( udg_SlaughterReadIndex + 1 )
                if ( Trig_SlaughterTick_Func001Func001Func024Func006C() ) then
                    call DisableTrigger(GetTriggeringTrigger())
                    set udg_SlaughterWriteIndex=0
                    set udg_SlaughterReadIndex=0
                else
                endif
            else
            endif
        else
            call RemoveLocation(udg_SlaughterPoint[GetForLoopIndexA()])
            set udg_SlaughterPoint[GetForLoopIndexA()]=null
            set udg_SlaughterReadIndex=( udg_SlaughterReadIndex + 1 )
        endif
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
endfunction

//===========================================================================
function InitTrig_SlaughterTick takes nothing returns nothing
    set gg_trg_SlaughterTick=CreateTrigger()
    call DisableTrigger(gg_trg_SlaughterTick)
    call TriggerRegisterTimerEventPeriodic(gg_trg_SlaughterTick, 0.20)
    call TriggerAddAction(gg_trg_SlaughterTick, function Trig_SlaughterTick_Actions)
endfunction

//===========================================================================
// Trigger: IronRavenAlphaInit
//===========================================================================
function Trig_IronRavenAlphaInit_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'E001' ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_IronRavenGroup) == false ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_IronRavenAlphaInit_Actions takes nothing returns nothing
    call GroupAddUnitSimple(GetTriggerUnit(), udg_IronRavenGroup)
    call SetUnitVertexColorBJ(GetTriggerUnit(), 100, 100, 100, 1.00)
endfunction

//===========================================================================
function InitTrig_IronRavenAlphaInit takes nothing returns nothing
    set gg_trg_IronRavenAlphaInit=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_IronRavenAlphaInit, GetEntireMapRect())
    call TriggerAddCondition(gg_trg_IronRavenAlphaInit, Condition(function Trig_IronRavenAlphaInit_Conditions))
    call TriggerAddAction(gg_trg_IronRavenAlphaInit, function Trig_IronRavenAlphaInit_Actions)
endfunction

//===========================================================================
// Trigger: IronRavenAlphaAbility
//===========================================================================
function Trig_IronRavenAlphaAbility_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'E001' ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_IronRavenAlphaAbility_Actions takes nothing returns nothing
    call SetUnitVertexColorBJ(GetTriggerUnit(), 100, 100, 100, 1.00)
endfunction

//===========================================================================
function InitTrig_IronRavenAlphaAbility takes nothing returns nothing
    set gg_trg_IronRavenAlphaAbility=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_IronRavenAlphaAbility, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_IronRavenAlphaAbility, Condition(function Trig_IronRavenAlphaAbility_Conditions))
    call TriggerAddAction(gg_trg_IronRavenAlphaAbility, function Trig_IronRavenAlphaAbility_Actions)
endfunction

//===========================================================================
// Trigger: IronRavenAlphaPeriodic
//===========================================================================
function Trig_IronRavenAlphaPeriodic_Func001Func001C takes nothing returns boolean
    if ( not ( IsUnitType(GetEnumUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_IronRavenAlphaPeriodic_Func001A takes nothing returns nothing
    if ( Trig_IronRavenAlphaPeriodic_Func001Func001C() ) then
        call SetUnitVertexColorBJ(GetEnumUnit(), 100, 100, 100, 1.00)
    else
    endif
endfunction

function Trig_IronRavenAlphaPeriodic_Actions takes nothing returns nothing
    call ForGroupBJ(udg_IronRavenGroup, function Trig_IronRavenAlphaPeriodic_Func001A)
endfunction

//===========================================================================
function InitTrig_IronRavenAlphaPeriodic takes nothing returns nothing
    set gg_trg_IronRavenAlphaPeriodic=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_IronRavenAlphaPeriodic, 15.00)
    call TriggerAddAction(gg_trg_IronRavenAlphaPeriodic, function Trig_IronRavenAlphaPeriodic_Actions)
endfunction

//===========================================================================
// Trigger: IronRavenAlphaSelect
//===========================================================================
function Trig_IronRavenAlphaSelect_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'E001' ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_IronRavenAlphaSelect_Actions takes nothing returns nothing
    call SetUnitVertexColorBJ(GetTriggerUnit(), 100, 100, 100, 1.00)
endfunction

//===========================================================================
function InitTrig_IronRavenAlphaSelect takes nothing returns nothing
    set gg_trg_IronRavenAlphaSelect=CreateTrigger()
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_IronRavenAlphaSelect, Player(0), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_IronRavenAlphaSelect, Player(1), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_IronRavenAlphaSelect, Player(2), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_IronRavenAlphaSelect, Player(3), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_IronRavenAlphaSelect, Player(4), true)
    call TriggerRegisterPlayerSelectionEventBJ(gg_trg_IronRavenAlphaSelect, Player(5), true)
    call TriggerAddCondition(gg_trg_IronRavenAlphaSelect, Condition(function Trig_IronRavenAlphaSelect_Conditions))
    call TriggerAddAction(gg_trg_IronRavenAlphaSelect, function Trig_IronRavenAlphaSelect_Actions)
endfunction

//===========================================================================
// Trigger: CreateAbilFloatingText
//===========================================================================
function CreateAbilFloatingText takes unit caster,string text,real red,real green,real blue returns nothing
    local location castLoc= GetUnitLoc(caster)
    local location textLoc= PolarProjectionBJ(castLoc, ( 10.00 * I2R(StringLength(text)) ), 180.00)
    local texttag ttag= CreateTextTag()
    
    call SetTextTagTextBJ(ttag, text, 11.0)
    call SetTextTagPosBJ(ttag, textLoc, 200.0)
    call SetTextTagColorBJ(ttag, red, green, blue, 0.0)
    call SetTextTagVelocityBJ(ttag, 60.0, 90.0)
    call SetTextTagPermanentBJ(ttag, false)
    call SetTextTagLifespanBJ(ttag, 2.0)
    call SetTextTagFadepointBJ(ttag, 1.0)
    
    call RemoveLocation(castLoc)
    set castLoc=null
    call RemoveLocation(textLoc)
    set textLoc=null
    set ttag=null
endfunction

//===========================================================================
// Trigger: CreepResourceAward
//===========================================================================
function Trig_CreepResourceAward_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetTriggerUnit()) == Player(PLAYER_NEUTRAL_AGGRESSIVE) ) ) then
        return false
    endif
    if ( not ( BlzGetUnitIntegerField(GetTriggerUnit(), UNIT_IF_GOLD_BOUNTY_AWARDED_SIDES_PER_DIE) > 0 ) ) then
        return false
    endif
    if ( not ( IsUnitIllusionBJ(GetTriggerUnit()) == false ) ) then
        return false
    endif
    if ( not ( IsUnitIdType(GetUnitTypeId(GetTriggerUnit()), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_CreepResourceAward_Actions takes nothing returns nothing
    set udg_TempInt=BlzGetUnitIntegerField(GetTriggerUnit(), UNIT_IF_GOLD_BOUNTY_AWARDED_SIDES_PER_DIE)
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_MaxPlayers
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call AdjustPlayerStateBJ(udg_TempInt, ConvertedPlayer(GetForLoopIndexA()), PLAYER_STATE_RESOURCE_GOLD)
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempString=( "+" + I2S(udg_TempInt) )
    call CreateTextTagLocBJ(udg_TempString, PolarProjectionBJ(udg_TempPoint, ( 10.00 * I2R(StringLength(udg_TempString)) ), 180.00), 0.00, 12.00, 40.00, 60.00, 100.00, 0)
    call SetTextTagVelocityBJ(GetLastCreatedTextTag(), 64.00, 90.00)
    call SetTextTagPermanentBJ(GetLastCreatedTextTag(), false)
    call SetTextTagLifespanBJ(GetLastCreatedTextTag(), 4.00)
    call SetTextTagFadepointBJ(GetLastCreatedTextTag(), 3.00)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_CreepResourceAward takes nothing returns nothing
    set gg_trg_CreepResourceAward=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepResourceAward, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_CreepResourceAward, Condition(function Trig_CreepResourceAward_Conditions))
    call TriggerAddAction(gg_trg_CreepResourceAward, function Trig_CreepResourceAward_Actions)
endfunction

//===========================================================================
// Trigger: CreepExpReward
//===========================================================================
function CreepExpRewardPlayerHeroFilter takes unit hero,unit dying returns boolean
    if IsUnitType(hero, UNIT_TYPE_HERO) then
    if IsUnitEnemy(hero, GetOwningPlayer(dying)) then
        return true
    endif
    endif
    return false
endfunction

function Trig_CreepExpReward_Conditions takes nothing returns boolean
    if GetOwningPlayer(GetTriggerUnit()) == Player(PLAYER_NEUTRAL_AGGRESSIVE) then
    if not IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) then
    if not IsUnitIllusion(GetTriggerUnit()) then
    if GetUnitAbilityLevel(GetTriggerUnit(), 'Aloc') == 0 then
    if GetUnitPointValue(GetTriggerUnit()) > 0 then
        return true
    endif
    endif
    endif
    endif
    endif
    return false
endfunction

function Trig_CreepExpReward_Actions takes nothing returns nothing
    local unit dying= GetTriggerUnit()
    local group g= CreateGroup()
    local unit playerHero= null
    local integer expAmount= GetUnitPointValue(dying) + 2
    
    call GroupEnumUnitsInRange(g, GetUnitX(dying), GetUnitY(dying), 2000.0, null)
    
    loop
        set playerHero=FirstOfGroup(g)
        exitwhen playerHero == null
        if CreepExpRewardPlayerHeroFilter(playerHero , dying) then
            call AddHeroXP(playerHero, expAmount, true)
        endif
        call GroupRemoveUnit(g, playerHero)
    endloop
    
    set dying=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_CreepExpReward takes nothing returns nothing
    set gg_trg_CreepExpReward=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepExpReward, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_CreepExpReward, Condition(function Trig_CreepExpReward_Conditions))
    call TriggerAddAction(gg_trg_CreepExpReward, function Trig_CreepExpReward_Actions)
endfunction

//===========================================================================
// Trigger: CreepRegen
//===========================================================================
function Trig_CreepRegen_Func002Func001Func001Func004001 takes nothing returns boolean
    return ( GetUnitStateSwap(UNIT_STATE_LIFE, GetEnumUnit()) < GetUnitStateSwap(UNIT_STATE_MAX_LIFE, GetEnumUnit()) )
endfunction

function Trig_CreepRegen_Func002Func001Func001Func004002 takes nothing returns boolean
    return ( GetUnitStateSwap(UNIT_STATE_MANA, GetEnumUnit()) < GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetEnumUnit()) )
endfunction

function Trig_CreepRegen_Func002Func001Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetEnumUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    if ( not ( IsUnitIllusionBJ(GetEnumUnit()) == false ) ) then
        return false
    endif
    if ( not GetBooleanOr((GetUnitStateSwap(UNIT_STATE_LIFE, GetEnumUnit()) < GetUnitStateSwap(UNIT_STATE_MAX_LIFE, GetEnumUnit())), (GetUnitStateSwap(UNIT_STATE_MANA, GetEnumUnit()) < GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetEnumUnit()))) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_CreepRegen_Func002Func001C takes nothing returns boolean
    if ( not ( BlzGetUnitIntegerField(GetEnumUnit(), UNIT_IF_LUMBER_BOUNTY_AWARDED_SIDES_PER_DIE) <= 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_CreepRegen_Func002A takes nothing returns nothing
    if ( Trig_CreepRegen_Func002Func001C() ) then
        if ( Trig_CreepRegen_Func002Func001Func001C() ) then
            call SetUnitLifeBJ(GetEnumUnit(), ( GetUnitStateSwap(UNIT_STATE_LIFE, GetEnumUnit()) + ( GetUnitStateSwap(UNIT_STATE_MAX_LIFE, GetEnumUnit()) * 0.10 ) ))
            call SetUnitManaBJ(GetEnumUnit(), ( GetUnitStateSwap(UNIT_STATE_MANA, GetEnumUnit()) + ( GetUnitStateSwap(UNIT_STATE_MAX_MANA, GetEnumUnit()) * 0.10 ) ))
        else
        endif
    else
        call BlzSetUnitIntegerFieldBJ(GetEnumUnit(), UNIT_IF_LUMBER_BOUNTY_AWARDED_SIDES_PER_DIE, ( BlzGetUnitIntegerField(GetEnumUnit(), UNIT_IF_LUMBER_BOUNTY_AWARDED_SIDES_PER_DIE) - 1 ))
    endif
endfunction

function Trig_CreepRegen_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsInRectOfPlayer(GetEntireMapRect(), Player(PLAYER_NEUTRAL_AGGRESSIVE))
    call ForGroupBJ(udg_TempGroup, function Trig_CreepRegen_Func002A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_CreepRegen takes nothing returns nothing
    set gg_trg_CreepRegen=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_CreepRegen, 2)
    call TriggerAddAction(gg_trg_CreepRegen, function Trig_CreepRegen_Actions)
endfunction

//===========================================================================
// Trigger: CreepRegenStopByAttack
//===========================================================================
function Trig_CreepRegenStopByAttack_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetAttacker()) == Player(PLAYER_NEUTRAL_AGGRESSIVE) ) ) then
        return false
    endif
    return true
endfunction

function Trig_CreepRegenStopByAttack_Actions takes nothing returns nothing
    call BlzSetUnitIntegerFieldBJ(GetAttacker(), UNIT_IF_LUMBER_BOUNTY_AWARDED_SIDES_PER_DIE, udg_CreepRegenIdleTime)
endfunction

//===========================================================================
function InitTrig_CreepRegenStopByAttack takes nothing returns nothing
    set gg_trg_CreepRegenStopByAttack=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepRegenStopByAttack, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_CreepRegenStopByAttack, Condition(function Trig_CreepRegenStopByAttack_Conditions))
    call TriggerAddAction(gg_trg_CreepRegenStopByAttack, function Trig_CreepRegenStopByAttack_Actions)
endfunction

//===========================================================================
// Trigger: CreepRegenStopByAttacked
//===========================================================================
function Trig_CreepRegenStopByAttacked_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetTriggerUnit()) == Player(PLAYER_NEUTRAL_AGGRESSIVE) ) ) then
        return false
    endif
    return true
endfunction

function Trig_CreepRegenStopByAttacked_Actions takes nothing returns nothing
    call BlzSetUnitIntegerFieldBJ(GetTriggerUnit(), UNIT_IF_LUMBER_BOUNTY_AWARDED_SIDES_PER_DIE, udg_CreepRegenIdleTime)
endfunction

//===========================================================================
function InitTrig_CreepRegenStopByAttacked takes nothing returns nothing
    set gg_trg_CreepRegenStopByAttacked=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepRegenStopByAttacked, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_CreepRegenStopByAttacked, Condition(function Trig_CreepRegenStopByAttacked_Conditions))
    call TriggerAddAction(gg_trg_CreepRegenStopByAttacked, function Trig_CreepRegenStopByAttacked_Actions)
endfunction

//===========================================================================
// Trigger: CreepRegenStopBySpellTargetEnemy
//===========================================================================
function Trig_CreepRegenStopBySpellTargetEnemy_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetTriggerUnit()) == Player(PLAYER_NEUTRAL_AGGRESSIVE) ) ) then
        return false
    endif
    return true
endfunction

function Trig_CreepRegenStopBySpellTargetEnemy_Actions takes nothing returns nothing
    call BlzSetUnitIntegerFieldBJ(GetTriggerUnit(), UNIT_IF_LUMBER_BOUNTY_AWARDED_SIDES_PER_DIE, udg_CreepRegenIdleTime)
endfunction

//===========================================================================
function InitTrig_CreepRegenStopBySpellTargetEnemy takes nothing returns nothing
    set gg_trg_CreepRegenStopBySpellTargetEnemy=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepRegenStopBySpellTargetEnemy, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepRegenStopBySpellTargetEnemy, EVENT_PLAYER_UNIT_SPELL_CAST)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepRegenStopBySpellTargetEnemy, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepRegenStopBySpellTargetEnemy, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_CreepRegenStopBySpellTargetEnemy, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_CreepRegenStopBySpellTargetEnemy, Condition(function Trig_CreepRegenStopBySpellTargetEnemy_Conditions))
    call TriggerAddAction(gg_trg_CreepRegenStopBySpellTargetEnemy, function Trig_CreepRegenStopBySpellTargetEnemy_Actions)
endfunction

//===========================================================================
// Trigger: CreepRegenStopByDamaged
//===========================================================================
function Trig_CreepRegenStopByDamaged_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(BlzGetEventDamageTarget()) == Player(PLAYER_NEUTRAL_AGGRESSIVE) ) ) then
        return false
    endif
    if ( not ( IsUnitEnemy(GetEventDamageSource(), GetOwningPlayer(BlzGetEventDamageTarget())) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_CreepRegenStopByDamaged_Actions takes nothing returns nothing
    call BlzSetUnitIntegerFieldBJ(BlzGetEventDamageTarget(), UNIT_IF_LUMBER_BOUNTY_AWARDED_SIDES_PER_DIE, udg_CreepRegenIdleTime)
endfunction

//===========================================================================
function InitTrig_CreepRegenStopByDamaged takes nothing returns nothing
    set gg_trg_CreepRegenStopByDamaged=CreateTrigger()
    call TriggerAddCondition(gg_trg_CreepRegenStopByDamaged, Condition(function Trig_CreepRegenStopByDamaged_Conditions))
    call TriggerAddAction(gg_trg_CreepRegenStopByDamaged, function Trig_CreepRegenStopByDamaged_Actions)
endfunction

//===========================================================================
// Trigger: CreepRegenStopByDamagedEvent
//===========================================================================
//===========================================================================
function InitTrig_CreepRegenStopByDamagedEvent takes nothing returns nothing
    local integer i= 0
    set gg_trg_CreepRegenStopByDamagedEvent=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_CreepRegenStopByDamaged, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
endfunction
//===========================================================================
// Trigger: InitGolems
//===========================================================================
function Trig_InitGolems_Actions takes nothing returns nothing
    local group g= CreateGroup()
    local unit u= null
    
    call GroupEnumUnitsInRect(g, GetWorldBounds(), null)
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if GetUnitTypeId(u) == udg_GolemUnitId and GetOwningPlayer(u) == Player(PLAYER_NEUTRAL_AGGRESSIVE) then
            call SetUnitAnimation(GetEnumUnit(), "Sleep")
            call QueueUnitAnimation(u, "Sleep")
            call IssueImmediateOrder(u, "holdposition")
            call SetUnitMoveSpeed(u, 0.00)
            call GroupAddUnit(udg_GolemGroup, u)
            call TriggerRegisterUnitInRange(gg_trg_GolemAggro, u, 600.0, null)
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_InitGolems takes nothing returns nothing
    set gg_trg_InitGolems=CreateTrigger()
    call TriggerAddAction(gg_trg_InitGolems, function Trig_InitGolems_Actions)
endfunction

//===========================================================================
// Trigger: GolemAggro
//===========================================================================
function Trig_GolemAggro_Conditions takes nothing returns boolean
    return IsUnitEnemy(GetTriggerUnit(), Player(PLAYER_NEUTRAL_AGGRESSIVE))
endfunction

function Trig_GolemAggro_Actions takes nothing returns nothing
    local location l= GetUnitLoc(GetTriggerUnit())
    local group g= CreateGroup()
    local unit u= null
    local location golemLoc= null
    
    call GroupEnumUnitsInRange(g, GetLocationX(l), GetLocationY(l), 610.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if IsUnitInGroup(u, udg_GolemGroup) then
            set golemLoc=GetUnitLoc(u)
            call GroupRemoveUnit(udg_GolemGroup, u)
            call SetUnitAnimation(u, "Birth")
            call QueueUnitAnimation(u, "Stand")
            call PlaySoundAtPointBJ(gg_snd_RockGolemWhat2, 100, golemLoc, 0)
            call SetUnitMoveSpeed(u, 270.00)
            call IssueImmediateOrder(u, "stop")
            call RemoveLocation(golemLoc)
            set golemLoc=null
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    call RemoveLocation(l)
    set l=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_GolemAggro takes nothing returns nothing
    set gg_trg_GolemAggro=CreateTrigger()
    call TriggerAddCondition(gg_trg_GolemAggro, Condition(function Trig_GolemAggro_Conditions))
    call TriggerAddAction(gg_trg_GolemAggro, function Trig_GolemAggro_Actions)
endfunction

//===========================================================================
// Trigger: EarthSpearUse
//===========================================================================
function Trig_EarthSpearUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_GolemUnitId then
    if ShouldUnitUseAbility(GetTriggerUnit() , udg_EarthSpearAbilId , 0.95) then
        return true
    endif
    endif
    return false
endfunction

function Trig_EarthSpearUse_Actions takes nothing returns nothing
    call IssueTargetOrder(GetTriggerUnit(), "chainlightning", GetAttacker())
endfunction

//===========================================================================
function InitTrig_EarthSpearUse takes nothing returns nothing
    set gg_trg_EarthSpearUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_EarthSpearUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_EarthSpearUse, Condition(function Trig_EarthSpearUse_Conditions))
    call TriggerAddAction(gg_trg_EarthSpearUse, function Trig_EarthSpearUse_Actions)
endfunction

//===========================================================================
// Trigger: EarthSpearCast
//===========================================================================
function Trig_EarthSpearCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_EarthSpearAbilId
endfunction

function Trig_EarthSpearCast_Actions takes nothing returns nothing
    local unit dummy= null
    set udg_EarthSpearCaster=GetTriggerUnit()
    
    set dummy=CreateUnit(GetOwningPlayer(udg_EarthSpearCaster), udg_EarthSpearDummyId, GetUnitX(udg_EarthSpearCaster), GetUnitY(udg_EarthSpearCaster), GetUnitFacing(udg_EarthSpearCaster))
    call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
    call UnitAddAbility(dummy, udg_EarthSpearDummyAbilId)
    call IssuePointOrder(dummy, "impale", GetSpellTargetX(), GetSpellTargetY())
    
    set dummy=null
endfunction

//===========================================================================
function InitTrig_EarthSpearCast takes nothing returns nothing
    set gg_trg_EarthSpearCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_EarthSpearCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_EarthSpearCast, Condition(function Trig_EarthSpearCast_Conditions))
    call TriggerAddAction(gg_trg_EarthSpearCast, function Trig_EarthSpearCast_Actions)
endfunction

//===========================================================================
// Trigger: EarthSpearDmg
//===========================================================================
function Trig_EarthSpearDmg_Conditions takes nothing returns boolean
    return GetUnitAbilityLevel(GetEventDamageSource(), udg_EarthSpearDummyAbilId) > 0
endfunction

function Trig_EarthSpearDmg_Actions takes nothing returns nothing
    // NOTE: The Dummy Impale ability fires this trigger twice. Damage should be half of inteded amount.
    call UnitDamageTargetMagic(udg_EarthSpearCaster , GetTriggerUnit() , 50.0)
endfunction

//===========================================================================
function InitTrig_EarthSpearDmg takes nothing returns nothing
    local integer i= 0
    set gg_trg_EarthSpearDmg=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_EarthSpearDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_EarthSpearDmg, Condition(function Trig_EarthSpearDmg_Conditions))
    call TriggerAddAction(gg_trg_EarthSpearDmg, function Trig_EarthSpearDmg_Actions)
endfunction
//===========================================================================
// Trigger: AcolyteHeal
//===========================================================================
function Trig_AcolyteHeal_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01K'
endfunction

function Trig_AcolyteHeal_Actions takes nothing returns nothing
    call HealUnit(GetTriggerUnit() , GetSpellTargetUnit() , 50.0)
endfunction

//===========================================================================
function InitTrig_AcolyteHeal takes nothing returns nothing
    set gg_trg_AcolyteHeal=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AcolyteHeal, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_AcolyteHeal, Condition(function Trig_AcolyteHeal_Conditions))
    call TriggerAddAction(gg_trg_AcolyteHeal, function Trig_AcolyteHeal_Actions)
endfunction

//===========================================================================
// Trigger: ImpaleAttack
//===========================================================================
function Trig_ImpaleAttack_Conditions takes nothing returns boolean
    if not udg_DamageAbility then
    if not udg_DamageMagic then
    if GetUnitTypeId(GetEventDamageSource()) == udg_CryptLordBossId then
        return true
    endif
    endif
    endif
    return false
endfunction

function Trig_ImpaleAttack_Actions takes nothing returns nothing
    local unit target= BlzGetEventDamageTarget()
    local integer i= 0
    local location casterLoc= null
    local location l= null
    local unit dummy= null
    
    set udg_CryptLordBoss=GetEventDamageSource()
    set casterLoc=GetUnitLoc(udg_CryptLordBoss)
    call GroupClear(udg_ImpaleDummyGroup)
    
    loop
        exitwhen i >= 7
        set l=PolarProjectionBJ(casterLoc, 50.0 + 100.0 * I2R(i), GetUnitFacing(udg_CryptLordBoss))
        set dummy=CreateUnit(GetOwningPlayer(udg_CryptLordBoss), udg_DummyUnitId, GetLocationX(l), GetLocationY(l), GetRandomReal(0.0, 360.0))
        call GroupAddUnit(udg_ImpaleDummyGroup, dummy)
        call UnitApplyTimedLife(dummy, 'BTLF', 0.0 + 0.15 * I2R(i))
        call RemoveLocation(l)
        set l=null
        set i=i + 1
    endloop
    
    set target=null
    call RemoveLocation(casterLoc)
    set casterLoc=null
endfunction

//===========================================================================
function InitTrig_ImpaleAttack takes nothing returns nothing
    local integer i= 0
    set gg_trg_ImpaleAttack=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_ImpaleAttack, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_ImpaleAttack, Condition(function Trig_ImpaleAttack_Conditions))
    call TriggerAddAction(gg_trg_ImpaleAttack, function Trig_ImpaleAttack_Actions)
endfunction

//===========================================================================
// Trigger: ImpaleDummyDeath
//===========================================================================
function Trig_ImpaleDummyDeath_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_DummyUnitId then
    if IsUnitInGroup(GetTriggerUnit(), udg_ImpaleDummyGroup) then
        return true
    endif
    endif
    return false
endfunction

function Trig_ImpaleDummyDeath_Actions takes nothing returns nothing
    local unit dying= GetTriggerUnit()
    local group g= CreateGroup()
    local unit u= null
    local real x= GetUnitX(dying)
    local real y= GetUnitY(dying)
    local effect sfx= null

    call GroupRemoveUnit(udg_ImpaleDummyGroup, dying)
    set sfx=AddSpecialEffect("MDX\\Effects\\BoneImpale.mdx", x, y)
    call BlzSetSpecialEffectScale(sfx, 1.33)
    call DestroyEffect(sfx)
    
    set g=CreateGroup()
    call GroupEnumUnitsInRange(g, x, y, 133.0, null)
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if SpellTargetEnemyFilter(u , udg_CryptLordBoss) then
            set udg_DamageAbility=true
            call UnitDamageTarget(udg_CryptLordBoss, u, 120.0, true, false, ATTACK_TYPE_MELEE, DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS)
            set udg_DamageAbility=false
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    set dying=null
    call DestroyGroup(g)
    set g=null
    set sfx=null
endfunction

//===========================================================================
function InitTrig_ImpaleDummyDeath takes nothing returns nothing
    set gg_trg_ImpaleDummyDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ImpaleDummyDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_ImpaleDummyDeath, Condition(function Trig_ImpaleDummyDeath_Conditions))
    call TriggerAddAction(gg_trg_ImpaleDummyDeath, function Trig_ImpaleDummyDeath_Actions)
endfunction

//===========================================================================
// Trigger: BonesOfDeathUse
//===========================================================================
function Trig_BonesOfDeathUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_CryptLordBossId then
    if not IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) then
        return true
    endif
    endif
    return false
endfunction

function Trig_BonesOfDeathUse_Actions takes nothing returns nothing
    call EnemyUseInstantAbility(GetTriggerUnit() , 'A029' , "tranquility" , 0.65)
endfunction

//===========================================================================
function InitTrig_BonesOfDeathUse takes nothing returns nothing
    set gg_trg_BonesOfDeathUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_BonesOfDeathUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_BonesOfDeathUse, Condition(function Trig_BonesOfDeathUse_Conditions))
    call TriggerAddAction(gg_trg_BonesOfDeathUse, function Trig_BonesOfDeathUse_Actions)
endfunction

//===========================================================================
// Trigger: BonesOfDeathCast
//===========================================================================
function BonesOfDeathTick takes nothing returns nothing
    local location casterLoc= GetUnitLoc(udg_BonesOfDeathCaster)
    local location randomLoc= null
    local unit dummy= null
    local player owningPlayer= GetOwningPlayer(udg_BonesOfDeathCaster)
    
    local real distance= 40.0
    local integer numDummies= 3
    local integer waves= 9
    local integer i= 0
    local integer j= 0
    
    call DestroyTimer(GetExpiredTimer())
    
    if udg_BonesOfDeathCaster != null and IsUnitInGroup(udg_BonesOfDeathCaster, udg_IsCastingGroup) then
        loop
            exitwhen i >= waves
            set j=0
            loop
                exitwhen j >= numDummies
                set randomLoc=PolarProjectionBJ(casterLoc, distance, GetRandomReal(GetUnitFacing(udg_BonesOfDeathCaster) - 80, GetUnitFacing(udg_BonesOfDeathCaster) + 80))
                set dummy=CreateUnit(owningPlayer, udg_DummyUnitId, GetLocationX(randomLoc), GetLocationY(randomLoc), 0.0)
                call GroupAddUnit(udg_ImpaleDummyGroup, dummy)
                call UnitApplyTimedLife(dummy, 'BTLF', 0.0 + 0.2 * i)
                call RemoveLocation(randomLoc)
                set randomLoc=null
                set j=j + 1
            endloop
            set distance=distance + 100.0
            set numDummies=numDummies + R2I(I2R(i) * 0.5)
            set i=i + 1
        endloop
        
        call TimerStart(CreateTimer(), 0.2 * waves, false, function BonesOfDeathTick)
    endif
    
    call RemoveLocation(casterLoc)
    set casterLoc=null
    set dummy=null
    set owningPlayer=null
endfunction

function Trig_BonesOfDeathCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A029'
endfunction

function Trig_BonesOfDeathCast_Actions takes nothing returns nothing
    set udg_BonesOfDeathCaster=GetTriggerUnit()
    call SetUnitAnimation(udg_BonesOfDeathCaster, "morph")
    call CreateAbilFloatingText(udg_BonesOfDeathCaster , "* Bones of Death *" , 75.0 , 75.0 , 50.0)
    call TimerStart(CreateTimer(), 0.5, false, function BonesOfDeathTick)
endfunction

//===========================================================================
function InitTrig_BonesOfDeathCast takes nothing returns nothing
    set gg_trg_BonesOfDeathCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_BonesOfDeathCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_BonesOfDeathCast, Condition(function Trig_BonesOfDeathCast_Conditions))
    call TriggerAddAction(gg_trg_BonesOfDeathCast, function Trig_BonesOfDeathCast_Actions)
endfunction

//===========================================================================
// Trigger: BonesOfDeathEnd
//===========================================================================
function Trig_BonesOfDeathEnd_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A029'
endfunction

function Trig_BonesOfDeathEnd_Actions takes nothing returns nothing
    call SetUnitAnimation(udg_BonesOfDeathCaster, "morph defend")
    call QueueUnitAnimation(udg_BonesOfDeathCaster, "stand")
    set udg_BonesOfDeathCaster=null
endfunction

//===========================================================================
function InitTrig_BonesOfDeathEnd takes nothing returns nothing
    set gg_trg_BonesOfDeathEnd=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_BonesOfDeathEnd, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_BonesOfDeathEnd, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_BonesOfDeathEnd, Condition(function Trig_BonesOfDeathEnd_Conditions))
    call TriggerAddAction(gg_trg_BonesOfDeathEnd, function Trig_BonesOfDeathEnd_Actions)
endfunction

//===========================================================================
// Trigger: BonesOfDeathStop
//
// This triggers prevents the caster from "running away" when he gets interrupted/stops casting the ability.
//===========================================================================
function Trig_BonesOfDeathStop_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A029'
endfunction

function Trig_BonesOfDeathStop_Actions takes nothing returns nothing
    call IssueImmediateOrder(GetTriggerUnit(), "stop")
    set udg_BonesOfDeathCaster=null
endfunction

//===========================================================================
function InitTrig_BonesOfDeathStop takes nothing returns nothing
    set gg_trg_BonesOfDeathStop=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_BonesOfDeathStop, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
    call TriggerAddCondition(gg_trg_BonesOfDeathStop, Condition(function Trig_BonesOfDeathStop_Conditions))
    call TriggerAddAction(gg_trg_BonesOfDeathStop, function Trig_BonesOfDeathStop_Actions)
endfunction

//===========================================================================
// Trigger: SummonScarabsUse
//===========================================================================
function Trig_SummonScarabsUse_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n004' ) ) then
        return false
    endif
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_SummonScarabsUse_Func001Func001C takes nothing returns boolean
    if ( not ( GetUnitLifePercent(GetTriggerUnit()) <= 95.00 ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A012', GetTriggerUnit()) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SummonScarabsUse_Func001C takes nothing returns boolean
    if ( not ( GetUnitLifePercent(GetTriggerUnit()) > 95.00 ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A012', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SummonScarabsUse_Func002C takes nothing returns boolean
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetTriggerUnit(), 'A012') == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SummonScarabsUse_Actions takes nothing returns nothing
    if ( Trig_SummonScarabsUse_Func001C() ) then
        call UnitRemoveAbilityBJ('A012', GetTriggerUnit())
    else
        if ( Trig_SummonScarabsUse_Func001Func001C() ) then
            call UnitAddAbilityBJ('A012', GetTriggerUnit())
        else
        endif
    endif
    if ( Trig_SummonScarabsUse_Func002C() ) then
        call DisableTrigger(GetTriggeringTrigger())
        call IssueImmediateOrderBJ(GetTriggerUnit(), "fanofknives")
        call EnableTrigger(GetTriggeringTrigger())
    else
    endif
endfunction

//===========================================================================
function InitTrig_SummonScarabsUse takes nothing returns nothing
    set gg_trg_SummonScarabsUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SummonScarabsUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_SummonScarabsUse, Condition(function Trig_SummonScarabsUse_Conditions))
    call TriggerAddAction(gg_trg_SummonScarabsUse, function Trig_SummonScarabsUse_Actions)
endfunction

//===========================================================================
// Trigger: SummonScarabsCast
//===========================================================================
function Trig_SummonScarabsCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A012' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SummonScarabsCast_Actions takes nothing returns nothing
    call CreateAbilFloatingText(GetTriggerUnit() , "Summon Scarabs" , 75.0 , 75.0 , 50.0)
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=2
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
        set udg_TempPoint2=PolarProjectionBJ(udg_TempPoint, 300.00, GetRandomReal(0, 360.00))
        call CreateNUnitsAtLoc(1, 'u002', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint2, GetRandomReal(0, 360.00))
        call UnitApplyTimedLifeBJ(120.00, 'BTLF', GetLastCreatedUnit())
        call SetUnitAnimation(GetLastCreatedUnit(), "birth")
        call QueueUnitAnimationBJ(GetTriggerUnit(), "stand")
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
        call RemoveLocation(udg_TempPoint2)
        set udg_TempPoint2=null
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
endfunction

//===========================================================================
function InitTrig_SummonScarabsCast takes nothing returns nothing
    set gg_trg_SummonScarabsCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SummonScarabsCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SummonScarabsCast, Condition(function Trig_SummonScarabsCast_Conditions))
    call TriggerAddAction(gg_trg_SummonScarabsCast, function Trig_SummonScarabsCast_Actions)
endfunction

//===========================================================================
// Trigger: ShockwaveUse
//===========================================================================
function Trig_ShockwaveUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_CryptLordBossId then
    if not IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) then
        return true
    endif
    endif
    return false
endfunction

function Trig_ShockwaveUse_Actions takes nothing returns nothing
    call EnemyUseInstantAbility(GetTriggerUnit() , udg_AbilShockwaveId , "stomp" , 0.80)
endfunction

//===========================================================================
function InitTrig_ShockwaveUse takes nothing returns nothing
    set gg_trg_ShockwaveUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShockwaveUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_ShockwaveUse, Condition(function Trig_ShockwaveUse_Conditions))
    call TriggerAddAction(gg_trg_ShockwaveUse, function Trig_ShockwaveUse_Actions)
endfunction
//===========================================================================
// Trigger: ShockwaveBegin
//===========================================================================
function Trig_ShockwaveBegin_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_AbilShockwaveId
endfunction

function Trig_ShockwaveBegin_Actions takes nothing returns nothing
    set udg_CryptLordBoss=GetTriggerUnit()
    call CreateAbilFloatingText(udg_CryptLordBoss , "* Shockwave *" , 75.0 , 75.0 , 50.0)
endfunction

//===========================================================================
function InitTrig_ShockwaveBegin takes nothing returns nothing
    set gg_trg_ShockwaveBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShockwaveBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_ShockwaveBegin, Condition(function Trig_ShockwaveBegin_Conditions))
    call TriggerAddAction(gg_trg_ShockwaveBegin, function Trig_ShockwaveBegin_Actions)
endfunction

//===========================================================================
// Trigger: ShockwaveFinish
//===========================================================================
function Trig_ShockwaveFinish_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_AbilShockwaveId
endfunction

function Trig_ShockwaveFinish_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local group g= CreateGroup()
    local unit u= null
    local real x= GetUnitX(caster)
    local real y= GetUnitY(caster)
    local unit dummy= null
    
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\Shockwave.mdx", x, y))
    call GroupEnumUnitsInRange(g, x, y, 650.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if SpellTargetEnemyFilter(u , caster) then
            set udg_DamageAbility=true
            call UnitDamageTargetMagic(caster , u , 200.0)
            set udg_DamageAbility=false
            if not IsUnitStatusImmune(u) then
                set dummy=CreateUnit(GetOwningPlayer(caster), udg_DummyUnitId, GetUnitX(u), GetUnitY(u), 0.0)
                call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
                call UnitAddAbility(dummy, 'A022')
                call IssueTargetOrder(dummy, "curse", u)
            endif
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    set caster=null
    call DestroyGroup(g)
    set g=null
    set dummy=null
endfunction

//===========================================================================
function InitTrig_ShockwaveFinish takes nothing returns nothing
    set gg_trg_ShockwaveFinish=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShockwaveFinish, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_ShockwaveFinish, Condition(function Trig_ShockwaveFinish_Conditions))
    call TriggerAddAction(gg_trg_ShockwaveFinish, function Trig_ShockwaveFinish_Actions)
endfunction

//===========================================================================
// Trigger: FireDruidBossDeath
//===========================================================================
function Trig_FireDruidBossDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == udg_FireDruidBossId ) ) then
        return false
    endif
    return true
endfunction

function Trig_FireDruidBossDeath_Actions takes nothing returns nothing
    call PlaySoundBJ(gg_snd_Voice_Azir_DeathHow)
endfunction

//===========================================================================
function InitTrig_FireDruidBossDeath takes nothing returns nothing
    set gg_trg_FireDruidBossDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FireDruidBossDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_FireDruidBossDeath, Condition(function Trig_FireDruidBossDeath_Conditions))
    call TriggerAddAction(gg_trg_FireDruidBossDeath, function Trig_FireDruidBossDeath_Actions)
endfunction

//===========================================================================
// Trigger: FireDruidBossKill
//===========================================================================
function Trig_FireDruidBossKill_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetKillingUnitBJ()) == udg_FireDruidBossId ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_FireDruidBossKill_Actions takes nothing returns nothing
    call PlaySoundBJ(gg_snd_Voice_Azir_YourSacrifice)
endfunction

//===========================================================================
function InitTrig_FireDruidBossKill takes nothing returns nothing
    set gg_trg_FireDruidBossKill=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FireDruidBossKill, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_FireDruidBossKill, Condition(function Trig_FireDruidBossKill_Conditions))
    call TriggerAddAction(gg_trg_FireDruidBossKill, function Trig_FireDruidBossKill_Actions)
endfunction

//===========================================================================
// Trigger: FireDruidBossEngage
//===========================================================================
function Trig_FireDruidBossEngage_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_FireDruidBossId then
    if GetUnitState(GetTriggerUnit(), UNIT_STATE_LIFE) >= GetUnitState(GetTriggerUnit(), UNIT_STATE_MAX_LIFE) then
        return true
    endif
    endif
    return false
endfunction

function Trig_FireDruidBossEngage_Actions takes nothing returns nothing
    call PlaySoundBJ(gg_snd_Voice_Azir_YouDareOppose)
endfunction

//===========================================================================
function InitTrig_FireDruidBossEngage takes nothing returns nothing
    local integer i= 0
    set gg_trg_FireDruidBossEngage=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_FireDruidBossEngage, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_FireDruidBossEngage, Condition(function Trig_FireDruidBossEngage_Conditions))
    call TriggerAddAction(gg_trg_FireDruidBossEngage, function Trig_FireDruidBossEngage_Actions)
endfunction

//===========================================================================
// Trigger: AscensionUse
//===========================================================================
function Trig_AscensionUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_FireDruidBossId then
    if ShouldUnitUseAbility(GetTriggerUnit() , udg_AscensionAbilId , 0.50) then
        return true
    endif
    endif
    return false
endfunction

function Trig_AscensionUse_Actions takes nothing returns nothing
    call IssueImmediateOrder(GetTriggerUnit(), "berserk")
endfunction

//===========================================================================
function InitTrig_AscensionUse takes nothing returns nothing
    set gg_trg_AscensionUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AscensionUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_AscensionUse, Condition(function Trig_AscensionUse_Conditions))
    call TriggerAddAction(gg_trg_AscensionUse, function Trig_AscensionUse_Actions)
endfunction

//===========================================================================
// Trigger: AscensionCast
//===========================================================================
function Trig_AscensionCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_AscensionAbilId
endfunction

function Trig_AscensionCast_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    call CreateAbilFloatingText(caster , "  Ascension  " , 80.0 , 45.0 , 40.0)
    if GetUnitLifePercentage(caster) < 0.95 then
        call PlaySoundBJ(gg_snd_Voice_Azir_AncientPowerCourses)
    endif
    set caster=null
endfunction

//===========================================================================
function InitTrig_AscensionCast takes nothing returns nothing
    set gg_trg_AscensionCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AscensionCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_AscensionCast, Condition(function Trig_AscensionCast_Conditions))
    call TriggerAddAction(gg_trg_AscensionCast, function Trig_AscensionCast_Actions)
endfunction

//===========================================================================
// Trigger: AscensionDmg
//===========================================================================
function Trig_AscensionDmg_Conditions takes nothing returns boolean
    if not udg_DamageAbility then
    if not udg_DamageMagic then
    if GetUnitAbilityLevel(GetEventDamageSource(), udg_AscensionBuffId) > 0 then
    if IsUnitEnemy(GetTriggerUnit(), GetOwningPlayer(GetEventDamageSource())) then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

function Trig_AscensionDmg_Actions takes nothing returns nothing
    local unit source= GetEventDamageSource()
    local unit target= GetTriggerUnit()
    local group g= CreateGroup()
    local unit u= null
    call GroupEnumUnitsInRange(g, GetUnitX(target), GetUnitY(target), 225.0, null)
    
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if SpellTargetEnemyFilter(target , source) then
            set udg_DamageAbility=true
            call UnitDamageTargetMagic(source , u , 40.0)
            set udg_DamageAbility=false
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Incinerate\\FireLordDeathExplode.mdl", GetUnitX(target), GetUnitY(target)))
    
    set source=null
    set target=null
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_AscensionDmg takes nothing returns nothing
    local integer i= 0
    set gg_trg_AscensionDmg=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_AscensionDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_AscensionDmg, Condition(function Trig_AscensionDmg_Conditions))
    call TriggerAddAction(gg_trg_AscensionDmg, function Trig_AscensionDmg_Actions)
endfunction

//===========================================================================
// Trigger: SolarRaysUse
//===========================================================================
function Trig_SolarRaysUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_FireDruidBossId then
    if ShouldUnitUseAbility(GetTriggerUnit() , udg_SolarRaysAbilId , 0.95) then
    if GetUnitAbilityLevel(GetTriggerUnit(), udg_AscensionBuffId) == 0 then
        return true
    endif
    endif
    endif
    return false
endfunction

function Trig_SolarRaysUse_Actions takes nothing returns nothing
    call IssueImmediateOrder(GetTriggerUnit(), "voodoo")
endfunction

//===========================================================================
function InitTrig_SolarRaysUse takes nothing returns nothing
    set gg_trg_SolarRaysUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SolarRaysUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_SolarRaysUse, Condition(function Trig_SolarRaysUse_Conditions))
    call TriggerAddAction(gg_trg_SolarRaysUse, function Trig_SolarRaysUse_Actions)
endfunction

//===========================================================================
// Trigger: SolarRaysBegin
//===========================================================================
function Trig_SolarRaysBegin_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_SolarRaysAbilId
endfunction

function Trig_SolarRaysBegin_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    call CreateAbilFloatingText(caster , "* Solar Rays *" , 80.0 , 45.0 , 40.0)
    if GetUnitLifePercentage(caster) < 0.95 then
        call PlaySoundBJ(gg_snd_Voice_Azir_TrustInMyVision)
    endif
    set caster=null
endfunction

//===========================================================================
function InitTrig_SolarRaysBegin takes nothing returns nothing
    set gg_trg_SolarRaysBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SolarRaysBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_SolarRaysBegin, Condition(function Trig_SolarRaysBegin_Conditions))
    call TriggerAddAction(gg_trg_SolarRaysBegin, function Trig_SolarRaysBegin_Actions)
endfunction

//===========================================================================
// Trigger: SolarRaysFinish
//===========================================================================
function Trig_SolarRaysFinish_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_SolarRaysAbilId
endfunction

function Trig_SolarRaysFinish_Actions takes nothing returns nothing
    local location casterLoc= null
    local location randomLoc= null
    local unit dummy= null
    local player owningPlayer= null
    local integer i= 0
    set udg_SolarRaysCaster=GetTriggerUnit()
    set casterLoc=GetUnitLoc(udg_SolarRaysCaster)
    set owningPlayer=GetOwningPlayer(udg_SolarRaysCaster)
    
    call GroupClear(udg_SolarRaysDummyGroup)
    
    loop
        exitwhen i >= 20
        set randomLoc=PolarProjectionBJ(casterLoc, GetRandomReal(0.0, 800.0), GetRandomReal(0.0, 360.0))
        set dummy=CreateUnit(owningPlayer, udg_DummyUnitId, GetLocationX(randomLoc), GetLocationY(randomLoc), 0.0)
        call GroupAddUnit(udg_SolarRaysDummyGroup, dummy)
        call UnitApplyTimedLife(dummy, 'BTLF', 0.15 * I2R(i))
        call RemoveLocation(randomLoc)
        set randomLoc=null
        set i=i + 1
    endloop
    
    call RemoveLocation(casterLoc)
    set casterLoc=null
    set dummy=null
    set owningPlayer=null
endfunction

//===========================================================================
function InitTrig_SolarRaysFinish takes nothing returns nothing
    set gg_trg_SolarRaysFinish=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SolarRaysFinish, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_SolarRaysFinish, Condition(function Trig_SolarRaysFinish_Conditions))
    call TriggerAddAction(gg_trg_SolarRaysFinish, function Trig_SolarRaysFinish_Actions)
endfunction

//===========================================================================
// Trigger: SolarRaysDummyDeath
//===========================================================================
function Trig_SolarRaysDummyDeath_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_DummyUnitId then
    if IsUnitInGroup(GetTriggerUnit(), udg_SolarRaysDummyGroup) then
        return true
    endif
    endif
    return false
endfunction

function Trig_SolarRaysDummyDeath_Actions takes nothing returns nothing
    local unit dying= GetTriggerUnit()
    local group g= CreateGroup()
    local unit u= null
    local real x= GetUnitX(dying)
    local real y= GetUnitY(dying)
    local unit dummy= null
    local player owningPlayer= GetOwningPlayer(dying)
    
    call GroupRemoveUnit(udg_ImpaleDummyGroup, dying)

    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\ShiningFlare.mdx", x, y))
    
    set g=CreateGroup()
    call GroupEnumUnitsInRange(g, x, y, 220.0, null)
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if SpellTargetEnemyFilter(u , udg_SolarRaysCaster) then
            set udg_DamageAbility=true
            call UnitDamageTargetMagic(udg_SolarRaysCaster , u , 120.0)
            set udg_DamageAbility=false
            if not IsUnitStatusImmune(u) then
                set dummy=CreateUnit(owningPlayer, udg_DummyUnitId, GetUnitX(u), GetUnitY(u), 0.0)
                call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
                call UnitAddAbility(dummy, udg_SolarRaysDummyAbilId)
                call IssueTargetOrder(dummy, "drunkenhaze", u)
            endif
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    set dying=null
    call DestroyGroup(g)
    set g=null
    set dummy=null
    set owningPlayer=null
endfunction

//===========================================================================
function InitTrig_SolarRaysDummyDeath takes nothing returns nothing
    set gg_trg_SolarRaysDummyDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SolarRaysDummyDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_SolarRaysDummyDeath, Condition(function Trig_SolarRaysDummyDeath_Conditions))
    call TriggerAddAction(gg_trg_SolarRaysDummyDeath, function Trig_SolarRaysDummyDeath_Actions)
endfunction

//===========================================================================
// Trigger: SunfireBeamUse
//===========================================================================
function Trig_SunfireBeamUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_FireDruidBossId then
    if ShouldUnitUseAbility(GetTriggerUnit() , udg_SunfireBeamAbilId , 0.65) then
    if GetUnitAbilityLevel(GetTriggerUnit(), udg_AscensionBuffId) == 0 then
        return true
    endif
    endif
    endif
    return false
endfunction

function Trig_SunfireBeamUse_Actions takes nothing returns nothing
    local unit attacker= GetAttacker()
    call IssuePointOrder(GetTriggerUnit(), "rainoffire", GetUnitX(attacker), GetUnitY(attacker))
    set attacker=null
endfunction

//===========================================================================
function InitTrig_SunfireBeamUse takes nothing returns nothing
    set gg_trg_SunfireBeamUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SunfireBeamUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_SunfireBeamUse, Condition(function Trig_SunfireBeamUse_Conditions))
    call TriggerAddAction(gg_trg_SunfireBeamUse, function Trig_SunfireBeamUse_Actions)
endfunction

//===========================================================================
// Trigger: SunfireBeamBegin
//===========================================================================
function Trig_SunfireBeamBegin_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_SunfireBeamAbilId
endfunction

function Trig_SunfireBeamBegin_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    if udg_SunfireBeamTargetLoc != null then
        call RemoveLocation(udg_SunfireBeamTargetLoc)
        set udg_SunfireBeamTargetLoc=null
    endif
    set udg_SunfireBeamTargetLoc=GetSpellTargetLoc()
    
    call CreateAbilFloatingText(caster , "* Sunfire Beam *" , 80.0 , 45.0 , 40.0)
    if GetUnitLifePercentage(caster) < 0.95 then
        call PlaySoundBJ(gg_snd_Voice_Azir_SeeWhatISee)
    endif
    set caster=null
endfunction

//===========================================================================
function InitTrig_SunfireBeamBegin takes nothing returns nothing
    set gg_trg_SunfireBeamBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SunfireBeamBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_SunfireBeamBegin, Condition(function Trig_SunfireBeamBegin_Conditions))
    call TriggerAddAction(gg_trg_SunfireBeamBegin, function Trig_SunfireBeamBegin_Actions)
endfunction

//===========================================================================
// Trigger: SunfireBeamFinish
//===========================================================================
function SunfireBeamTick takes nothing returns nothing
    local group g= CreateGroup()
    local unit u= null
    
    call DestroyTimer(GetExpiredTimer())
    
    if GetUnitState(udg_SunfireBeamDummy, UNIT_STATE_LIFE) > 0.0 then
        call GroupEnumUnitsInRange(g, GetUnitX(udg_SunfireBeamDummy), GetUnitY(udg_SunfireBeamDummy), 250.0, null)
        
        loop
            set u=FirstOfGroup(g)
            exitwhen u == null
            if SpellTargetEnemyFilter(u , udg_SunfireBeamCaster) then
                set udg_DamageAbility=true
                call UnitDamageTargetMagic(udg_SunfireBeamCaster , u , 200.0)
                set udg_DamageAbility=false
            endif
            call GroupRemoveUnit(g, u)
        endloop
        
        call TimerStart(CreateTimer(), 1.0, false, function SunfireBeamTick)
    endif
    
    call DestroyGroup(g)
    set g=null
endfunction

function Trig_SunfireBeamFinish_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_SunfireBeamAbilId
endfunction

function Trig_SunfireBeamFinish_Actions takes nothing returns nothing
    set udg_SunfireBeamCaster=GetTriggerUnit()
    set udg_SunfireBeamDummy=CreateUnit(GetOwningPlayer(udg_SunfireBeamCaster), udg_SunfireBeamDummyId, GetLocationX(udg_SunfireBeamTargetLoc), GetLocationY(udg_SunfireBeamTargetLoc), GetRandomReal(0.0, 360.0))
    call UnitApplyTimedLife(udg_SunfireBeamDummy, 'BTLF', 8.0)
    
    call TimerStart(CreateTimer(), 0.8, false, function SunfireBeamTick)
    
    call RemoveLocation(udg_SunfireBeamTargetLoc)
    set udg_SunfireBeamTargetLoc=null
endfunction

//===========================================================================
function InitTrig_SunfireBeamFinish takes nothing returns nothing
    set gg_trg_SunfireBeamFinish=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SunfireBeamFinish, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_SunfireBeamFinish, Condition(function Trig_SunfireBeamFinish_Conditions))
    call TriggerAddAction(gg_trg_SunfireBeamFinish, function Trig_SunfireBeamFinish_Actions)
endfunction

//===========================================================================
// Trigger: TeleportFireDruidUse
//===========================================================================
function Trig_TeleportFireDruidUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_FireDruidBossId then
    if ShouldUnitUseAbility(GetTriggerUnit() , udg_TeleportFireDruidAbilId , 0.80) then
        return true
    endif
    endif
    return false
endfunction

function Trig_TeleportFireDruidUse_Actions takes nothing returns nothing
    call IssueImmediateOrder(GetTriggerUnit(), "fanofknives")
endfunction

//===========================================================================
function InitTrig_TeleportFireDruidUse takes nothing returns nothing
    set gg_trg_TeleportFireDruidUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_TeleportFireDruidUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_TeleportFireDruidUse, Condition(function Trig_TeleportFireDruidUse_Conditions))
    call TriggerAddAction(gg_trg_TeleportFireDruidUse, function Trig_TeleportFireDruidUse_Actions)
endfunction

//===========================================================================
// Trigger: TeleportFireDruidCast
//===========================================================================
function Trig_TeleportFireDruidCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_TeleportFireDruidAbilId
endfunction

function Trig_TeleportFireDruidCast_Actions takes nothing returns nothing
    local location casterLoc= null
    local location targetLoc= null
    
    set udg_TeleportFireDruidCaster=GetTriggerUnit()
    set casterLoc=Location(GetRectCenterX(gg_rct_AbilFireDruidBossTpOrigin), GetRectCenterY(gg_rct_AbilFireDruidBossTpOrigin))
    set targetLoc=PolarProjectionBJ(casterLoc, GetRandomReal(0.00, 700.00), GetRandomReal(0, 360.00))
    call BlzStartUnitAbilityCooldown(udg_TeleportFireDruidCaster, udg_TeleportFireDruidAbilId, BlzGetUnitAbilityCooldown(udg_TeleportFireDruidCaster, udg_TeleportFireDruidAbilId, GetUnitAbilityLevel(udg_TeleportFireDruidCaster, udg_TeleportFireDruidAbilId) - 1)) // - 1 for level offset.
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\BlinkGoldCaster.mdx", GetLocationX(casterLoc), GetLocationY(casterLoc)))
    call ShowUnit(udg_TeleportFireDruidCaster, false)
    call PauseUnit(udg_TeleportFireDruidCaster, true)
    call SetUnitPositionLoc(udg_TeleportFireDruidCaster, targetLoc)
    
    
    call TriggerSleepAction(3.00)
    call PauseUnit(udg_TeleportFireDruidCaster, false)
    call ShowUnit(udg_TeleportFireDruidCaster, true)
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\BlinkGoldCaster.mdx", GetLocationX(targetLoc), GetLocationY(targetLoc)))
    
    call RemoveLocation(casterLoc)
    set casterLoc=null
    call RemoveLocation(targetLoc)
    set targetLoc=null
endfunction

//===========================================================================
function InitTrig_TeleportFireDruidCast takes nothing returns nothing
    set gg_trg_TeleportFireDruidCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_TeleportFireDruidCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_TeleportFireDruidCast, Condition(function Trig_TeleportFireDruidCast_Conditions))
    call TriggerAddAction(gg_trg_TeleportFireDruidCast, function Trig_TeleportFireDruidCast_Actions)
endfunction


//===========================================================================
// Trigger: SphinxCouncilInit
//===========================================================================
function Trig_SphinxCouncilInit_Actions takes nothing returns nothing
    call ConditionalTriggerExecute(gg_trg_RandomizeSphinxBossAbils)
endfunction

//===========================================================================
function InitTrig_SphinxCouncilInit takes nothing returns nothing
    set gg_trg_SphinxCouncilInit=CreateTrigger()
    call TriggerAddAction(gg_trg_SphinxCouncilInit, function Trig_SphinxCouncilInit_Actions)
endfunction

//===========================================================================
// Trigger: RandomizeSphinxBossAbils
//===========================================================================
function Trig_RandomizeSphinxBossAbils_Func002A takes nothing returns nothing
    call UnitRemoveAbilityBJ('A028', GetEnumUnit())
    call UnitRemoveAbilityBJ('A00R', GetEnumUnit())
    call UnitRemoveAbilityBJ('A004', GetEnumUnit())
endfunction

function Trig_RandomizeSphinxBossAbils_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll(udg_SphinxBossId)
    call ForGroupBJ(udg_TempGroup, function Trig_RandomizeSphinxBossAbils_Func002A)
    set udg_TempUnit=GroupPickRandomUnit(udg_TempGroup)
    call UnitAddAbilityBJ('A028', udg_TempUnit)
    call GroupRemoveUnitSimple(udg_TempUnit, udg_TempGroup)
    set udg_TempUnit=GroupPickRandomUnit(udg_TempGroup)
    call UnitAddAbilityBJ('A00R', udg_TempUnit)
    call GroupRemoveUnitSimple(udg_TempUnit, udg_TempGroup)
    set udg_TempUnit=GroupPickRandomUnit(udg_TempGroup)
    call UnitAddAbilityBJ('A004', udg_TempUnit)
    call GroupRemoveUnitSimple(udg_TempUnit, udg_TempGroup)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_RandomizeSphinxBossAbils takes nothing returns nothing
    set gg_trg_RandomizeSphinxBossAbils=CreateTrigger()
    call TriggerAddAction(gg_trg_RandomizeSphinxBossAbils, function Trig_RandomizeSphinxBossAbils_Actions)
endfunction

//===========================================================================
// Trigger: SphinxBossShareAbility
//===========================================================================
function Trig_SphinxBossShareAbility_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == udg_SphinxBossId ) ) then
        return false
    endif
    return true
endfunction

function Trig_SphinxBossShareAbility_Func004Func001Func005C takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A028', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A028', GetEnumUnit()) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SphinxBossShareAbility_Func004Func001Func007C takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A00R', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A00R', GetEnumUnit()) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SphinxBossShareAbility_Func004Func001Func009C takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A004', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A004', GetEnumUnit()) == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SphinxBossShareAbility_Func004Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_SphinxBossShareAbility_Func004A takes nothing returns nothing
    if ( Trig_SphinxBossShareAbility_Func004Func001C() ) then
        call AddSpecialEffectTargetUnitBJ("origin", GetEnumUnit(), "Abilities\\Spells\\Other\\Awaken\\Awaken.mdl")
        call DestroyEffectBJ(GetLastCreatedEffectBJ())
        call SetUnitLifePercentBJ(GetEnumUnit(), 100)
        // Share Blood Mend
        if ( Trig_SphinxBossShareAbility_Func004Func001Func005C() ) then
            call UnitAddAbilityBJ('A028', GetEnumUnit())
        else
        endif
        // Share Shadowstorm
        if ( Trig_SphinxBossShareAbility_Func004Func001Func007C() ) then
            call UnitAddAbilityBJ('A00R', GetEnumUnit())
        else
        endif
        // Share Switcheroo
        if ( Trig_SphinxBossShareAbility_Func004Func001Func009C() ) then
            call UnitAddAbilityBJ('A004', GetEnumUnit())
        else
        endif
    else
    endif
endfunction

function Trig_SphinxBossShareAbility_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll(udg_SphinxBossId)
    call ForGroupBJ(udg_TempGroup, function Trig_SphinxBossShareAbility_Func004A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_SphinxBossShareAbility takes nothing returns nothing
    set gg_trg_SphinxBossShareAbility=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SphinxBossShareAbility, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_SphinxBossShareAbility, Condition(function Trig_SphinxBossShareAbility_Conditions))
    call TriggerAddAction(gg_trg_SphinxBossShareAbility, function Trig_SphinxBossShareAbility_Actions)
endfunction

//===========================================================================
// Trigger: SphinxBossEncounterRewards
//===========================================================================
function Trig_SphinxBossEncounterRewards_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == udg_SphinxBossId ) ) then
        return false
    endif
    return true
endfunction

function Trig_SphinxBossEncounterRewards_Func003002002001 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'u001' )
endfunction

function Trig_SphinxBossEncounterRewards_Func003002002002 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_SphinxBossEncounterRewards_Func003002002 takes nothing returns boolean
    return GetBooleanAnd((GetUnitTypeId(GetFilterUnit()) == 'u001'), (IsUnitAliveBJ(GetFilterUnit()) == true)) // INLINED!!
endfunction

function Trig_SphinxBossEncounterRewards_Func004Func003002003001 takes nothing returns boolean
    return ( IsUnitType(GetFilterUnit(), UNIT_TYPE_HERO) == true )
endfunction

function Trig_SphinxBossEncounterRewards_Func004Func003002003002 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), Player(PLAYER_NEUTRAL_AGGRESSIVE)) == true )
endfunction

function Trig_SphinxBossEncounterRewards_Func004Func003002003 takes nothing returns boolean
    return GetBooleanAnd((IsUnitType(GetFilterUnit(), UNIT_TYPE_HERO) == true), (IsUnitEnemy(GetFilterUnit(), Player(PLAYER_NEUTRAL_AGGRESSIVE)) == true)) // INLINED!!
endfunction

function Trig_SphinxBossEncounterRewards_Func004Func004A takes nothing returns nothing
    call AddHeroXPSwapped(15, GetEnumUnit(), true)
endfunction

function Trig_SphinxBossEncounterRewards_Func004C takes nothing returns boolean
    if ( not ( IsUnitGroupEmptyBJ(udg_TempGroup) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_SphinxBossEncounterRewards_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsInRectMatching(GetPlayableMapRect(), Condition(function Trig_SphinxBossEncounterRewards_Func003002002))
    if ( Trig_SphinxBossEncounterRewards_Func004C() ) then
        set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
        // Exp Reward
        set udg_TempGroup2=GetUnitsInRangeOfLocMatching(2000.00, udg_TempPoint, Condition(function Trig_SphinxBossEncounterRewards_Func004Func003002003))
        call ForGroupBJ(udg_TempGroup2, function Trig_SphinxBossEncounterRewards_Func004Func004A)
        // Resource Reward
        set bj_forLoopAIndex=1
        set bj_forLoopAIndexEnd=udg_MaxPlayers
        loop
            exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
            call AdjustPlayerStateBJ(9, ConvertedPlayer(GetForLoopIndexA()), PLAYER_STATE_RESOURCE_GOLD)
            set bj_forLoopAIndex=bj_forLoopAIndex + 1
        endloop
        set udg_TempString=( "+" + I2S(9) )
        call CreateTextTagLocBJ(udg_TempString, PolarProjectionBJ(udg_TempPoint, ( 10.00 * I2R(StringLength(udg_TempString)) ), 180.00), 0.00, 12.00, 40.00, 60.00, 100.00, 0)
        call SetTextTagVelocityBJ(GetLastCreatedTextTag(), 64.00, 90.00)
        call SetTextTagPermanentBJ(GetLastCreatedTextTag(), false)
        call SetTextTagLifespanBJ(GetLastCreatedTextTag(), 4.00)
        call SetTextTagFadepointBJ(GetLastCreatedTextTag(), 3.00)
        // Cleanup
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
        call DestroyGroup(udg_TempGroup2)
        set udg_TempGroup2=null
    else
    endif
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_SphinxBossEncounterRewards takes nothing returns nothing
    set gg_trg_SphinxBossEncounterRewards=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SphinxBossEncounterRewards, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_SphinxBossEncounterRewards, Condition(function Trig_SphinxBossEncounterRewards_Conditions))
    call TriggerAddAction(gg_trg_SphinxBossEncounterRewards, function Trig_SphinxBossEncounterRewards_Actions)
endfunction

//===========================================================================
// Trigger: FountainOfBloodUse
//===========================================================================
function Trig_FountainOfBloodUse_Conditions takes nothing returns boolean
    if GetUnitAbilityLevel(GetTriggerUnit(), udg_FountainOfBloodAbilId) > 0 then
    if (BlzGetUnitAbilityCooldownRemaining((GetTriggerUnit() ), ( udg_FountainOfBloodAbilId)) == 0.0) then // INLINED!!
    if not (IsUnitInGroup((GetTriggerUnit()), udg_IsCastingGroup)) then // INLINED!!
    if GetUnitStatePercent(GetTriggerUnit(), UNIT_STATE_LIFE, UNIT_STATE_MAX_LIFE) < 90.0 then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

function Trig_FountainOfBloodUse_Actions takes nothing returns nothing
    call IssueImmediateOrder(GetTriggerUnit(), "tranquility")
endfunction

//===========================================================================
function InitTrig_FountainOfBloodUse takes nothing returns nothing
    set gg_trg_FountainOfBloodUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FountainOfBloodUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_FountainOfBloodUse, Condition(function Trig_FountainOfBloodUse_Conditions))
    call TriggerAddAction(gg_trg_FountainOfBloodUse, function Trig_FountainOfBloodUse_Actions)
endfunction
//===========================================================================
// Trigger: FountainOfBloodBegin
//===========================================================================
function IsFountainOfBloodActive takes group casters returns boolean
    return CountUnitsInGroup(casters) > 0
endfunction

function FountainOfBloodTick takes nothing returns nothing
    local unit caster= null
    local group casters= CreateGroup()
    local unit u= null
    local group g= CreateGroup()
    
    call GroupAddGroup(udg_FountainOfBloodCasterGroup, casters)
    
    loop
        set caster=FirstOfGroup(casters)
        exitwhen caster == null
        call GroupEnumUnitsInRange(g, GetUnitX(caster), GetUnitY(caster), 900.0, null)
        loop
            set u=FirstOfGroup(g)
            exitwhen u == null
            if IsUnitAlly(u, GetOwningPlayer(caster)) and GetUnitState(u, UNIT_STATE_LIFE) > 0.0 then
                call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\HealRed.mdx", u, "origin"))
                call HealUnit(caster , u , 150.0)
            endif
            call GroupRemoveUnit(g, u)
        endloop
        call DestroyGroup(g)
        set g=null
        call GroupRemoveUnit(casters, caster)
    endloop
    
    if (CountUnitsInGroup((udg_FountainOfBloodCasterGroup)) > 0) then // INLINED!!
        call TimerStart(CreateTimer(), 1.0, false, function FountainOfBloodTick)
    endif
    
    call DestroyGroup(casters)
    set casters=null
endfunction

function Trig_FountainOfBloodBegin_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_FountainOfBloodAbilId
endfunction

function Trig_FountainOfBloodBegin_Actions takes nothing returns nothing
    call GroupAddUnit(udg_FountainOfBloodCasterGroup, GetTriggerUnit())
    if (CountUnitsInGroup((udg_FountainOfBloodCasterGroup)) > 0) then // INLINED!!
        call TimerStart(CreateTimer(), 0.5, false, function FountainOfBloodTick)
    endif
    call CreateAbilFloatingText(GetTriggerUnit() , "* Fountain of Blood *" , 75.0 , 33.0 , 33.0)
endfunction

//===========================================================================
function InitTrig_FountainOfBloodBegin takes nothing returns nothing
    set gg_trg_FountainOfBloodBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FountainOfBloodBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_FountainOfBloodBegin, Condition(function Trig_FountainOfBloodBegin_Conditions))
    call TriggerAddAction(gg_trg_FountainOfBloodBegin, function Trig_FountainOfBloodBegin_Actions)
endfunction

//===========================================================================
// Trigger: FountainOfBloodEnd
//===========================================================================
function Trig_FountainOfBloodEnd_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_FountainOfBloodAbilId
endfunction

function Trig_FountainOfBloodEnd_Actions takes nothing returns nothing
    call GroupRemoveUnit(udg_FountainOfBloodCasterGroup, GetTriggerUnit())
endfunction

//===========================================================================
function InitTrig_FountainOfBloodEnd takes nothing returns nothing
    set gg_trg_FountainOfBloodEnd=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FountainOfBloodEnd, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FountainOfBloodEnd, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_FountainOfBloodEnd, Condition(function Trig_FountainOfBloodEnd_Conditions))
    call TriggerAddAction(gg_trg_FountainOfBloodEnd, function Trig_FountainOfBloodEnd_Actions)
endfunction

//===========================================================================
// Trigger: SwitcherooUse
//===========================================================================
function Trig_SwitcherooUse_Conditions takes nothing returns boolean
    if GetUnitAbilityLevel(GetTriggerUnit(), udg_SwitcherooAbilId) > 0 then
    if (BlzGetUnitAbilityCooldownRemaining((GetTriggerUnit() ), ( udg_SwitcherooAbilId)) == 0.0) then // INLINED!!
    if not (IsUnitInGroup((GetTriggerUnit()), udg_IsCastingGroup)) then // INLINED!!
    if GetUnitStatePercent(GetTriggerUnit(), UNIT_STATE_LIFE, UNIT_STATE_MAX_LIFE) < 95.0 then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

function Trig_SwitcherooUse_Actions takes nothing returns nothing
    call IssueTargetOrder(GetTriggerUnit(), "chainlightning", GetAttacker())
endfunction

//===========================================================================
function InitTrig_SwitcherooUse takes nothing returns nothing
    set gg_trg_SwitcherooUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SwitcherooUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_SwitcherooUse, Condition(function Trig_SwitcherooUse_Conditions))
    call TriggerAddAction(gg_trg_SwitcherooUse, function Trig_SwitcherooUse_Actions)
endfunction

//===========================================================================
// Trigger: SwitcherooCast
//===========================================================================
function Trig_SwitcherooCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_SwitcherooAbilId
endfunction

function Trig_SwitcherooCast_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit target= GetSpellTargetUnit()
    local location casterLoc= GetUnitLoc(caster)
    local location targetLoc= GetUnitLoc(target)

    call BlzStartUnitAbilityCooldown(caster, udg_SwitcherooAbilId, BlzGetUnitAbilityCooldown(caster, udg_SwitcherooAbilId, GetUnitAbilityLevel(caster, udg_SwitcherooAbilId) - 1)) // - 1 for level offset.
    
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\Switcheroo.mdx", GetLocationX(casterLoc), GetLocationY(casterLoc)))
    call DestroyEffect(AddSpecialEffect("MDX\\Effects\\Switcheroo.mdx", GetLocationX(targetLoc), GetLocationY(targetLoc)))
    call SetUnitPositionLocFacingLocBJ(caster, targetLoc, casterLoc)
    call SetUnitPositionLocFacingLocBJ(target, casterLoc, targetLoc)
    
    call RemoveLocation(casterLoc)
    set casterLoc=null
    call RemoveLocation(targetLoc)
    set targetLoc=null
endfunction

//===========================================================================
function InitTrig_SwitcherooCast takes nothing returns nothing
    set gg_trg_SwitcherooCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SwitcherooCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SwitcherooCast, Condition(function Trig_SwitcherooCast_Conditions))
    call TriggerAddAction(gg_trg_SwitcherooCast, function Trig_SwitcherooCast_Actions)
endfunction

//===========================================================================
// Trigger: SuccubusAttackAnim
//===========================================================================
function Trig_SuccubusAttackAnim_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetEventDamageSource()) == 'n00J' then
    if not udg_DamageAbility then
    if not udg_DamageMagic then
        return true
    endif
    endif
    endif
    return false
endfunction

function Trig_SuccubusAttackAnim_Actions takes nothing returns nothing
    call SetUnitAnimation(GetEventDamageSource(), "attack")
endfunction

//===========================================================================
function InitTrig_SuccubusAttackAnim takes nothing returns nothing
    local integer i= 0
    set gg_trg_SuccubusAttackAnim=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_SuccubusAttackAnim, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_SuccubusAttackAnim, Condition(function Trig_SuccubusAttackAnim_Conditions))
    call TriggerAddAction(gg_trg_SuccubusAttackAnim, function Trig_SuccubusAttackAnim_Actions)
endfunction


//===========================================================================
// Trigger: AbominationEnrage
//===========================================================================
function Trig_AbominationEnrage_Conditions takes nothing returns boolean
    return GetUnitTypeId(GetTriggerUnit()) == 'u009'
endfunction

function Trig_AbominationEnrage_Actions takes nothing returns nothing
    local unit target= GetTriggerUnit()
    local real life= GetUnitState(target, UNIT_STATE_LIFE)
    local integer aLvl= GetUnitAbilityLevel(target, 'A01L')
    
    if life <= 0.2 * GetUnitState(target, UNIT_STATE_MAX_LIFE) then
        if aLvl == 0 then
            call UnitAddAbility(target, 'A01L')
        endif
        if aLvl > 0 and BlzGetUnitAbilityCooldownRemaining(target, 'A01L') == 0.0 then
            call IssueImmediateOrder(target, "berserk")
        endif
    elseif life > 0.2 * GetUnitState(target, UNIT_STATE_MAX_LIFE) and aLvl > 0 then
        call UnitRemoveAbility(target, 'A01L')
    endif
    
    set target=null
endfunction

//===========================================================================
function InitTrig_AbominationEnrage takes nothing returns nothing
    set gg_trg_AbominationEnrage=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AbominationEnrage, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_AbominationEnrage, Condition(function Trig_AbominationEnrage_Conditions))
    call TriggerAddAction(gg_trg_AbominationEnrage, function Trig_AbominationEnrage_Actions)
endfunction

//===========================================================================
// Trigger: AbominationBreathUse
//===========================================================================
function Trig_AbominationBreathUse_Conditions takes nothing returns boolean
    if GetUnitAbilityLevel(GetTriggerUnit(), 'A01M') > 0 then
    if BlzGetUnitAbilityCooldownRemaining(GetTriggerUnit(), 'A01M') == 0.00 then
        return true
    endif
    endif
    return false
endfunction

function Trig_AbominationBreathUse_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local unit target= GetAttacker()
    call IssuePointOrder(caster, "breathoffire", GetUnitX(target), GetUnitY(target))
    set caster=null
    set target=null
endfunction

//===========================================================================
function InitTrig_AbominationBreathUse takes nothing returns nothing
    set gg_trg_AbominationBreathUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AbominationBreathUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_AbominationBreathUse, Condition(function Trig_AbominationBreathUse_Conditions))
    call TriggerAddAction(gg_trg_AbominationBreathUse, function Trig_AbominationBreathUse_Actions)
endfunction

//===========================================================================
// Trigger: AbominationBreathCast
//===========================================================================
function Trig_AbominationBreathCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01M'
endfunction

function AbominationBreathTargetFilter takes unit target,unit caster returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(caster)) then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
    if not IsUnitHidden(target) then
        return true
    endif
    endif
    endif
    return false
endfunction

function Trig_AbominationBreathCast_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local location casterLoc= GetUnitLoc(caster)
    local location targetLoc= GetSpellTargetLoc()
    local real angle= AngleBetweenPoints(casterLoc, targetLoc)
    local real targetAngle= 0.0
    local group g= CreateGroup()
    local unit u= null
    
    call RemoveLocation(targetLoc)
    set targetLoc=null
    
    call SetUnitAnimation(caster, "channel")
    call QueueUnitAnimation(caster, "stand")
    
    call GroupEnumUnitsInRange(g, GetUnitX(caster), GetUnitY(caster), 450.0, null)
    loop
        set u=FirstOfGroup(g)
        exitwhen u == null
        if AbominationBreathTargetFilter(u , caster) then
            set targetLoc=GetUnitLoc(u)
            set targetAngle=AngleBetweenPoints(casterLoc, targetLoc)
            if targetAngle >= angle - 45 and targetAngle <= angle + 45 then
                set udg_DamageAbility=true
                call UnitDamageTargetMagic(caster , u , 300.0)
                set udg_DamageAbility=false
                //call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\ShadowSpike.mdx", u, "origin")) // For debugging.
            endif
            call RemoveLocation(targetLoc)
            set targetLoc=null
        endif
        call GroupRemoveUnit(g, u)
    endloop
    
    set caster=null
    call RemoveLocation(casterLoc)
    set casterLoc=null
    
    call DestroyGroup(g)
    set g=null
endfunction

//===========================================================================
function InitTrig_AbominationBreathCast takes nothing returns nothing
    set gg_trg_AbominationBreathCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AbominationBreathCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_AbominationBreathCast, Condition(function Trig_AbominationBreathCast_Conditions))
    call TriggerAddAction(gg_trg_AbominationBreathCast, function Trig_AbominationBreathCast_Actions)
endfunction

//===========================================================================
// Trigger: BoneSpike
//===========================================================================
function Trig_BoneSpike_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01H' ) ) then
        return false
    endif
    return true
endfunction

function Trig_BoneSpike_Actions takes nothing returns nothing
    set udg_DamageAbility=true
    call UnitDamageTargetBJ(GetTriggerUnit(), GetSpellTargetUnit(), 100.00, ATTACK_TYPE_MELEE, DAMAGE_TYPE_NORMAL)
    set udg_DamageAbility=false
endfunction

//===========================================================================
function InitTrig_BoneSpike takes nothing returns nothing
    set gg_trg_BoneSpike=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_BoneSpike, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_BoneSpike, Condition(function Trig_BoneSpike_Conditions))
    call TriggerAddAction(gg_trg_BoneSpike, function Trig_BoneSpike_Actions)
endfunction

//===========================================================================
// Trigger: FrozenSpheresUse
//===========================================================================
function Trig_FrozenSpheresUse_Conditions takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A00U', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetTriggerUnit(), 'A00U') == 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetTriggerUnit()) < 95.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_FrozenSpheresUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(GetTriggerUnit(), "fanofknives")
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_FrozenSpheresUse takes nothing returns nothing
    set gg_trg_FrozenSpheresUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FrozenSpheresUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_FrozenSpheresUse, Condition(function Trig_FrozenSpheresUse_Conditions))
    call TriggerAddAction(gg_trg_FrozenSpheresUse, function Trig_FrozenSpheresUse_Actions)
endfunction

//===========================================================================
// Trigger: FrozenSpheresCast
//===========================================================================
function Trig_FrozenSpheresCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00U' ) ) then
        return false
    endif
    return true
endfunction

function Trig_FrozenSpheresCast_Func003001 takes nothing returns boolean
    return ( GetRandomInt(0, 1) == 0 )
endfunction

function Trig_FrozenSpheresCast_Func006001 takes nothing returns boolean
    return ( IsTriggerEnabled(gg_trg_FrozenSpheresTick) == false )
endfunction

function Trig_FrozenSpheresCast_Actions takes nothing returns nothing
    set udg_FrozenSpheresCaster=GetTriggerUnit()
    set udg_TempReal=( 5.00 + ( 0.05 * ( 100.00 - GetUnitLifePercent(GetTriggerUnit()) ) ) )
    if ( (GetRandomInt(0, 1) == 0) ) then // INLINED!!
        set udg_FrozenSpheresDirection=3.00
    else
        set udg_FrozenSpheresDirection=- 3.00
    endif
    set udg_FrozenSpheresPoint=GetUnitLoc(GetTriggerUnit())
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=R2I(udg_TempReal)
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_TempPoint=PolarProjectionBJ(udg_FrozenSpheresPoint, 550.00, ( I2R(GetForLoopIndexA()) * ( 360.00 / udg_TempReal ) ))
        call CreateNUnitsAtLoc(1, 'u00G', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, GetRandomDirectionDeg())
        call UnitApplyTimedLifeBJ(( 15.00 + ( 3.00 * udg_TempReal ) ), 'BTLF', GetLastCreatedUnit())
        call GroupAddUnitSimple(GetLastCreatedUnit(), udg_FrozenSpheresGroup)
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    if ( (IsTriggerEnabled(gg_trg_FrozenSpheresTick) == false) ) then // INLINED!!
        call EnableTrigger(gg_trg_FrozenSpheresTick)
    else
        call DoNothing()
    endif
endfunction

//===========================================================================
function InitTrig_FrozenSpheresCast takes nothing returns nothing
    set gg_trg_FrozenSpheresCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FrozenSpheresCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_FrozenSpheresCast, Condition(function Trig_FrozenSpheresCast_Conditions))
    call TriggerAddAction(gg_trg_FrozenSpheresCast, function Trig_FrozenSpheresCast_Actions)
endfunction

//===========================================================================
// Trigger: FrozenSpheresDummyDeath
//===========================================================================
function Trig_FrozenSpheresDummyDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u00G' ) ) then
        return false
    endif
    return true
endfunction

function Trig_FrozenSpheresDummyDeath_Func002Func005001 takes nothing returns boolean
    return ( IsUnitGroupEmptyBJ(udg_TempGroup) == true )
endfunction

function Trig_FrozenSpheresDummyDeath_Func002Func005002 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_TempGroup) == true )
endfunction

function Trig_FrozenSpheresDummyDeath_Func002C takes nothing returns boolean
    if ( not GetBooleanOr((IsUnitGroupEmptyBJ(udg_TempGroup) == true), (IsUnitGroupDeadBJ(udg_TempGroup) == true)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_FrozenSpheresDummyDeath_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll('u00G')
    if ( Trig_FrozenSpheresDummyDeath_Func002C() ) then
        call DisableTrigger(gg_trg_FrozenSpheresTick)
        call RemoveLocation(udg_FrozenSpheresPoint)
        set udg_FrozenSpheresPoint=null
        call GroupClear(udg_FrozenSpheresGroup)
    else
    endif
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_FrozenSpheresDummyDeath takes nothing returns nothing
    set gg_trg_FrozenSpheresDummyDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_FrozenSpheresDummyDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_FrozenSpheresDummyDeath, Condition(function Trig_FrozenSpheresDummyDeath_Conditions))
    call TriggerAddAction(gg_trg_FrozenSpheresDummyDeath, function Trig_FrozenSpheresDummyDeath_Actions)
endfunction

//===========================================================================
// Trigger: FrozenSpheresTick
//===========================================================================
function Trig_FrozenSpheresTick_Func001Func004002003001 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_FrozenSpheresCaster)) == true )
endfunction

function Trig_FrozenSpheresTick_Func001Func004002003002 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_FrozenSpheresTick_Func001Func004002003 takes nothing returns boolean
    return GetBooleanAnd((IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_FrozenSpheresCaster)) == true), (IsUnitAliveBJ(GetFilterUnit()) == true)) // INLINED!!
endfunction

function Trig_FrozenSpheresTick_Func001Func005Func004A takes nothing returns nothing
    call UnitDamageTargetMagic(udg_FrozenSpheresCaster , GetEnumUnit() , 100.0)
endfunction

function Trig_FrozenSpheresTick_Func001Func005Func006001 takes nothing returns boolean
    return ( IsUnitGroupEmptyBJ(udg_TempGroup2) == false )
endfunction

function Trig_FrozenSpheresTick_Func001Func005Func006002 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_TempGroup2) == false )
endfunction

function Trig_FrozenSpheresTick_Func001Func005C takes nothing returns boolean
    if ( not GetBooleanAnd((IsUnitGroupEmptyBJ(udg_TempGroup2) == false), (IsUnitGroupDeadBJ(udg_TempGroup2) == false)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_FrozenSpheresTick_Func001A takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetEnumUnit())
    set udg_TempPoint2=PolarProjectionBJ(udg_FrozenSpheresPoint, DistanceBetweenPoints(udg_FrozenSpheresPoint, udg_TempPoint), ( AngleBetweenPoints(udg_FrozenSpheresPoint, udg_TempPoint) + udg_FrozenSpheresDirection ))
    call SetUnitPositionLoc(GetEnumUnit(), udg_TempPoint2)
    set udg_TempGroup2=GetUnitsInRangeOfLocMatching(100.00, udg_TempPoint, Condition(function Trig_FrozenSpheresTick_Func001Func004002003))
    if ( Trig_FrozenSpheresTick_Func001Func005C() ) then
        call GroupRemoveUnitSimple(GetEnumUnit(), udg_FrozenSpheresGroup)
        call KillUnit(GetEnumUnit())
        set udg_DamageAbility=true
        call ForGroupBJ(udg_TempGroup2, function Trig_FrozenSpheresTick_Func001Func005Func004A)
        set udg_DamageAbility=false
    else
    endif
    call DestroyGroup(udg_TempGroup2)
    set udg_TempGroup2=null
endfunction

function Trig_FrozenSpheresTick_Actions takes nothing returns nothing
    call ForGroupBJ(udg_FrozenSpheresGroup, function Trig_FrozenSpheresTick_Func001A)
endfunction

//===========================================================================
function InitTrig_FrozenSpheresTick takes nothing returns nothing
    set gg_trg_FrozenSpheresTick=CreateTrigger()
    call DisableTrigger(gg_trg_FrozenSpheresTick)
    call TriggerRegisterTimerEventPeriodic(gg_trg_FrozenSpheresTick, 0.05)
    call TriggerAddAction(gg_trg_FrozenSpheresTick, function Trig_FrozenSpheresTick_Actions)
endfunction

//===========================================================================
// Trigger: LichDeath
//===========================================================================
function Trig_LichDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n000' ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_LichDeath_Func002002002001 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'n000' )
endfunction

function Trig_LichDeath_Func002002002002 takes nothing returns boolean
    return ( IsUnitType(GetFilterUnit(), UNIT_TYPE_SUMMONED) == true )
endfunction

function Trig_LichDeath_Func002002002 takes nothing returns boolean
    return GetBooleanAnd((GetUnitTypeId(GetFilterUnit()) == 'n000'), (IsUnitType(GetFilterUnit(), UNIT_TYPE_SUMMONED) == true)) // INLINED!!
endfunction

function Trig_LichDeath_Func003A takes nothing returns nothing
    call KillUnit(GetEnumUnit())
endfunction

function Trig_LichDeath_Func006A takes nothing returns nothing
    call KillUnit(GetEnumUnit())
endfunction

function Trig_LichDeath_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_TempGroup=GetUnitsInRectMatching(GetEntireMapRect(), Condition(function Trig_LichDeath_Func002002002))
    call ForGroupBJ(udg_TempGroup, function Trig_LichDeath_Func003A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
    call ForGroupBJ(udg_SinisterReflectionGroup, function Trig_LichDeath_Func006A)
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    call PlaySoundAtPointBJ(gg_snd_Yogg_Sound01, 100, udg_TempPoint, 0)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_LichDeath takes nothing returns nothing
    set gg_trg_LichDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_LichDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_LichDeath, Condition(function Trig_LichDeath_Conditions))
    call TriggerAddAction(gg_trg_LichDeath, function Trig_LichDeath_Actions)
endfunction

//===========================================================================
// Trigger: LichBossEngage
//===========================================================================
function Trig_LichBossEngage_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == udg_LichBossId then
    if GetUnitState(GetTriggerUnit(), UNIT_STATE_LIFE) >= GetUnitState(GetTriggerUnit(), UNIT_STATE_MAX_LIFE) then
        return true
    endif
    endif
    return false
endfunction

function Trig_LichBossEngage_Actions takes nothing returns nothing
    call PlaySoundBJ(gg_snd_Yogg_BowDown)
endfunction

//===========================================================================
function InitTrig_LichBossEngage takes nothing returns nothing
    local integer i= 0
    set gg_trg_LichBossEngage=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_LichBossEngage, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_LichBossEngage, Condition(function Trig_LichBossEngage_Conditions))
    call TriggerAddAction(gg_trg_LichBossEngage, function Trig_LichBossEngage_Actions)
endfunction

//===========================================================================
// Trigger: SoulCoilUse
//===========================================================================
function Trig_SoulCoilUse_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == 'n000' then
    if not IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) then
    if not IsUnitIllusion(GetTriggerUnit()) then
    if not IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) then
        return true
    endif
    endif
    endif
    endif
    return false
endfunction

function Trig_SoulCoilUse_Actions takes nothing returns nothing
    local unit caster= GetTriggerUnit()
    local real percentHealth= GetUnitState(caster, UNIT_STATE_LIFE) / GetUnitState(caster, UNIT_STATE_MAX_LIFE)
    local integer abilityLevel= GetUnitAbilityLevel(caster, udg_AbilSoulCoilId)
    
    if percentHealth > 0.50 and abilityLevel > 0 then
        call UnitRemoveAbility(caster, udg_AbilSoulCoilId)
    elseif percentHealth <= 0.50 and abilityLevel == 0 then
        call UnitAddAbility(caster, udg_AbilSoulCoilId)
    endif
    
    if abilityLevel > 0 and BlzGetUnitAbilityCooldownRemaining(caster, udg_AbilSoulCoilId) == 0.0 then
        call IssueImmediateOrder(caster, "starfall")
    endif
    
    set caster=null
endfunction

//===========================================================================
function InitTrig_SoulCoilUse takes nothing returns nothing
    set gg_trg_SoulCoilUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SoulCoilUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_SoulCoilUse, Condition(function Trig_SoulCoilUse_Conditions))
    call TriggerAddAction(gg_trg_SoulCoilUse, function Trig_SoulCoilUse_Actions)
endfunction

//===========================================================================
// Trigger: SoulCoilBegin
//===========================================================================
function SoulCoilTargetFilter takes unit target,unit caster returns boolean
    if IsUnitEnemy(target, GetOwningPlayer(caster)) then
    if GetUnitAbilityLevel(target, 'Avul') == 0 then
    if not IsUnitHidden(target) then
        return true
    endif
    endif
    endif
    return false
endfunction

function SoulCoilTick takes nothing returns nothing
    local location casterLoc= GetUnitLoc(udg_SoulCoilCaster)
    local location randomLoc= null
    local unit dummy= null
    local group g= null
    local unit u= null
    local player owningPlayer= GetOwningPlayer(udg_SoulCoilCaster)
    
    call DestroyTimer(GetExpiredTimer())
    
    if udg_SoulCoilCaster != null and IsUnitInGroup(udg_SoulCoilCaster, udg_IsCastingGroup) then
        set g=CreateGroup()
        call GroupEnumUnitsInRange(g, GetUnitX(udg_SoulCoilCaster), GetUnitY(udg_SoulCoilCaster), 1200.0, null)
        
        // TODO: Optimization: Add check if group is empty.
        set u=GroupPickRandomUnit(g)
        if SoulCoilTargetFilter(udg_SoulCoilCaster , u) then
            set dummy=CreateUnit(owningPlayer, udg_DummyUnitId, GetUnitX(udg_SoulCoilCaster), GetUnitY(udg_SoulCoilCaster), 0.0)
            call UnitApplyTimedLife(dummy, 'BTLF', 2.0)
            call SetUnitFlyHeight(dummy, 250.0, 0.0)
            call UnitAddAbility(dummy, 'A021')
            call IssueTargetOrder(dummy, "chainlightning", u)
        endif
        
        call TimerStart(CreateTimer(), 0.25, false, function SoulCoilTick)
    endif
    
    call RemoveLocation(casterLoc)
    set casterLoc=null
    set dummy=null
    set owningPlayer=null
    set u=null
endfunction

function Trig_SoulCoilBegin_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A020'
endfunction

function Trig_SoulCoilBegin_Actions takes nothing returns nothing
    set udg_SoulCoilCaster=GetTriggerUnit()
    call CreateAbilFloatingText(udg_SoulCoilCaster , "* Soul Coil *" , 33.0 , 56.0 , 42.0)
    if GetUnitLifePercentage(udg_SoulCoilCaster) < 0.95 then
        call PlaySoundBJ(gg_snd_Yogg_Laugh)
    endif
    call TimerStart(CreateTimer(), 0.25, false, function SoulCoilTick)
endfunction

//===========================================================================
function InitTrig_SoulCoilBegin takes nothing returns nothing
    set gg_trg_SoulCoilBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SoulCoilBegin, EVENT_PLAYER_UNIT_SPELL_CAST)
    call TriggerAddCondition(gg_trg_SoulCoilBegin, Condition(function Trig_SoulCoilBegin_Conditions))
    call TriggerAddAction(gg_trg_SoulCoilBegin, function Trig_SoulCoilBegin_Actions)
endfunction

//===========================================================================
// Trigger: SoulCoilDummyCast
//===========================================================================
function Trig_SoulCoilDummyCast_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == udg_SoulCoilDummyAbilId
endfunction

function Trig_SoulCoilDummyCast_Actions takes nothing returns nothing
    set udg_DamageAbility=true
    call UnitDamageTargetMagic(udg_SoulCoilCaster , GetSpellTargetUnit() , 175.0)
    set udg_DamageAbility=false
endfunction

//===========================================================================
function InitTrig_SoulCoilDummyCast takes nothing returns nothing
    set gg_trg_SoulCoilDummyCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SoulCoilDummyCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SoulCoilDummyCast, Condition(function Trig_SoulCoilDummyCast_Conditions))
    call TriggerAddAction(gg_trg_SoulCoilDummyCast, function Trig_SoulCoilDummyCast_Actions)
endfunction

//===========================================================================
// Trigger: SoulCoilEndStop
//===========================================================================
function Trig_SoulCoilEndStop_Conditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A020'
endfunction

function Trig_SoulCoilEndStop_Actions takes nothing returns nothing
    set udg_SoulCoilCaster=null
endfunction

//===========================================================================
function InitTrig_SoulCoilEndStop takes nothing returns nothing
    set gg_trg_SoulCoilEndStop=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SoulCoilEndStop, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SoulCoilEndStop, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_SoulCoilEndStop, Condition(function Trig_SoulCoilEndStop_Conditions))
    call TriggerAddAction(gg_trg_SoulCoilEndStop, function Trig_SoulCoilEndStop_Actions)
endfunction

//===========================================================================
// Trigger: UnholyNovaUse
//===========================================================================
function Trig_UnholyNovaUse_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) == false ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A01R', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetTriggerUnit(), 'A01R') == 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetTriggerUnit()) < 95.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_UnholyNovaUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(GetTriggerUnit(), "tranquility")
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_UnholyNovaUse takes nothing returns nothing
    set gg_trg_UnholyNovaUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_UnholyNovaUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_UnholyNovaUse, Condition(function Trig_UnholyNovaUse_Conditions))
    call TriggerAddAction(gg_trg_UnholyNovaUse, function Trig_UnholyNovaUse_Actions)
endfunction

//===========================================================================
// Trigger: UnholyNovaBegin
//===========================================================================
function Trig_UnholyNovaBegin_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01R' ) ) then
        return false
    endif
    return true
endfunction

function Trig_UnholyNovaBegin_Actions takes nothing returns nothing
    call GroupAddUnitSimple(GetTriggerUnit(), udg_IsCastingGroup)
    call CreateAbilFloatingText(GetTriggerUnit() , "* Unholy Nova *" , 33.0 , 56.0 , 42.0)
endfunction

//===========================================================================
function InitTrig_UnholyNovaBegin takes nothing returns nothing
    set gg_trg_UnholyNovaBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_UnholyNovaBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_UnholyNovaBegin, Condition(function Trig_UnholyNovaBegin_Conditions))
    call TriggerAddAction(gg_trg_UnholyNovaBegin, function Trig_UnholyNovaBegin_Actions)
endfunction

//===========================================================================
// Trigger: UnholyNovaFinish
//===========================================================================
function Trig_UnholyNovaFinish_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01R' ) ) then
        return false
    endif
    return true
endfunction

function Trig_UnholyNovaFinish_Func005002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(GetTriggerUnit())) == true )
endfunction

function Trig_UnholyNovaFinish_Func007Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_UnholyNovaFinish_Func007A takes nothing returns nothing
    if ( Trig_UnholyNovaFinish_Func007Func001C() ) then
        call UnitDamageTargetMagic(GetTriggerUnit() , GetEnumUnit() , 300.0)
    else
    endif
endfunction

function Trig_UnholyNovaFinish_Func012C takes nothing returns boolean
    if ( not ( GetRandomInt(0, 1) == 1 ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_UnholyNovaFinish_Actions takes nothing returns nothing
    call IssueImmediateOrderBJ(GetTriggerUnit(), "stop")
    call SetUnitAnimation(GetTriggerUnit(), "spell")
    call QueueUnitAnimationBJ(GetTriggerUnit(), "stand")
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(550.00, udg_TempPoint, Condition(function Trig_UnholyNovaFinish_Func005002003))
    set udg_DamageAbility=true
    call ForGroupBJ(udg_TempGroup, function Trig_UnholyNovaFinish_Func007A)
    set udg_DamageAbility=false
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
    call AddSpecialEffectLocBJ(udg_TempPoint, "MDX\\Effects\\UnholyNova.mdx")
    if ( Trig_UnholyNovaFinish_Func012C() ) then
        call PlaySoundAtPointBJ(gg_snd_Yogg_EternalSuffering, 100, udg_TempPoint, 0)
    else
    endif
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
endfunction

//===========================================================================
function InitTrig_UnholyNovaFinish takes nothing returns nothing
    set gg_trg_UnholyNovaFinish=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_UnholyNovaFinish, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_UnholyNovaFinish, Condition(function Trig_UnholyNovaFinish_Conditions))
    call TriggerAddAction(gg_trg_UnholyNovaFinish, function Trig_UnholyNovaFinish_Actions)
endfunction

//===========================================================================
// Trigger: SinisterReflectUse
//===========================================================================
function Trig_SinisterReflectUse_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) == false ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A01U', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetTriggerUnit(), 'A01U') == 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetTriggerUnit()) < 85.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_SinisterReflectUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueTargetOrderBJ(GetTriggerUnit(), "drain", GetAttacker())
    set udg_SinisterReflectionTarget=GetAttacker()
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_SinisterReflectUse takes nothing returns nothing
    set gg_trg_SinisterReflectUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SinisterReflectUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_SinisterReflectUse, Condition(function Trig_SinisterReflectUse_Conditions))
    call TriggerAddAction(gg_trg_SinisterReflectUse, function Trig_SinisterReflectUse_Actions)
endfunction

//===========================================================================
// Trigger: SinisterReflectBegin
//===========================================================================
function Trig_SinisterReflectBegin_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01U' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SinisterReflectBegin_Actions takes nothing returns nothing
    call GroupAddUnitSimple(GetTriggerUnit(), udg_IsCastingGroup)
    call CreateAbilFloatingText(GetTriggerUnit() , "* Sinister Reflection *" , 33.0 , 56.0 , 42.0)
    set udg_SinisterReflectionTarget=GetSpellTargetUnit()
endfunction

//===========================================================================
function InitTrig_SinisterReflectBegin takes nothing returns nothing
    set gg_trg_SinisterReflectBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SinisterReflectBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_SinisterReflectBegin, Condition(function Trig_SinisterReflectBegin_Conditions))
    call TriggerAddAction(gg_trg_SinisterReflectBegin, function Trig_SinisterReflectBegin_Actions)
endfunction

//===========================================================================
// Trigger: SinisterReflectFinish
//===========================================================================
function Trig_SinisterReflectFinish_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A01U' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SinisterReflectFinish_Actions takes nothing returns nothing
    call IssueImmediateOrderBJ(GetTriggerUnit(), "stop")
    call SetUnitAnimation(GetTriggerUnit(), "spell")
    call QueueUnitAnimationBJ(GetTriggerUnit(), "stand")
    set udg_TempPoint=GetUnitLoc(udg_SinisterReflectionTarget)
    call CreateNUnitsAtLoc(1, GetUnitTypeId(udg_SinisterReflectionTarget), GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, GetRandomDirectionDeg())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    call PlaySoundAtPointBJ(gg_snd_Yogg_DestroyThemMinion, 100.00, udg_TempPoint, 0)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call SetHeroLevelBJ(GetLastCreatedUnit(), GetHeroLevel(udg_SinisterReflectionTarget), false)
    call SetUnitLifeBJ(GetLastCreatedUnit(), GetUnitStateSwap(UNIT_STATE_LIFE, udg_SinisterReflectionTarget))
    call SetUnitManaBJ(GetLastCreatedUnit(), GetUnitStateSwap(UNIT_STATE_MANA, udg_SinisterReflectionTarget))
    call BlzSetHeroProperName(GetLastCreatedUnit(), "Sinister Reflection")
    call UnitAddTypeBJ(UNIT_TYPE_SUMMONED, GetLastCreatedUnit())
    call SuspendHeroXPBJ(false, GetLastCreatedUnit())
    call UnitApplyTimedLifeBJ(35.00, 'BTLF', GetLastCreatedUnit())
    call GroupAddUnitSimple(GetLastCreatedUnit(), udg_SinisterReflectionGroup)
    // Scale Stats and Visuals
    call BlzSetUnitAttackCooldown(GetLastCreatedUnit(), ( BlzGetUnitAttackCooldown(GetLastCreatedUnit(), 0) * 0.50 ), R2I(0.00))
    call BlzSetUnitBaseDamage(GetLastCreatedUnit(), R2I(( I2R(BlzGetUnitBaseDamage(GetLastCreatedUnit(), 0)) * 1.25 )), 0)
    call SetUnitScalePercent(GetLastCreatedUnit(), 130.00, 130.00, 130.00)
    call SetUnitVertexColorBJ(GetLastCreatedUnit(), 0.00, 25.00, 0.00, 50.00)
endfunction

//===========================================================================
function InitTrig_SinisterReflectFinish takes nothing returns nothing
    set gg_trg_SinisterReflectFinish=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SinisterReflectFinish, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_SinisterReflectFinish, Condition(function Trig_SinisterReflectFinish_Conditions))
    call TriggerAddAction(gg_trg_SinisterReflectFinish, function Trig_SinisterReflectFinish_Actions)
endfunction

//===========================================================================
// Trigger: SinisterReflectDeath
//===========================================================================
function Trig_SinisterReflectDeath_Func001Func002001 takes nothing returns boolean
    return ( GetUnitTypeId(GetTriggerUnit()) == 'n000' )
endfunction

function Trig_SinisterReflectDeath_Func001Func002002 takes nothing returns boolean
    return ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == true )
endfunction

function Trig_SinisterReflectDeath_Func001C takes nothing returns boolean
    if ( ( IsUnitInGroup(GetTriggerUnit(), udg_SinisterReflectionGroup) == true ) ) then
        return true
    endif
    if ( GetBooleanAnd((GetUnitTypeId(GetTriggerUnit()) == 'n000'), (IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == true)) ) then // INLINED!!
        return true
    endif
    return false
endfunction

function Trig_SinisterReflectDeath_Conditions takes nothing returns boolean
    if ( not Trig_SinisterReflectDeath_Func001C() ) then
        return false
    endif
    return true
endfunction

function Trig_SinisterReflectDeath_Actions takes nothing returns nothing
    call GroupRemoveUnitSimple(GetTriggerUnit(), udg_SinisterReflectionGroup)
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    call AddSpecialEffectLocBJ(udg_TempPoint, "Abilities\\Spells\\Orc\\MirrorImage\\MirrorImageDeathCaster.mdl")
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call RemoveUnit(GetTriggerUnit())
endfunction

//===========================================================================
function InitTrig_SinisterReflectDeath takes nothing returns nothing
    set gg_trg_SinisterReflectDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SinisterReflectDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_SinisterReflectDeath, Condition(function Trig_SinisterReflectDeath_Conditions))
    call TriggerAddAction(gg_trg_SinisterReflectDeath, function Trig_SinisterReflectDeath_Actions)
endfunction

//===========================================================================
// Trigger: ClonesUse
//===========================================================================
function Trig_ClonesUse_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_IsCastingGroup) == false ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A00Z', GetAttacker()) > 0 ) ) then
        return false
    endif
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetAttacker(), 'A00Z') == 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetAttacker()) < 90.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClonesUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(GetAttacker(), "stomp")
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_ClonesUse takes nothing returns nothing
    set gg_trg_ClonesUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ClonesUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_ClonesUse, Condition(function Trig_ClonesUse_Conditions))
    call TriggerAddAction(gg_trg_ClonesUse, function Trig_ClonesUse_Actions)
endfunction

//===========================================================================
// Trigger: ClonesCast
//===========================================================================
function Trig_ClonesCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00Z' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClonesCast_Actions takes nothing returns nothing
    set udg_ClonesCaster=GetTriggerUnit()
    set udg_ClonesPoint=GetRectCenter(gg_rct_AbilLichBossClonesOrigin)
    set udg_TempPoint=GetUnitLoc(udg_ClonesCaster)
    call CreateNUnitsAtLoc(1, 'n000', GetOwningPlayer(udg_ClonesCaster), udg_TempPoint, GetUnitFacing(udg_ClonesCaster))
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    set udg_ClonesUnit=GetLastCreatedUnit()
    call UnitAddAbility(udg_ClonesUnit, 'Aloc')
    call SetUnitColor(udg_ClonesUnit, PLAYER_COLOR_AQUA)
    call AddSpecialEffectTargetUnitBJ("left hand", udg_ClonesUnit, "Abilities\\Weapons\\AvengerMissile\\AvengerMissile.mdl")
    call AddSpecialEffectTargetUnitBJ("right hand", udg_ClonesUnit, "Abilities\\Weapons\\AvengerMissile\\AvengerMissile.mdl")
    call SetUnitVertexColorBJ(udg_ClonesUnit, 75.00, 100, 75.00, 50.00)
    set udg_ClonesTick=0
    set udg_ClonesTickInterval=0
    call ConditionalTriggerExecute(gg_trg_ClonesSetNumClones)
    set udg_ClonesHasMovedCaster=false
    set udg_ClonesStartAngle=( GetUnitFacing(udg_ClonesCaster) - 180.00 )
    call ShowUnitHide(udg_ClonesCaster)
    call CreateAbilFloatingText(GetTriggerUnit() , "* Clones *" , 33.0 , 56.0 , 42.0)
    call EnableTrigger(gg_trg_ClonesLoop)
endfunction

//===========================================================================
function InitTrig_ClonesCast takes nothing returns nothing
    set gg_trg_ClonesCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ClonesCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_ClonesCast, Condition(function Trig_ClonesCast_Conditions))
    call TriggerAddAction(gg_trg_ClonesCast, function Trig_ClonesCast_Actions)
endfunction

//===========================================================================
// Trigger: ClonesLoop
//===========================================================================
function Trig_ClonesLoop_Func004Func002C takes nothing returns boolean
    if ( not ( udg_ClonesHasMovedCaster == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClonesLoop_Func004C takes nothing returns boolean
    if ( not ( udg_ClonesTick > 40 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClonesLoop_Func005Func003C takes nothing returns boolean
    if ( not ( udg_ClonesHasMovedCaster == false ) ) then
        return false
    endif
    if ( not ( GetRandomInt(0, 1) == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClonesLoop_Func005C takes nothing returns boolean
    if ( not ( udg_ClonesTickInterval == ( 40 / udg_ClonesNumClones ) ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClonesLoop_Actions takes nothing returns nothing
    set udg_ClonesTick=( udg_ClonesTick + 1 )
    set udg_ClonesTickInterval=( udg_ClonesTickInterval + 1 )
    call SetUnitPositionLocFacingLocBJ(udg_ClonesUnit, PolarProjectionBJ(udg_ClonesPoint, 300.00, ( udg_ClonesStartAngle + ( I2R(udg_ClonesTick) * 9.00 ) )), udg_ClonesPoint)
    if ( Trig_ClonesLoop_Func004C() ) then
        call RemoveUnit(udg_ClonesUnit)
        if ( Trig_ClonesLoop_Func004Func002C() ) then
            call RemoveUnit(udg_ClonesLastCreated)
        else
        endif
        call ShowUnitShow(udg_ClonesCaster)
        call PlaySoundAtPointBJ(gg_snd_Yogg_Madness, 100, udg_ClonesPoint, 0)
        call RemoveLocation(udg_ClonesPoint)
        set udg_ClonesPoint=null
        call DisableTrigger(GetTriggeringTrigger())
        return
    else
    endif
    if ( Trig_ClonesLoop_Func005C() ) then
        set udg_ClonesTickInterval=0
        set udg_TempPoint=GetUnitLoc(udg_ClonesUnit)
        if ( Trig_ClonesLoop_Func005Func003C() ) then
            set udg_ClonesHasMovedCaster=true
            call SetUnitPositionLocFacingLocBJ(udg_ClonesCaster, udg_TempPoint, udg_ClonesPoint)
            call ShowUnitShow(udg_ClonesCaster)
        else
            call CreateNUnitsAtLocFacingLocBJ(1, GetUnitTypeId(udg_ClonesCaster), GetOwningPlayer(udg_ClonesCaster), udg_TempPoint, udg_ClonesPoint)
            call UnitApplyTimedLifeBJ(BlzGetUnitAbilityCooldown(udg_ClonesCaster, 'A00Z', 0), 'BTLF', GetLastCreatedUnit())
            call UnitAddTypeBJ(UNIT_TYPE_SUMMONED, GetLastCreatedUnit())
            call BlzSetUnitIntegerFieldBJ(GetLastCreatedUnit(), UNIT_IF_GOLD_BOUNTY_AWARDED_SIDES_PER_DIE, 0)
            call UnitRemoveAbilityBJ('A00Z', GetLastCreatedUnit())
            call UnitRemoveAbilityBJ('A01U', GetLastCreatedUnit())
            call SetUnitLifePercentBJ(GetLastCreatedUnit(), GetUnitLifePercent(udg_ClonesCaster))
            call SetUnitColor(GetLastCreatedUnit(), PLAYER_COLOR_AQUA)
            call SetUnitVertexColorBJ(GetLastCreatedUnit(), 95.00, 100, 95.00, 5.00)
            set udg_ClonesLastCreated=GetLastCreatedUnit()
        endif
        call AddSpecialEffectLocBJ(udg_TempPoint, "Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl")
        call DestroyEffectBJ(GetLastCreatedEffectBJ())
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
    else
    endif
endfunction

//===========================================================================
function InitTrig_ClonesLoop takes nothing returns nothing
    set gg_trg_ClonesLoop=CreateTrigger()
    call DisableTrigger(gg_trg_ClonesLoop)
    call TriggerRegisterTimerEventPeriodic(gg_trg_ClonesLoop, 0.04)
    call TriggerAddAction(gg_trg_ClonesLoop, function Trig_ClonesLoop_Actions)
endfunction

//===========================================================================
// Trigger: ClonesSetNumClones
//===========================================================================
function Trig_ClonesSetNumClones_Actions takes nothing returns nothing
    set udg_ClonesNumClones=2
    set udg_ClonesNumClones=( udg_ClonesNumClones + ( ( 100 - R2I(GetUnitLifePercent(udg_ClonesCaster)) ) / 20 ) )
endfunction

//===========================================================================
function InitTrig_ClonesSetNumClones takes nothing returns nothing
    set gg_trg_ClonesSetNumClones=CreateTrigger()
    call TriggerAddAction(gg_trg_ClonesSetNumClones, function Trig_ClonesSetNumClones_Actions)
endfunction

//===========================================================================
// Trigger: ClonesDmg
//===========================================================================
function Trig_ClonesDmg_Func002Func001001 takes nothing returns boolean
    return ( GetUnitTypeId(GetTriggerUnit()) == 'n000' )
endfunction

function Trig_ClonesDmg_Func002Func001002 takes nothing returns boolean
    return ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == true )
endfunction

function Trig_ClonesDmg_Func002Func002001 takes nothing returns boolean
    return ( GetUnitTypeId(GetEventDamageSource()) == 'n000' )
endfunction

function Trig_ClonesDmg_Func002Func002002 takes nothing returns boolean
    return ( IsUnitType(GetEventDamageSource(), UNIT_TYPE_SUMMONED) == true )
endfunction

function Trig_ClonesDmg_Func002C takes nothing returns boolean
    if ( GetBooleanAnd((GetUnitTypeId(GetTriggerUnit()) == 'n000'), (IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == true)) ) then // INLINED!!
        return true
    endif
    if ( GetBooleanAnd((GetUnitTypeId(GetEventDamageSource()) == 'n000'), (IsUnitType(GetEventDamageSource(), UNIT_TYPE_SUMMONED) == true)) ) then // INLINED!!
        return true
    endif
    return false
endfunction

function Trig_ClonesDmg_Conditions takes nothing returns boolean
    if ( not Trig_ClonesDmg_Func002C() ) then
        return false
    endif
    return true
endfunction

function Trig_ClonesDmg_Func001Func001Func003001 takes nothing returns boolean
    return ( GetUnitTypeId(GetEventDamageSource()) == 'n000' )
endfunction

function Trig_ClonesDmg_Func001Func001Func003002 takes nothing returns boolean
    return ( IsUnitType(GetEventDamageSource(), UNIT_TYPE_SUMMONED) == true )
endfunction

function Trig_ClonesDmg_Func001Func001C takes nothing returns boolean
    if ( not GetBooleanAnd((GetUnitTypeId(GetEventDamageSource()) == 'n000'), (IsUnitType(GetEventDamageSource(), UNIT_TYPE_SUMMONED) == true)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_ClonesDmg_Func001Func004001 takes nothing returns boolean
    return ( GetUnitTypeId(GetTriggerUnit()) == 'n000' )
endfunction

function Trig_ClonesDmg_Func001Func004002 takes nothing returns boolean
    return ( IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == true )
endfunction

function Trig_ClonesDmg_Func001C takes nothing returns boolean
    if ( not GetBooleanAnd((GetUnitTypeId(GetTriggerUnit()) == 'n000'), (IsUnitType(GetTriggerUnit(), UNIT_TYPE_SUMMONED) == true)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_ClonesDmg_Actions takes nothing returns nothing
    if ( Trig_ClonesDmg_Func001C() ) then
        set udg_TempReal=GetEventDamage()
        call BlzSetEventDamage(udg_TempReal * 5)
    else
        if ( Trig_ClonesDmg_Func001Func001C() ) then
            set udg_TempReal=GetEventDamage()
            call BlzSetEventDamage(udg_TempReal * 0.2)
        else
        endif
    endif
endfunction

//===========================================================================
function InitTrig_ClonesDmg takes nothing returns nothing
    set gg_trg_ClonesDmg=CreateTrigger()
    call TriggerAddCondition(gg_trg_ClonesDmg, Condition(function Trig_ClonesDmg_Conditions))
    call TriggerAddAction(gg_trg_ClonesDmg, function Trig_ClonesDmg_Actions)
endfunction

//===========================================================================
// Trigger: ClonesDmgEvent
//===========================================================================
//===========================================================================
function InitTrig_ClonesDmgEvent takes nothing returns nothing
    local integer i= 0
    set gg_trg_ClonesDmgEvent=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_ClonesDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
endfunction
//===========================================================================
// Trigger: InitNagaSirens
//===========================================================================
function Trig_InitNagaSirens_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll('n00A')
    set udg_NagaSiren[0]=GroupPickRandomUnit(udg_TempGroup)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
    set udg_TempGroup=GetUnitsOfTypeIdAll('n00B')
    set udg_NagaSiren[1]=GroupPickRandomUnit(udg_TempGroup)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_InitNagaSirens takes nothing returns nothing
    set gg_trg_InitNagaSirens=CreateTrigger()
    call TriggerAddAction(gg_trg_InitNagaSirens, function Trig_InitNagaSirens_Actions)
endfunction

//===========================================================================
// Trigger: NagaSirenHPShareStart
//===========================================================================
function Trig_NagaSirenHPShareStart_Func003001 takes nothing returns boolean
    return ( GetTriggerUnit() == udg_NagaSiren[0] )
endfunction

function Trig_NagaSirenHPShareStart_Func003002 takes nothing returns boolean
    return ( GetTriggerUnit() == udg_NagaSiren[1] )
endfunction

function Trig_NagaSirenHPShareStart_Conditions takes nothing returns boolean
    if ( not GetBooleanOr((GetTriggerUnit() == udg_NagaSiren[0]), (GetTriggerUnit() == udg_NagaSiren[1])) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_NagaSirenHPShareStart_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call EnableTrigger(gg_trg_NagaSirenHPShare)
endfunction

//===========================================================================
function InitTrig_NagaSirenHPShareStart takes nothing returns nothing
    set gg_trg_NagaSirenHPShareStart=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_NagaSirenHPShareStart, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_NagaSirenHPShareStart, Condition(function Trig_NagaSirenHPShareStart_Conditions))
    call TriggerAddAction(gg_trg_NagaSirenHPShareStart, function Trig_NagaSirenHPShareStart_Actions)
endfunction

//===========================================================================
// Trigger: NagaSirenHPShare
//===========================================================================
function Trig_NagaSirenHPShare_Func001Func002C takes nothing returns boolean
    if ( not ( GetUnitLifePercent(udg_NagaSiren[1]) > GetUnitLifePercent(udg_NagaSiren[0]) ) ) then
        return false
    endif
    return true
endfunction

function Trig_NagaSirenHPShare_Func001C takes nothing returns boolean
    if ( not ( GetUnitLifePercent(udg_NagaSiren[0]) > GetUnitLifePercent(udg_NagaSiren[1]) ) ) then
        return false
    endif
    return true
endfunction

function Trig_NagaSirenHPShare_Actions takes nothing returns nothing
    if ( Trig_NagaSirenHPShare_Func001C() ) then
        call SetUnitLifePercentBJ(udg_NagaSiren[0], GetUnitLifePercent(udg_NagaSiren[1]))
    else
        if ( Trig_NagaSirenHPShare_Func001Func002C() ) then
            call SetUnitLifePercentBJ(udg_NagaSiren[1], GetUnitLifePercent(udg_NagaSiren[0]))
        else
        endif
    endif
endfunction

//===========================================================================
function InitTrig_NagaSirenHPShare takes nothing returns nothing
    set gg_trg_NagaSirenHPShare=CreateTrigger()
    call DisableTrigger(gg_trg_NagaSirenHPShare)
    call TriggerRegisterTimerEventPeriodic(gg_trg_NagaSirenHPShare, 1.00)
    call TriggerAddAction(gg_trg_NagaSirenHPShare, function Trig_NagaSirenHPShare_Actions)
endfunction

//===========================================================================
// Trigger: NagaSirenDeath
//===========================================================================
function Trig_NagaSirenDeath_Func003001 takes nothing returns boolean
    return ( GetUnitTypeId(GetTriggerUnit()) == 'n00A' )
endfunction

function Trig_NagaSirenDeath_Func003002 takes nothing returns boolean
    return ( GetUnitTypeId(GetTriggerUnit()) == 'n00B' )
endfunction

function Trig_NagaSirenDeath_Conditions takes nothing returns boolean
    if ( not GetBooleanOr((GetUnitTypeId(GetTriggerUnit()) == 'n00A'), (GetUnitTypeId(GetTriggerUnit()) == 'n00B')) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_NagaSirenDeath_Func005Func001Func002001 takes nothing returns boolean
    return ( GetUnitTypeId(GetEnumUnit()) == 'n00A' )
endfunction

function Trig_NagaSirenDeath_Func005Func001Func002002 takes nothing returns boolean
    return ( GetUnitTypeId(GetEnumUnit()) == 'n00B' )
endfunction

function Trig_NagaSirenDeath_Func005Func001C takes nothing returns boolean
    if ( not GetBooleanOr((GetUnitTypeId(GetEnumUnit()) == 'n00A'), (GetUnitTypeId(GetEnumUnit()) == 'n00B')) ) then // INLINED!!
        return false
    endif
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_NagaSirenDeath_Func005A takes nothing returns nothing
    if ( Trig_NagaSirenDeath_Func005Func001C() ) then
        call KillUnit(GetEnumUnit())
    else
    endif
endfunction

function Trig_NagaSirenDeath_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_TempGroup=GetUnitsInRectOfPlayer(GetEntireMapRect(), Player(PLAYER_NEUTRAL_AGGRESSIVE))
    call ForGroupBJ(udg_TempGroup, function Trig_NagaSirenDeath_Func005A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
    set bj_forLoopAIndex=1
    set bj_forLoopAIndexEnd=udg_MaxPlayers
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call AdjustPlayerStateBJ(6, ConvertedPlayer(GetForLoopIndexA()), PLAYER_STATE_RESOURCE_GOLD)
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
    call DisableTrigger(gg_trg_NagaSirenHPShare)
endfunction

//===========================================================================
function InitTrig_NagaSirenDeath takes nothing returns nothing
    set gg_trg_NagaSirenDeath=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_NagaSirenDeath, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_NagaSirenDeath, Condition(function Trig_NagaSirenDeath_Conditions))
    call TriggerAddAction(gg_trg_NagaSirenDeath, function Trig_NagaSirenDeath_Actions)
endfunction

//===========================================================================
// Trigger: HealTwinUse
//===========================================================================
function Trig_HealTwinUse_Conditions takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A00T', GetTriggerUnit()) > 0 ) ) then
        return false
    endif
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetTriggerUnit(), 'A00T') == 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetTriggerUnit()) < 100.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealTwinUse_Func004Func001Func002C takes nothing returns boolean
    if ( not ( GetTriggerUnit() == udg_NagaSiren[1] ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealTwinUse_Func004Func001C takes nothing returns boolean
    if ( not ( GetTriggerUnit() == udg_NagaSiren[0] ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealTwinUse_Func004C takes nothing returns boolean
    if ( not ( DistanceBetweenPoints(udg_TempPoint, udg_TempPoint2) < 500.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealTwinUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_TempPoint=GetUnitLoc(udg_NagaSiren[0])
    set udg_TempPoint2=GetUnitLoc(udg_NagaSiren[1])
    if ( Trig_HealTwinUse_Func004C() ) then
        if ( Trig_HealTwinUse_Func004Func001C() ) then
            call IssueTargetOrderBJ(GetTriggerUnit(), "healingwave", udg_NagaSiren[1])
        else
            if ( Trig_HealTwinUse_Func004Func001Func002C() ) then
                call IssueTargetOrderBJ(GetTriggerUnit(), "healingwave", udg_NagaSiren[0])
            else
            endif
        endif
    else
    endif
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint2=null
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_HealTwinUse takes nothing returns nothing
    set gg_trg_HealTwinUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_HealTwinUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_HealTwinUse, Condition(function Trig_HealTwinUse_Conditions))
    call TriggerAddAction(gg_trg_HealTwinUse, function Trig_HealTwinUse_Actions)
endfunction

//===========================================================================
// Trigger: HealTwinCast
//===========================================================================
function Trig_HealTwinCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00T' ) ) then
        return false
    endif
    return true
endfunction

function Trig_HealTwinCast_Actions takes nothing returns nothing
    call HealUnit(GetTriggerUnit() , GetSpellTargetUnit() , 500.0)
    call SetUnitLifePercentBJ(GetTriggerUnit(), GetUnitLifePercent(GetSpellTargetUnit()))
endfunction

//===========================================================================
function InitTrig_HealTwinCast takes nothing returns nothing
    set gg_trg_HealTwinCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_HealTwinCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_HealTwinCast, Condition(function Trig_HealTwinCast_Conditions))
    call TriggerAddAction(gg_trg_HealTwinCast, function Trig_HealTwinCast_Actions)
endfunction

//===========================================================================
// Trigger: TeleportUse
//===========================================================================
function Trig_TeleportUse_Conditions takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A00H', GetAttacker()) > 0 ) ) then
        return false
    endif
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetAttacker(), 'A00H') == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_TeleportUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(GetAttacker(), "fanofknives")
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_TeleportUse takes nothing returns nothing
    set gg_trg_TeleportUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_TeleportUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_TeleportUse, Condition(function Trig_TeleportUse_Conditions))
    call TriggerAddAction(gg_trg_TeleportUse, function Trig_TeleportUse_Actions)
endfunction

//===========================================================================
// Trigger: TeleportCast
//===========================================================================
function Trig_TeleportCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00H' ) ) then
        return false
    endif
    return true
endfunction

function Trig_TeleportCast_Actions takes nothing returns nothing
    call TriggerSleepAction(0.15)
    set udg_TempPoint=GetUnitLoc(udg_NagaSiren[0])
    set udg_TempPoint2=GetUnitLoc(udg_NagaSiren[1])
    call AddSpecialEffectLocBJ(udg_TempPoint, "Abilities\\Spells\\NightElf\\Blink\\BlinkCaster.mdl")
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
    call AddSpecialEffectLocBJ(udg_TempPoint2, "Abilities\\Spells\\NightElf\\Blink\\BlinkCaster.mdl")
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
    call SetUnitPositionLoc(udg_NagaSiren[0], udg_TempPoint2)
    call SetUnitPositionLoc(udg_NagaSiren[1], udg_TempPoint)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint2=null
endfunction

//===========================================================================
function InitTrig_TeleportCast takes nothing returns nothing
    set gg_trg_TeleportCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_TeleportCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_TeleportCast, Condition(function Trig_TeleportCast_Conditions))
    call TriggerAddAction(gg_trg_TeleportCast, function Trig_TeleportCast_Actions)
endfunction

//===========================================================================
// Trigger: ShadowstormUse
//===========================================================================
function Trig_ShadowstormUse_Conditions takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A00R', GetAttacker()) > 0 ) ) then
        return false
    endif
    if ( not ( BlzGetUnitAbilityCooldownRemaining(GetAttacker(), 'A00R') == 0.00 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetAttacker()) < 95.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowstormUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueTargetOrderBJ(GetAttacker(), "chainlightning", GetAttackedUnitBJ())
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_ShadowstormUse takes nothing returns nothing
    set gg_trg_ShadowstormUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowstormUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_ShadowstormUse, Condition(function Trig_ShadowstormUse_Conditions))
    call TriggerAddAction(gg_trg_ShadowstormUse, function Trig_ShadowstormUse_Actions)
endfunction

//===========================================================================
// Trigger: ShadowstormCast
//===========================================================================
function Trig_ShadowstormCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00R' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowstormCast_Actions takes nothing returns nothing
    set udg_ShadowstormCaster[udg_ShadowstormWriteIndex]=GetTriggerUnit()
    set udg_TempPoint=GetUnitLoc(udg_ShadowstormCaster[udg_ShadowstormWriteIndex])
    call CreateNUnitsAtLoc(1, 'u008', GetOwningPlayer(udg_ShadowstormCaster[udg_ShadowstormWriteIndex]), udg_TempPoint, bj_UNIT_FACING)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    set udg_ShadowstormDummy[udg_ShadowstormWriteIndex]=GetLastCreatedUnit()
    call UnitApplyTimedLifeBJ(4.00, 'BTLF', udg_ShadowstormDummy[udg_ShadowstormWriteIndex])
    call IssueTargetOrderBJ(udg_ShadowstormDummy[udg_ShadowstormWriteIndex], "attack", GetSpellTargetUnit())
    set udg_ShadowstormWriteIndex=( udg_ShadowstormWriteIndex + 1 )
endfunction

//===========================================================================
function InitTrig_ShadowstormCast takes nothing returns nothing
    set gg_trg_ShadowstormCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowstormCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_ShadowstormCast, Condition(function Trig_ShadowstormCast_Conditions))
    call TriggerAddAction(gg_trg_ShadowstormCast, function Trig_ShadowstormCast_Actions)
endfunction

//===========================================================================
// Trigger: ShadowstormDmg
//===========================================================================
function Trig_ShadowstormDmg_Conditions takes nothing returns boolean
    if ( not ( udg_DamageAbility == false ) ) then
        return false
    endif
    if ( not ( udg_DamageMagic == false ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetEventDamageSource()) == 'u008' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowstormDmg_Func001Func001C takes nothing returns boolean
    if ( not ( GetEventDamageSource() == udg_ShadowstormDummy[GetForLoopIndexA()] ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowstormDmg_Actions takes nothing returns nothing
    set bj_forLoopAIndex=0
    set bj_forLoopAIndexEnd=udg_ShadowstormWriteIndex
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ( Trig_ShadowstormDmg_Func001Func001C() ) then
            set udg_DamageAbility=true
            call UnitDamageTargetMagic(udg_ShadowstormCaster[GetForLoopIndexA()] , BlzGetEventDamageTarget() , 150.0)
            set udg_DamageAbility=false
        else
        endif
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
endfunction

//===========================================================================
function InitTrig_ShadowstormDmg takes nothing returns nothing
    set gg_trg_ShadowstormDmg=CreateTrigger()
    call TriggerAddCondition(gg_trg_ShadowstormDmg, Condition(function Trig_ShadowstormDmg_Conditions))
    call TriggerAddAction(gg_trg_ShadowstormDmg, function Trig_ShadowstormDmg_Actions)
endfunction

//===========================================================================
// Trigger: ShadowstormDmgEvent
//===========================================================================
//===========================================================================
function InitTrig_ShadowstormDmgEvent takes nothing returns nothing
    local integer i= 0
    set gg_trg_ShadowstormDmgEvent=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_ShadowstormDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
endfunction
//===========================================================================
// Trigger: ShadowstormDummyDeath
//===========================================================================
function Trig_ShadowstormDummyDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u008' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowstormDummyDeath_Func002C takes nothing returns boolean
    if ( not ( udg_ShadowstormWriteIndex == udg_ShadowstormReadIndex ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowstormDummyDeath_Actions takes nothing returns nothing
    set udg_ShadowstormReadIndex=( udg_ShadowstormReadIndex + 1 )
    if ( Trig_ShadowstormDummyDeath_Func002C() ) then
        set udg_ShadowstormWriteIndex=0
        set udg_ShadowstormReadIndex=0
    else
    endif
endfunction

//===========================================================================
function InitTrig_ShadowstormDummyDeath takes nothing returns nothing
    set gg_trg_ShadowstormDummyDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowstormDummyDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_ShadowstormDummyDeath, Condition(function Trig_ShadowstormDummyDeath_Conditions))
    call TriggerAddAction(gg_trg_ShadowstormDummyDeath, function Trig_ShadowstormDummyDeath_Actions)
endfunction

//===========================================================================
// Trigger: VoidZoneUse
//===========================================================================
function Trig_VoidZoneUse_Conditions takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A00A', GetAttacker()) > 0 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetAttacker()) < 95.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_VoidZoneUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(GetAttacker(), "fanofknives")
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_VoidZoneUse takes nothing returns nothing
    set gg_trg_VoidZoneUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_VoidZoneUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_VoidZoneUse, Condition(function Trig_VoidZoneUse_Conditions))
    call TriggerAddAction(gg_trg_VoidZoneUse, function Trig_VoidZoneUse_Actions)
endfunction

//===========================================================================
// Trigger: VoidZoneCast
//===========================================================================
function Trig_VoidZoneCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00A' ) ) then
        return false
    endif
    return true
endfunction

function Trig_VoidZoneCast_Func009001 takes nothing returns boolean
    return ( IsTriggerEnabled(gg_trg_VoidZoneTick) == false )
endfunction

function Trig_VoidZoneCast_Actions takes nothing returns nothing
    set udg_VoidZoneCaster[udg_VoidZoneWriteIndex]=GetTriggerUnit()
    set udg_TempPoint=GetUnitLoc(udg_VoidZoneCaster[udg_VoidZoneWriteIndex])
    call CreateNUnitsAtLoc(1, 'u00A', GetOwningPlayer(udg_VoidZoneCaster[udg_VoidZoneWriteIndex]), udg_TempPoint, GetRandomDirectionDeg())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    set udg_VoidZoneDummy[udg_VoidZoneWriteIndex]=GetLastCreatedUnit()
    call UnitApplyTimedLifeBJ(25.00, 'BTLF', udg_VoidZoneDummy[udg_VoidZoneWriteIndex])
    set udg_VoidZoneWriteIndex=( udg_VoidZoneWriteIndex + 1 )
    if ( (IsTriggerEnabled(gg_trg_VoidZoneTick) == false) ) then // INLINED!!
        call EnableTrigger(gg_trg_VoidZoneTick)
    else
        call DoNothing()
    endif
endfunction

//===========================================================================
function InitTrig_VoidZoneCast takes nothing returns nothing
    set gg_trg_VoidZoneCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_VoidZoneCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_VoidZoneCast, Condition(function Trig_VoidZoneCast_Conditions))
    call TriggerAddAction(gg_trg_VoidZoneCast, function Trig_VoidZoneCast_Actions)
endfunction

//===========================================================================
// Trigger: VoidZoneTick
//===========================================================================
function Trig_VoidZoneTick_Func001Func002002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_VoidZoneDummy[GetForLoopIndexA()])) == true )
endfunction

function Trig_VoidZoneTick_Func001Func006Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(udg_VoidZoneCaster[GetForLoopIndexA()]) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_VoidZoneTick_Func001Func006A takes nothing returns nothing
    if ( Trig_VoidZoneTick_Func001Func006Func001C() ) then
        call UnitDamageTargetMagic(udg_VoidZoneCaster[GetForLoopIndexA()] , GetEnumUnit() , 25.0)
    else
        call UnitDamageTargetMagic(udg_VoidZoneDummy[GetForLoopIndexA()] , GetEnumUnit() , 25.0)
    endif
endfunction

function Trig_VoidZoneTick_Actions takes nothing returns nothing
    set bj_forLoopAIndex=0
    set bj_forLoopAIndexEnd=udg_VoidZoneWriteIndex
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_TempPoint=GetUnitLoc(udg_VoidZoneDummy[GetForLoopIndexA()])
        set udg_TempGroup=GetUnitsInRangeOfLocMatching(200.00, udg_TempPoint, Condition(function Trig_VoidZoneTick_Func001Func002002003))
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
        set udg_DamageAbility=true
        call ForGroupBJ(udg_TempGroup, function Trig_VoidZoneTick_Func001Func006A)
        set udg_DamageAbility=false
        call DestroyGroup(udg_TempGroup)
        set udg_TempGroup=null
        set bj_forLoopAIndex=bj_forLoopAIndex + 1
    endloop
endfunction

//===========================================================================
function InitTrig_VoidZoneTick takes nothing returns nothing
    set gg_trg_VoidZoneTick=CreateTrigger()
    call DisableTrigger(gg_trg_VoidZoneTick)
    call TriggerRegisterTimerEventPeriodic(gg_trg_VoidZoneTick, 0.50)
    call TriggerAddAction(gg_trg_VoidZoneTick, function Trig_VoidZoneTick_Actions)
endfunction

//===========================================================================
// Trigger: VoidZoneDeath
//===========================================================================
function Trig_VoidZoneDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u00A' ) ) then
        return false
    endif
    return true
endfunction

function Trig_VoidZoneDeath_Func002C takes nothing returns boolean
    if ( not ( udg_VoidZoneWriteIndex == udg_VoidZoneReadIndex ) ) then
        return false
    endif
    return true
endfunction

function Trig_VoidZoneDeath_Actions takes nothing returns nothing
    set udg_VoidZoneReadIndex=( udg_VoidZoneReadIndex + 1 )
    if ( Trig_VoidZoneDeath_Func002C() ) then
        set udg_VoidZoneWriteIndex=0
        set udg_VoidZoneReadIndex=0
        call DisableTrigger(gg_trg_VoidZoneTick)
    else
    endif
endfunction

//===========================================================================
function InitTrig_VoidZoneDeath takes nothing returns nothing
    set gg_trg_VoidZoneDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_VoidZoneDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_VoidZoneDeath, Condition(function Trig_VoidZoneDeath_Conditions))
    call TriggerAddAction(gg_trg_VoidZoneDeath, function Trig_VoidZoneDeath_Actions)
endfunction

//===========================================================================
// Trigger: JinxUse
//===========================================================================
function Trig_JinxUse_Conditions takes nothing returns boolean
    if ( not ( GetUnitAbilityLevelSwapped('A009', GetAttacker()) > 0 ) ) then
        return false
    endif
    if ( not ( GetUnitLifePercent(GetAttacker()) < 95.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_JinxUse_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueTargetOrderBJ(GetAttacker(), "curse", GetTriggerUnit())
    call EnableTrigger(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_JinxUse takes nothing returns nothing
    set gg_trg_JinxUse=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_JinxUse, EVENT_PLAYER_UNIT_ATTACKED)
    call TriggerAddCondition(gg_trg_JinxUse, Condition(function Trig_JinxUse_Conditions))
    call TriggerAddAction(gg_trg_JinxUse, function Trig_JinxUse_Actions)
endfunction

//===========================================================================
// Trigger: PhoenixDeath
//===========================================================================
function Trig_PhoenixDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'h000' ) ) then
        return false
    endif
    return true
endfunction

function Trig_PhoenixDeath_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    call CreateNUnitsAtLoc(1, 'h002', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, GetRandomDirectionDeg())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call UnitApplyTimedLifeBJ(35.00, 'BTLF', GetLastCreatedUnit())
endfunction

//===========================================================================
function InitTrig_PhoenixDeath takes nothing returns nothing
    set gg_trg_PhoenixDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_PhoenixDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_PhoenixDeath, Condition(function Trig_PhoenixDeath_Conditions))
    call TriggerAddAction(gg_trg_PhoenixDeath, function Trig_PhoenixDeath_Actions)
endfunction

//===========================================================================
// Trigger: PhoenixEggDeath
//===========================================================================
function Trig_PhoenixEggDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'h002' ) ) then
        return false
    endif
    return true
endfunction

function Trig_PhoenixEggDeath_Func002Func007Func003001 takes nothing returns boolean
    return ( ModuloReal(I2R(GetForLoopIndexA()), 3.00) == 0.00 )
endfunction

function Trig_PhoenixEggDeath_Func002Func007Func006002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(GetTriggerUnit())) == true )
endfunction

function Trig_PhoenixEggDeath_Func002Func007Func010A takes nothing returns nothing
    call UnitDamageTargetMagic(udg_TempUnit , GetEnumUnit() , 50.0)
endfunction

function Trig_PhoenixEggDeath_Func002Func010001 takes nothing returns boolean
    return ( IsUnitGroupEmptyBJ(udg_TempGroup) == true )
endfunction

function Trig_PhoenixEggDeath_Func002Func010002 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_TempGroup) == true )
endfunction

function Trig_PhoenixEggDeath_Func002C takes nothing returns boolean
    if ( not GetBooleanOr((IsUnitGroupEmptyBJ(udg_TempGroup) == true), (IsUnitGroupDeadBJ(udg_TempGroup) == true)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_PhoenixEggDeath_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll('e002')
    if ( Trig_PhoenixEggDeath_Func002C() ) then
    else
        set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
        call CreateNUnitsAtLoc(1, 'h000', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, 270.00)
        call UnitAddTypeBJ(UNIT_TYPE_SUMMONED, GetLastCreatedUnit())
        set udg_TempUnit=GroupPickRandomUnit(udg_TempGroup)
        set udg_TempReal=( 50.00 - ( 0.30 * GetUnitLifePercent(udg_TempUnit) ) )
        set udg_TempUnit=GetLastCreatedUnit()
        set bj_forLoopAIndex=1
        set bj_forLoopAIndexEnd=R2I(udg_TempReal)
        loop
            exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
            set udg_TempPoint2=PolarProjectionBJ(udg_TempPoint, ( 20.00 * I2R(GetForLoopIndexA()) ), ( 32.00 * I2R(GetForLoopIndexA()) ))
            call AddSpecialEffectLocBJ(udg_TempPoint2, "Abilities\\Spells\\Other\\Incinerate\\FireLordDeathExplode.mdl")
            if ( (ModuloReal(I2R(GetForLoopIndexA()), 3.00) == 0.00) ) then // INLINED!!
                call CreateNUnitsAtLoc(1, 'e004', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint2, GetRandomDirectionDeg())
            else
                call DoNothing()
            endif
            call UnitApplyTimedLifeBJ(90.00, 'BTLF', GetLastCreatedUnit())
            call UnitAddTypeBJ(UNIT_TYPE_SUMMONED, GetLastCreatedUnit())
            set udg_TempGroup2=GetUnitsInRangeOfLocMatching(100.00, udg_TempPoint2, Condition(function Trig_PhoenixEggDeath_Func002Func007Func006002003))
            call RemoveLocation(udg_TempPoint2)
            set udg_TempPoint2=null
            set udg_DamageAbility=true
            call ForGroupBJ(udg_TempGroup2, function Trig_PhoenixEggDeath_Func002Func007Func010A)
            set udg_DamageAbility=false
            call DestroyGroup(udg_TempGroup2)
            set udg_TempGroup2=null
            call DestroyEffectBJ(GetLastCreatedEffectBJ())
            set bj_forLoopAIndex=bj_forLoopAIndex + 1
        endloop
        call RemoveLocation(udg_TempPoint)
        set udg_TempPoint=null
    endif
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_PhoenixEggDeath takes nothing returns nothing
    set gg_trg_PhoenixEggDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_PhoenixEggDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_PhoenixEggDeath, Condition(function Trig_PhoenixEggDeath_Conditions))
    call TriggerAddAction(gg_trg_PhoenixEggDeath, function Trig_PhoenixEggDeath_Actions)
endfunction

//===========================================================================
// Trigger: AnkhOfReanimation
//===========================================================================
function Trig_AnkhOfReanimation_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n007' ) ) then
        return false
    endif
    return true
endfunction

function Trig_AnkhOfReanimation_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    call CreateNUnitsAtLoc(1, 'n00C', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, 0.00)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call UnitApplyTimedLifeBJ(15.00, 'BTLF', GetLastCreatedUnit())
endfunction

//===========================================================================
function InitTrig_AnkhOfReanimation takes nothing returns nothing
    set gg_trg_AnkhOfReanimation=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AnkhOfReanimation, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_AnkhOfReanimation, Condition(function Trig_AnkhOfReanimation_Conditions))
    call TriggerAddAction(gg_trg_AnkhOfReanimation, function Trig_AnkhOfReanimation_Actions)
endfunction

//===========================================================================
// Trigger: AnkhOfReanimationDeath
//===========================================================================
function Trig_AnkhOfReanimationDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n00C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_AnkhOfReanimationDeath_Func002002003 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'n007' )
endfunction

function Trig_AnkhOfReanimationDeath_Func003Func005001 takes nothing returns boolean
    return ( IsUnitGroupEmptyBJ(udg_TempGroup) == true )
endfunction

function Trig_AnkhOfReanimationDeath_Func003Func005002 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_TempGroup) == true )
endfunction

function Trig_AnkhOfReanimationDeath_Func003C takes nothing returns boolean
    if ( not GetBooleanOr((IsUnitGroupEmptyBJ(udg_TempGroup) == true), (IsUnitGroupDeadBJ(udg_TempGroup) == true)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_AnkhOfReanimationDeath_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(1500.00, udg_TempPoint, Condition(function Trig_AnkhOfReanimationDeath_Func002002003))
    if ( Trig_AnkhOfReanimationDeath_Func003C() ) then
        call RemoveUnit(GetTriggerUnit())
    else
        call CreateNUnitsAtLoc(1, 'n007', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, 270.00)
        call SetUnitLifePercentBJ(GetLastCreatedUnit(), 50.00)
        call UnitAddTypeBJ(UNIT_TYPE_SUMMONED, GetLastCreatedUnit())
    endif
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_AnkhOfReanimationDeath takes nothing returns nothing
    set gg_trg_AnkhOfReanimationDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_AnkhOfReanimationDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_AnkhOfReanimationDeath, Condition(function Trig_AnkhOfReanimationDeath_Conditions))
    call TriggerAddAction(gg_trg_AnkhOfReanimationDeath, function Trig_AnkhOfReanimationDeath_Actions)
endfunction

//===========================================================================
// Trigger: InitWaspEggs
//===========================================================================
function Trig_InitWaspEggs_Func002A takes nothing returns nothing
    call TriggerRegisterUnitInRangeSimple(gg_trg_WaspEggAggro, 150.00, GetEnumUnit())
endfunction

function Trig_InitWaspEggs_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll('u007')
    call ForGroupBJ(udg_TempGroup, function Trig_InitWaspEggs_Func002A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_InitWaspEggs takes nothing returns nothing
    set gg_trg_InitWaspEggs=CreateTrigger()
    call TriggerAddAction(gg_trg_InitWaspEggs, function Trig_InitWaspEggs_Actions)
endfunction

//===========================================================================
// Trigger: WaspEggAggro
//===========================================================================
function Trig_WaspEggAggro_Conditions takes nothing returns boolean
    if ( not ( IsUnitEnemy(GetTriggerUnit(), Player(PLAYER_NEUTRAL_AGGRESSIVE)) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_WaspEggAggro_Func003002003 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'u007' )
endfunction

function Trig_WaspEggAggro_Func006A takes nothing returns nothing
    call KillUnit(GetEnumUnit())
endfunction

function Trig_WaspEggAggro_Actions takes nothing returns nothing
    call TriggerSleepAction(0.00)
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(150.00, udg_TempPoint, Condition(function Trig_WaspEggAggro_Func003002003))
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call ForGroupBJ(udg_TempGroup, function Trig_WaspEggAggro_Func006A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_WaspEggAggro takes nothing returns nothing
    set gg_trg_WaspEggAggro=CreateTrigger()
    call TriggerAddCondition(gg_trg_WaspEggAggro, Condition(function Trig_WaspEggAggro_Conditions))
    call TriggerAddAction(gg_trg_WaspEggAggro, function Trig_WaspEggAggro_Actions)
endfunction

//===========================================================================
// Trigger: WaspEggDeath
//===========================================================================
function Trig_WaspEggDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u007' ) ) then
        return false
    endif
    return true
endfunction

function Trig_WaspEggDeath_Func003002003 takes nothing returns boolean
    return ( GetUnitTypeId(GetFilterUnit()) == 'u007' )
endfunction

function Trig_WaspEggDeath_Func007A takes nothing returns nothing
    call KillUnit(GetEnumUnit())
endfunction

function Trig_WaspEggDeath_Actions takes nothing returns nothing
    call TriggerSleepAction(0.00)
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(150.00, udg_TempPoint, Condition(function Trig_WaspEggDeath_Func003002003))
    call CreateNUnitsAtLoc(1, 'n009', Player(PLAYER_NEUTRAL_AGGRESSIVE), udg_TempPoint, GetRandomDirectionDeg())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call ForGroupBJ(udg_TempGroup, function Trig_WaspEggDeath_Func007A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_WaspEggDeath takes nothing returns nothing
    set gg_trg_WaspEggDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_WaspEggDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_WaspEggDeath, Condition(function Trig_WaspEggDeath_Conditions))
    call TriggerAddAction(gg_trg_WaspEggDeath, function Trig_WaspEggDeath_Actions)
endfunction

//===========================================================================
// Trigger: MasterOfTheVaultInit
//===========================================================================
function Trig_MasterOfTheVaultInit_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll('u00B')
    set udg_MasterOfTheVault=GroupPickRandomUnit(udg_TempGroup)
    call TriggerRegisterUnitInRangeSimple(gg_trg_MasterOfTheVaultEngage, 650.00, udg_MasterOfTheVault)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_MasterOfTheVaultInit takes nothing returns nothing
    set gg_trg_MasterOfTheVaultInit=CreateTrigger()
    call TriggerAddAction(gg_trg_MasterOfTheVaultInit, function Trig_MasterOfTheVaultInit_Actions)
endfunction

//===========================================================================
// Trigger: MasterOfTheVaultEngage
//===========================================================================
function Trig_MasterOfTheVaultEngage_Conditions takes nothing returns boolean
    if ( not ( IsUnitEnemy(GetTriggerUnit(), Player(PLAYER_NEUTRAL_AGGRESSIVE)) == true ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(GetTriggerUnit()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultEngage_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call EnableTrigger(gg_trg_MasterOfTheVaultAITick)
endfunction

//===========================================================================
function InitTrig_MasterOfTheVaultEngage takes nothing returns nothing
    set gg_trg_MasterOfTheVaultEngage=CreateTrigger()
    call TriggerAddCondition(gg_trg_MasterOfTheVaultEngage, Condition(function Trig_MasterOfTheVaultEngage_Conditions))
    call TriggerAddAction(gg_trg_MasterOfTheVaultEngage, function Trig_MasterOfTheVaultEngage_Actions)
endfunction

//===========================================================================
// Trigger: MasterOfTheVaultAITick
//===========================================================================
function Trig_MasterOfTheVaultAITick_Func002002003001 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_MasterOfTheVault)) == true )
endfunction

function Trig_MasterOfTheVaultAITick_Func002002003002 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_MasterOfTheVaultAITick_Func002002003 takes nothing returns boolean
    return GetBooleanAnd((IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_MasterOfTheVault)) == true), (IsUnitAliveBJ(GetFilterUnit()) == true)) // INLINED!!
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func001001 takes nothing returns boolean
    return ( GetUnitAbilityLevelSwapped('A00O', udg_MasterOfTheVault) == 0 )
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func002Func001001 takes nothing returns boolean
    return ( GetUnitAbilityLevelSwapped('A00P', udg_MasterOfTheVault) == 0 )
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func002Func002C takes nothing returns boolean
    if ( not ( BlzGetUnitAbilityCooldownRemaining(udg_MasterOfTheVault, 'A00P') == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func002C takes nothing returns boolean
    if ( not ( GetUnitLifePercent(udg_MasterOfTheVault) < 40.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func003001 takes nothing returns boolean
    return ( GetUnitAbilityLevelSwapped('A00C', udg_MasterOfTheVault) == 0 )
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func004C takes nothing returns boolean
    if ( not ( BlzGetUnitAbilityCooldownRemaining(udg_MasterOfTheVault, 'A00C') == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002C takes nothing returns boolean
    if ( not ( GetUnitLifePercent(udg_MasterOfTheVault) < 60.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002C takes nothing returns boolean
    if ( not ( BlzGetUnitAbilityCooldownRemaining(udg_MasterOfTheVault, 'A00O') == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002C takes nothing returns boolean
    if ( not ( GetUnitLifePercent(udg_MasterOfTheVault) < 80.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002Func003C takes nothing returns boolean
    if ( not ( BlzGetUnitAbilityCooldownRemaining(udg_MasterOfTheVault, 'A00N') == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func002C takes nothing returns boolean
    if ( not ( BlzGetUnitAbilityCooldownRemaining(udg_MasterOfTheVault, 'A018') == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func008001 takes nothing returns boolean
    return ( IsUnitGroupEmptyBJ(udg_TempGroup) == true )
endfunction

function Trig_MasterOfTheVaultAITick_Func003Func008002 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_TempGroup) == true )
endfunction

function Trig_MasterOfTheVaultAITick_Func003C takes nothing returns boolean
    if ( not GetBooleanOr((IsUnitGroupEmptyBJ(udg_TempGroup) == true), (IsUnitGroupDeadBJ(udg_TempGroup) == true)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultAITick_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(udg_MasterOfTheVault)
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(1200.00, udg_TempPoint, Condition(function Trig_MasterOfTheVaultAITick_Func002002003))
    if ( Trig_MasterOfTheVaultAITick_Func003C() ) then
        call DisableTrigger(GetTriggeringTrigger())
        call UnitRemoveAbilityBJ('A00O', udg_MasterOfTheVault)
        call UnitRemoveAbilityBJ('A00P', udg_MasterOfTheVault)
        call UnitRemoveAbilityBJ('A00C', udg_MasterOfTheVault)
        call EnableTrigger(gg_trg_MasterOfTheVaultEngage)
    else
        // Summon Otherwordly Entity
        if ( Trig_MasterOfTheVaultAITick_Func003Func002C() ) then
            set udg_TempPoint2=PolarProjectionBJ(udg_TempPoint, GetRandomReal(550.00, 650.00), GetRandomDirectionDeg())
            call IssuePointOrderLocBJ(udg_MasterOfTheVault, "silence", udg_TempPoint2)
            call RemoveLocation(udg_TempPoint2)
            set udg_TempPoint2=null
        else
            // Dark Beam
            if ( Trig_MasterOfTheVaultAITick_Func003Func002Func003C() ) then
                call IssueTargetOrderBJ(udg_MasterOfTheVault, "chainlightning", GroupPickRandomUnit(udg_TempGroup))
            else
                // Shadow Spikes
                if ( Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002C() ) then
                    if ( (GetUnitAbilityLevelSwapped('A00O', udg_MasterOfTheVault) == 0) ) then // INLINED!!
                        call UnitAddAbilityBJ('A00O', udg_MasterOfTheVault)
                    else
                        call DoNothing()
                    endif
                    if ( Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002C() ) then
                        call IssueImmediateOrderBJ(udg_MasterOfTheVault, "tranquility")
                    else
                        // Summon Corrupted Watcher
                        if ( Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002C() ) then
                            if ( (GetUnitAbilityLevelSwapped('A00C', udg_MasterOfTheVault) == 0) ) then // INLINED!!
                                call UnitAddAbilityBJ('A00C', udg_MasterOfTheVault)
                            else
                                call DoNothing()
                            endif
                            if ( Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func004C() ) then
                                call IssueImmediateOrderBJ(udg_MasterOfTheVault, "fanofknives")
                            else
                            endif
                        else
                            // Shadow Eruption
                            if ( Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func002C() ) then
                                if ( (GetUnitAbilityLevelSwapped('A00P', udg_MasterOfTheVault) == 0) ) then // INLINED!!
                                    call UnitAddAbilityBJ('A00P', udg_MasterOfTheVault)
                                else
                                    call DoNothing()
                                endif
                                if ( Trig_MasterOfTheVaultAITick_Func003Func002Func003Func002Func002Func002Func002Func002C() ) then
                                    call IssueTargetOrderBJ(udg_MasterOfTheVault, "forkedlightning", GroupPickRandomUnit(udg_TempGroup))
                                else
                                endif
                            else
                            endif
                        endif
                    endif
                else
                endif
            endif
        endif
    endif
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_MasterOfTheVaultAITick takes nothing returns nothing
    set gg_trg_MasterOfTheVaultAITick=CreateTrigger()
    call DisableTrigger(gg_trg_MasterOfTheVaultAITick)
    call TriggerRegisterTimerEventPeriodic(gg_trg_MasterOfTheVaultAITick, 3.00)
    call TriggerAddAction(gg_trg_MasterOfTheVaultAITick, function Trig_MasterOfTheVaultAITick_Actions)
endfunction

//===========================================================================
// Trigger: MasterOfTheVaultDeath
//===========================================================================
function Trig_MasterOfTheVaultDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u00B' ) ) then
        return false
    endif
    return true
endfunction

function Trig_MasterOfTheVaultDeath_Func002002003 takes nothing returns boolean
    return ( IsUnitAlly(GetFilterUnit(), GetOwningPlayer(GetTriggerUnit())) == true )
endfunction

function Trig_MasterOfTheVaultDeath_Func003A takes nothing returns nothing
    call KillUnit(GetEnumUnit())
endfunction

function Trig_MasterOfTheVaultDeath_Func004002 takes nothing returns nothing
    call RemoveUnit(GetEnumUnit())
endfunction

function Trig_MasterOfTheVaultDeath_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(1000.00, udg_TempPoint, Condition(function Trig_MasterOfTheVaultDeath_Func002002003))
    call ForGroupBJ(udg_TempGroup, function Trig_MasterOfTheVaultDeath_Func003A)
    call ForGroupBJ(udg_ShadowSpikesDummyGroup, function Trig_MasterOfTheVaultDeath_Func004002)
    call DisableTrigger(gg_trg_ShadowEruptionDummyDeath)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_MasterOfTheVaultDeath takes nothing returns nothing
    set gg_trg_MasterOfTheVaultDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_MasterOfTheVaultDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_MasterOfTheVaultDeath, Condition(function Trig_MasterOfTheVaultDeath_Conditions))
    call TriggerAddAction(gg_trg_MasterOfTheVaultDeath, function Trig_MasterOfTheVaultDeath_Actions)
endfunction

//===========================================================================
// Trigger: OtherwordlyBarrier
//===========================================================================
function Trig_OtherwordlyBarrier_Conditions takes nothing returns boolean
    return GetUnitAbilityLevel(GetTriggerUnit(), 'B00A') > 0
endfunction

function Trig_OtherwordlyBarrier_Actions takes nothing returns nothing
    if GetUnitAbilityLevel(GetEventDamageSource(), 'B00U') == 0 then
        call BlzSetEventDamage(GetEventDamage() * 0.05)
    endif
endfunction

//===========================================================================
function InitTrig_OtherwordlyBarrier takes nothing returns nothing
    local integer i= 0
    set gg_trg_OtherwordlyBarrier=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_OtherwordlyBarrier, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_OtherwordlyBarrier, Condition(function Trig_OtherwordlyBarrier_Conditions))
    call TriggerAddAction(gg_trg_OtherwordlyBarrier, function Trig_OtherwordlyBarrier_Actions)
endfunction

//===========================================================================
// Trigger: DarkBeamCast
//===========================================================================
function Trig_DarkBeamCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00N' ) ) then
        return false
    endif
    return true
endfunction

function Trig_DarkBeamCast_Func003002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_MasterOfTheVault)) == true )
endfunction

function Trig_DarkBeamCast_Func004A takes nothing returns nothing
    call CreateNUnitsAtLoc(1, 'u000', GetOwningPlayer(udg_MasterOfTheVault), udg_TempPoint, bj_UNIT_FACING)
    call UnitApplyTimedLifeBJ(2.00, 'BTLF', GetLastCreatedUnit())
    call SetUnitFlyHeightBJ(GetLastCreatedUnit(), 115.00, 0.00)
    call UnitAddAbilityBJ('A00M', GetLastCreatedUnit())
    call IssueTargetOrderBJ(GetLastCreatedUnit(), "chainlightning", GetEnumUnit())
endfunction

function Trig_DarkBeamCast_Actions takes nothing returns nothing
    set udg_DarkBeamMultiplier=1.00
    set udg_TempPoint=GetUnitLoc(udg_MasterOfTheVault)
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(900.00, udg_TempPoint, Condition(function Trig_DarkBeamCast_Func003002003))
    call ForGroupBJ(udg_TempGroup, function Trig_DarkBeamCast_Func004A)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
    call CreateAbilFloatingText(GetTriggerUnit() , "* Dark Beam *" , 60.0 , 40.0 , 80.0)
endfunction

//===========================================================================
function InitTrig_DarkBeamCast takes nothing returns nothing
    set gg_trg_DarkBeamCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_DarkBeamCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_DarkBeamCast, Condition(function Trig_DarkBeamCast_Conditions))
    call TriggerAddAction(gg_trg_DarkBeamCast, function Trig_DarkBeamCast_Actions)
endfunction

//===========================================================================
// Trigger: DarkBeamDmg
//===========================================================================
function Trig_DarkBeamDmg_Conditions takes nothing returns boolean
    if ( not ( udg_DamageAbility == false ) ) then
        return false
    endif
    if ( not ( udg_DamageMagic == false ) ) then
        return false
    endif
    if ( not ( GetUnitAbilityLevelSwapped('A00M', GetEventDamageSource()) > 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_DarkBeamDmg_Actions takes nothing returns nothing
    set udg_DamageAbility=true
    call UnitDamageTargetMagic(udg_MasterOfTheVault , BlzGetEventDamageTarget() , udg_DarkBeamMultiplier * 150.0)
    set udg_DamageAbility=false
    set udg_DarkBeamMultiplier=( udg_DarkBeamMultiplier + 0.25 )
endfunction

//===========================================================================
function InitTrig_DarkBeamDmg takes nothing returns nothing
    set gg_trg_DarkBeamDmg=CreateTrigger()
    call TriggerAddCondition(gg_trg_DarkBeamDmg, Condition(function Trig_DarkBeamDmg_Conditions))
    call TriggerAddAction(gg_trg_DarkBeamDmg, function Trig_DarkBeamDmg_Actions)
endfunction

//===========================================================================
// Trigger: DarkBeamDmgEvent
//===========================================================================
//===========================================================================
function InitTrig_DarkBeamDmgEvent takes nothing returns nothing
    local integer i= 0
    set gg_trg_DarkBeamDmgEvent=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_DarkBeamDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
endfunction
//===========================================================================
// Trigger: ShadowEruptionCast
//===========================================================================
function Trig_ShadowEruptionCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00P' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowEruptionCast_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetSpellTargetUnit())
    call CreateNUnitsAtLoc(1, 'u00E', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, GetRandomDirectionDeg())
    call UnitApplyTimedLifeBJ(4.00, 'BTLF', GetLastCreatedUnit())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call CreateAbilFloatingText(GetTriggerUnit() , "* Shadow Eruption *" , 60.0 , 40.0 , 80.0)
endfunction

//===========================================================================
function InitTrig_ShadowEruptionCast takes nothing returns nothing
    set gg_trg_ShadowEruptionCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowEruptionCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_ShadowEruptionCast, Condition(function Trig_ShadowEruptionCast_Conditions))
    call TriggerAddAction(gg_trg_ShadowEruptionCast, function Trig_ShadowEruptionCast_Actions)
endfunction

//===========================================================================
// Trigger: ShadowEruptionDummyDeath
//===========================================================================
function Trig_ShadowEruptionDummyDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u00E' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowEruptionDummyDeath_Func004002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_MasterOfTheVault)) == true )
endfunction

function Trig_ShadowEruptionDummyDeath_Func008Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowEruptionDummyDeath_Func008A takes nothing returns nothing
    if ( Trig_ShadowEruptionDummyDeath_Func008Func001C() ) then
        call UnitDamageTargetMagic(udg_MasterOfTheVault , GetEnumUnit() , 800.0)
    else
    endif
endfunction

function Trig_ShadowEruptionDummyDeath_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(150.00, udg_TempPoint, Condition(function Trig_ShadowEruptionDummyDeath_Func004002003))
    call AddSpecialEffectLocBJ(udg_TempPoint, "MDX\\Effects\\ShadowEruption.mdx")
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
    set udg_DamageAbility=true
    call ForGroupBJ(udg_TempGroup, function Trig_ShadowEruptionDummyDeath_Func008A)
    set udg_DamageAbility=false
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_ShadowEruptionDummyDeath takes nothing returns nothing
    set gg_trg_ShadowEruptionDummyDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowEruptionDummyDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_ShadowEruptionDummyDeath, Condition(function Trig_ShadowEruptionDummyDeath_Conditions))
    call TriggerAddAction(gg_trg_ShadowEruptionDummyDeath, function Trig_ShadowEruptionDummyDeath_Actions)
endfunction

//===========================================================================
// Trigger: ShadowSpikesCastBegin
//===========================================================================
function Trig_ShadowSpikesCastBegin_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00O' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowSpikesCastBegin_Func008001 takes nothing returns boolean
    return ( GetRandomInt(0, 1) == 1 )
endfunction

function Trig_ShadowSpikesCastBegin_Actions takes nothing returns nothing
    set udg_ShadowSpikesFinished=false
    set udg_ShadowSpikesCaster=GetTriggerUnit()
    call SetPlayerAbilityAvailableBJ(false, 'A00N', GetOwningPlayer(udg_ShadowSpikesCaster))
    call SetPlayerAbilityAvailableBJ(false, 'A00P', GetOwningPlayer(udg_ShadowSpikesCaster))
    call SetPlayerAbilityAvailableBJ(false, 'A00C', GetOwningPlayer(udg_ShadowSpikesCaster))
    call GroupClear(udg_ShadowSpikesDummyGroup)
    set udg_TempReal=GetRandomDirectionDeg()
    if ( (GetRandomInt(0, 1) == 1) ) then // INLINED!!
        set udg_TempReal2=12.00
    else
        set udg_TempReal2=- 12.00
    endif
    set bj_forLoopBIndex=1
    set bj_forLoopBIndexEnd=5
    loop
        exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
        set bj_forLoopAIndex=1
        set bj_forLoopAIndexEnd=7
        loop
            exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
            set udg_TempPoint=PolarProjectionBJ(GetUnitLoc(GetTriggerUnit()), ( 90.00 * I2R(GetForLoopIndexA()) ), ( ( udg_TempReal + ( 75.00 * I2R(GetForLoopIndexB()) ) ) + ( udg_TempReal2 * I2R(GetForLoopIndexA()) ) ))
            call CreateNUnitsAtLoc(1, 'u00D', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, GetRandomDirectionDeg())
            call UnitApplyTimedLifeBJ(( 3.00 + ( 0.15 * I2R(GetForLoopIndexA()) ) ), 'BTLF', GetLastCreatedUnit())
            call GroupAddUnitSimple(GetLastCreatedUnit(), udg_ShadowSpikesDummyGroup)
            call RemoveLocation(udg_TempPoint)
            set udg_TempPoint=null
            set bj_forLoopAIndex=bj_forLoopAIndex + 1
        endloop
        set bj_forLoopBIndex=bj_forLoopBIndex + 1
    endloop
    call CreateAbilFloatingText(udg_ShadowSpikesCaster , "* Shadow Spikes *" , 60.0 , 40.0 , 80.0)
endfunction

//===========================================================================
function InitTrig_ShadowSpikesCastBegin takes nothing returns nothing
    set gg_trg_ShadowSpikesCastBegin=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowSpikesCastBegin, EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerAddCondition(gg_trg_ShadowSpikesCastBegin, Condition(function Trig_ShadowSpikesCastBegin_Conditions))
    call TriggerAddAction(gg_trg_ShadowSpikesCastBegin, function Trig_ShadowSpikesCastBegin_Actions)
endfunction

//===========================================================================
// Trigger: ShadowSpikesCastStop
//===========================================================================
function Trig_ShadowSpikesCastStop_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00O' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowSpikesCastStop_Func001Func001A takes nothing returns nothing
    call RemoveUnit(GetEnumUnit())
endfunction

function Trig_ShadowSpikesCastStop_Func001C takes nothing returns boolean
    if ( not ( udg_ShadowSpikesFinished == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowSpikesCastStop_Actions takes nothing returns nothing
    if ( Trig_ShadowSpikesCastStop_Func001C() ) then
        call ForGroupBJ(udg_ShadowSpikesDummyGroup, function Trig_ShadowSpikesCastStop_Func001Func001A)
    else
    endif
    call SetPlayerAbilityAvailableBJ(true, 'A00N', GetOwningPlayer(udg_ShadowSpikesCaster))
    call SetPlayerAbilityAvailableBJ(true, 'A00C', GetOwningPlayer(udg_ShadowSpikesCaster))
    call SetPlayerAbilityAvailableBJ(true, 'A00P', GetOwningPlayer(udg_ShadowSpikesCaster))
    call EnableTrigger(gg_trg_MasterOfTheVaultAITick)
endfunction

//===========================================================================
function InitTrig_ShadowSpikesCastStop takes nothing returns nothing
    set gg_trg_ShadowSpikesCastStop=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowSpikesCastStop, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
    call TriggerAddCondition(gg_trg_ShadowSpikesCastStop, Condition(function Trig_ShadowSpikesCastStop_Conditions))
    call TriggerAddAction(gg_trg_ShadowSpikesCastStop, function Trig_ShadowSpikesCastStop_Actions)
endfunction

//===========================================================================
// Trigger: ShadowSpikesCastFinish
//===========================================================================
function Trig_ShadowSpikesCastFinish_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00O' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowSpikesCastFinish_Actions takes nothing returns nothing
    set udg_ShadowSpikesFinished=true
    call SetPlayerAbilityAvailableBJ(true, 'A00N', GetOwningPlayer(udg_ShadowSpikesCaster))
    call SetPlayerAbilityAvailableBJ(true, 'A00C', GetOwningPlayer(udg_ShadowSpikesCaster))
    call SetPlayerAbilityAvailableBJ(true, 'A00P', GetOwningPlayer(udg_ShadowSpikesCaster))
    call EnableTrigger(gg_trg_MasterOfTheVaultAITick)
endfunction

//===========================================================================
function InitTrig_ShadowSpikesCastFinish takes nothing returns nothing
    set gg_trg_ShadowSpikesCastFinish=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowSpikesCastFinish, EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerAddCondition(gg_trg_ShadowSpikesCastFinish, Condition(function Trig_ShadowSpikesCastFinish_Conditions))
    call TriggerAddAction(gg_trg_ShadowSpikesCastFinish, function Trig_ShadowSpikesCastFinish_Actions)
endfunction

//===========================================================================
// Trigger: ShadowSpikesDummyDeath
//===========================================================================
function Trig_ShadowSpikesDummyDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u00D' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowSpikesDummyDeath_Func004002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(udg_ShadowSpikesCaster)) == true )
endfunction

function Trig_ShadowSpikesDummyDeath_Func010Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_ShadowSpikesDummyDeath_Func010A takes nothing returns nothing
    if ( Trig_ShadowSpikesDummyDeath_Func010Func001C() ) then
        call UnitDamageTargetMagic(udg_ShadowSpikesCaster , GetEnumUnit() , 300.0)
    else
    endif
endfunction

function Trig_ShadowSpikesDummyDeath_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(100.00, udg_TempPoint, Condition(function Trig_ShadowSpikesDummyDeath_Func004002003))
    call AddSpecialEffectLocBJ(udg_TempPoint, "MDX\\Effects\\ShadowSpike.mdx")
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call DestroyEffectBJ(GetLastCreatedEffectBJ())
    set udg_DamageAbility=true
    call ForGroupBJ(udg_TempGroup, function Trig_ShadowSpikesDummyDeath_Func010A)
    set udg_DamageAbility=false
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_ShadowSpikesDummyDeath takes nothing returns nothing
    set gg_trg_ShadowSpikesDummyDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ShadowSpikesDummyDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_ShadowSpikesDummyDeath, Condition(function Trig_ShadowSpikesDummyDeath_Conditions))
    call TriggerAddAction(gg_trg_ShadowSpikesDummyDeath, function Trig_ShadowSpikesDummyDeath_Actions)
endfunction

//===========================================================================
// Trigger: SummonCorruptWatcherCast
//===========================================================================
function Trig_SummonCorruptWatcherCast_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A00C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SummonCorruptWatcherCast_Func003001 takes nothing returns boolean
    return ( IsTriggerEnabled(gg_trg_BindingGazeUse) == false )
endfunction

function Trig_SummonCorruptWatcherCast_Actions takes nothing returns nothing
    set udg_TempPoint=PolarProjectionBJ(GetUnitLoc(GetTriggerUnit()), GetRandomReal(250.00, 350.00), GetRandomDirectionDeg())
    call CreateNUnitsAtLoc(1, 'u00C', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint, GetRandomDirectionDeg())
    if ( (IsTriggerEnabled(gg_trg_BindingGazeUse) == false) ) then // INLINED!!
        call EnableTrigger(gg_trg_BindingGazeUse)
    else
        call DoNothing()
    endif
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call CreateAbilFloatingText(GetTriggerUnit() , "* Summon Corrupted Watcher *" , 60.0 , 40.0 , 80.0)
endfunction

//===========================================================================
function InitTrig_SummonCorruptWatcherCast takes nothing returns nothing
    set gg_trg_SummonCorruptWatcherCast=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SummonCorruptWatcherCast, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SummonCorruptWatcherCast, Condition(function Trig_SummonCorruptWatcherCast_Conditions))
    call TriggerAddAction(gg_trg_SummonCorruptWatcherCast, function Trig_SummonCorruptWatcherCast_Actions)
endfunction

//===========================================================================
// Trigger: CorruptWatcherEnterMap
//===========================================================================
function Trig_CorruptWatcherEnterMap_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'u00C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_CorruptWatcherEnterMap_Actions takes nothing returns nothing
    call SetUnitAnimation(GetTriggerUnit(), "birth")
    call QueueUnitAnimationBJ(GetTriggerUnit(), "stand")
endfunction

//===========================================================================
function InitTrig_CorruptWatcherEnterMap takes nothing returns nothing
    set gg_trg_CorruptWatcherEnterMap=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_CorruptWatcherEnterMap, GetEntireMapRect())
    call TriggerAddCondition(gg_trg_CorruptWatcherEnterMap, Condition(function Trig_CorruptWatcherEnterMap_Conditions))
    call TriggerAddAction(gg_trg_CorruptWatcherEnterMap, function Trig_CorruptWatcherEnterMap_Actions)
endfunction

//===========================================================================
// Trigger: BindingGazeUse
//===========================================================================
function Trig_BindingGazeUse_Func002Func001Func002002003 takes nothing returns boolean
    return ( IsUnitEnemy(GetFilterUnit(), GetOwningPlayer(GetEnumUnit())) == true )
endfunction

function Trig_BindingGazeUse_Func002Func001Func006C takes nothing returns boolean
    if ( not ( UnitHasBuffBJ(udg_TempUnit, 'B006') == false ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(udg_TempUnit) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_BindingGazeUse_Func002Func001A takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetEnumUnit())
    set udg_TempGroup2=GetUnitsInRangeOfLocMatching(500.00, udg_TempPoint, Condition(function Trig_BindingGazeUse_Func002Func001Func002002003))
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    set udg_TempUnit=GroupPickRandomUnit(udg_TempGroup2)
    if ( Trig_BindingGazeUse_Func002Func001Func006C() ) then
        call IssueTargetOrderBJ(GetEnumUnit(), "magicleash", udg_TempUnit)
    else
    endif
endfunction

function Trig_BindingGazeUse_Func002Func003001 takes nothing returns boolean
    return ( IsUnitGroupEmptyBJ(udg_TempGroup) == true )
endfunction

function Trig_BindingGazeUse_Func002Func003002 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_TempGroup) == true )
endfunction

function Trig_BindingGazeUse_Func002C takes nothing returns boolean
    if ( not GetBooleanOr((IsUnitGroupEmptyBJ(udg_TempGroup) == true), (IsUnitGroupDeadBJ(udg_TempGroup) == true)) ) then // INLINED!!
        return false
    endif
    return true
endfunction

function Trig_BindingGazeUse_Actions takes nothing returns nothing
    set udg_TempGroup=GetUnitsOfTypeIdAll('u00C')
    if ( Trig_BindingGazeUse_Func002C() ) then
        call DisableTrigger(GetTriggeringTrigger())
    else
        call ForGroupBJ(udg_TempGroup, function Trig_BindingGazeUse_Func002Func001A)
    endif
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_BindingGazeUse takes nothing returns nothing
    set gg_trg_BindingGazeUse=CreateTrigger()
    call DisableTrigger(gg_trg_BindingGazeUse)
    call TriggerRegisterTimerEventPeriodic(gg_trg_BindingGazeUse, 3.00)
    call TriggerAddAction(gg_trg_BindingGazeUse, function Trig_BindingGazeUse_Actions)
endfunction

//===========================================================================
// Trigger: BindingGazeDmg
//===========================================================================
function Trig_BindingGazeDmg_Conditions takes nothing returns boolean
    if ( not ( udg_DamageAbility == false ) ) then
        return false
    endif
    if ( not ( udg_DamageMagic == false ) ) then
        return false
    endif
    if ( not ( GetUnitTypeId(GetEventDamageSource()) == 'u00C' ) ) then
        return false
    endif
    return true
endfunction

function Trig_BindingGazeDmg_Actions takes nothing returns nothing
    set udg_DamageAbility=true
    call UnitDamageTargetMagic(GetEventDamageSource() , BlzGetEventDamageTarget() , 20.0)
    set udg_DamageAbility=false
endfunction

//===========================================================================
function InitTrig_BindingGazeDmg takes nothing returns nothing
    set gg_trg_BindingGazeDmg=CreateTrigger()
    call TriggerAddCondition(gg_trg_BindingGazeDmg, Condition(function Trig_BindingGazeDmg_Conditions))
    call TriggerAddAction(gg_trg_BindingGazeDmg, function Trig_BindingGazeDmg_Actions)
endfunction

//===========================================================================
// Trigger: BindingGazeDmgEvent
//===========================================================================
//===========================================================================
function InitTrig_BindingGazeDmgEvent takes nothing returns nothing
    local integer i= 0
    set gg_trg_BindingGazeDmgEvent=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_BindingGazeDmg, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
endfunction
//===========================================================================
// Trigger: SummonOtherwordlyEntity
//===========================================================================
function Trig_SummonOtherwordlyEntity_Conditions takes nothing returns boolean
    if ( not ( GetSpellAbilityId() == 'A018' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SummonOtherwordlyEntity_Actions takes nothing returns nothing
    set udg_TempPoint=GetSpellTargetLoc()
    call CreateNUnitsAtLoc(1, 'n00E', Player(PLAYER_NEUTRAL_AGGRESSIVE), udg_TempPoint, GetRandomDirectionDeg())
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call CreateAbilFloatingText(GetTriggerUnit() , "* Summon Otherwordly Entity *" , 60.0 , 40.0 , 80.0)
endfunction

//===========================================================================
function InitTrig_SummonOtherwordlyEntity takes nothing returns nothing
    set gg_trg_SummonOtherwordlyEntity=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_SummonOtherwordlyEntity, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_SummonOtherwordlyEntity, Condition(function Trig_SummonOtherwordlyEntity_Conditions))
    call TriggerAddAction(gg_trg_SummonOtherwordlyEntity, function Trig_SummonOtherwordlyEntity_Actions)
endfunction

//===========================================================================
// Trigger: OtherwordlyEntityDeath
//===========================================================================
function Trig_OtherwordlyEntityDeath_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetTriggerUnit()) == 'n00E' ) ) then
        return false
    endif
    return true
endfunction

function Trig_OtherwordlyEntityDeath_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    call CreateItemLoc('I00B', udg_TempPoint)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_OtherwordlyEntityDeath takes nothing returns nothing
    set gg_trg_OtherwordlyEntityDeath=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_OtherwordlyEntityDeath, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_OtherwordlyEntityDeath, Condition(function Trig_OtherwordlyEntityDeath_Conditions))
    call TriggerAddAction(gg_trg_OtherwordlyEntityDeath, function Trig_OtherwordlyEntityDeath_Actions)
endfunction

//===========================================================================
// Trigger: PatMainHallInit
//===========================================================================
function Trig_PatMainHallInit_Actions takes nothing returns nothing
    set udg_PatMainHall=GetUnitsInRectOfPlayer(gg_rct_PatrolMainHallCenter, Player(PLAYER_NEUTRAL_AGGRESSIVE))
    set udg_PatMainHallDestination=gg_rct_PatrolMainHallSouth
    call ConditionalTriggerExecute(gg_trg_PatMainHallMove)
endfunction

//===========================================================================
function InitTrig_PatMainHallInit takes nothing returns nothing
    set gg_trg_PatMainHallInit=CreateTrigger()
    call TriggerAddAction(gg_trg_PatMainHallInit, function Trig_PatMainHallInit_Actions)
endfunction

//===========================================================================
// Trigger: PatMainHallLoad
//===========================================================================
function Trig_PatMainHallLoad_Actions takes nothing returns nothing
    set udg_PatMainHallDestination=gg_rct_PatrolMainHallCenter
    call ConditionalTriggerExecute(gg_trg_PatMainHallMove)
endfunction

//===========================================================================
function InitTrig_PatMainHallLoad takes nothing returns nothing
    set gg_trg_PatMainHallLoad=CreateTrigger()
    call TriggerRegisterGameLoadedEventBJ(gg_trg_PatMainHallLoad)
    call TriggerAddAction(gg_trg_PatMainHallLoad, function Trig_PatMainHallLoad_Actions)
endfunction

//===========================================================================
// Trigger: PatMainHallCenter
//===========================================================================
function Trig_PatMainHallCenter_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetTriggerUnit(), udg_PatMainHall) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_PatMainHallCenter_Func001Func002Func001Func002C takes nothing returns boolean
    if ( not ( udg_TempInt == 2 ) ) then
        return false
    endif
    return true
endfunction

function Trig_PatMainHallCenter_Func001Func002Func001C takes nothing returns boolean
    if ( not ( udg_TempInt == 1 ) ) then
        return false
    endif
    return true
endfunction

function Trig_PatMainHallCenter_Func001Func002C takes nothing returns boolean
    if ( not ( udg_TempInt == 0 ) ) then
        return false
    endif
    return true
endfunction

function Trig_PatMainHallCenter_Func001C takes nothing returns boolean
    if ( not ( TimerGetRemaining(udg_PatMainHallTimer) == 0.00 ) ) then
        return false
    endif
    return true
endfunction

function Trig_PatMainHallCenter_Actions takes nothing returns nothing
    if ( Trig_PatMainHallCenter_Func001C() ) then
        set udg_TempInt=GetRandomInt(0, 3)
        if ( Trig_PatMainHallCenter_Func001Func002C() ) then
            set udg_PatMainHallDestination=gg_rct_PatrolMainHallEast
        else
            if ( Trig_PatMainHallCenter_Func001Func002Func001C() ) then
                set udg_PatMainHallDestination=gg_rct_PatrolMainHallNorth
            else
                if ( Trig_PatMainHallCenter_Func001Func002Func001Func002C() ) then
                    set udg_PatMainHallDestination=gg_rct_PatrolMainHallSouth
                else
                    set udg_PatMainHallDestination=gg_rct_PatrolMainHallWest
                endif
            endif
        endif
        call StartTimerBJ(udg_PatMainHallTimer, false, 8.00)
    else
    endif
endfunction

//===========================================================================
function InitTrig_PatMainHallCenter takes nothing returns nothing
    set gg_trg_PatMainHallCenter=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_PatMainHallCenter, gg_rct_PatrolMainHallCenter)
    call TriggerAddCondition(gg_trg_PatMainHallCenter, Condition(function Trig_PatMainHallCenter_Conditions))
    call TriggerAddAction(gg_trg_PatMainHallCenter, function Trig_PatMainHallCenter_Actions)
endfunction

//===========================================================================
// Trigger: PatMainHallMove
//===========================================================================
function Trig_PatMainHallMove_Actions takes nothing returns nothing
    set udg_TempPoint=GetRectCenter(udg_PatMainHallDestination)
    call GroupPointOrderLocBJ(udg_PatMainHall, "attack", udg_TempPoint)
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
endfunction

//===========================================================================
function InitTrig_PatMainHallMove takes nothing returns nothing
    set gg_trg_PatMainHallMove=CreateTrigger()
    call TriggerRegisterTimerExpireEventBJ(gg_trg_PatMainHallMove, udg_PatMainHallTimer)
    call TriggerAddAction(gg_trg_PatMainHallMove, function Trig_PatMainHallMove_Actions)
endfunction

//===========================================================================
// Trigger: ItemAncientTome
//===========================================================================
function Trig_ItemAncientTome_Conditions takes nothing returns boolean
    if ( not ( GetItemTypeId(GetManipulatedItem()) == 'I006' ) ) then
        return false
    endif
    return true
endfunction

function Trig_ItemAncientTome_Actions takes nothing returns nothing
    call ModifyHeroSkillPoints(GetTriggerUnit(), bj_MODIFYMETHOD_ADD, 1)
    call RemoveItem(GetManipulatedItem())
endfunction

//===========================================================================
function InitTrig_ItemAncientTome takes nothing returns nothing
    set gg_trg_ItemAncientTome=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ItemAncientTome, EVENT_PLAYER_UNIT_PICKUP_ITEM)
    call TriggerAddCondition(gg_trg_ItemAncientTome, Condition(function Trig_ItemAncientTome_Conditions))
    call TriggerAddAction(gg_trg_ItemAncientTome, function Trig_ItemAncientTome_Actions)
endfunction

//===========================================================================
// Trigger: ItemAbilLifeOrb
//===========================================================================
function Trig_ItemAbilLifeOrb_Conditions takes nothing returns boolean
    if udg_DamageMagic then
    if GetInventoryIndexOfItemTypeBJ(GetEventDamageSource(), udg_ItemIdLifeOrb) > 0 then
        return true
    endif
    endif
    return false
endfunction

function Trig_ItemAbilLifeOrb_Actions takes nothing returns nothing
    local unit source= GetEventDamageSource()
    
    call DestroyEffect(AddSpecialEffectTarget("MDX\\Effects\\HealGreen.mdx", source, "origin"))
    call HealUnit(source , source , 0.3 * GetEventDamage())
    
    set source=null
endfunction

//===========================================================================
function InitTrig_ItemAbilLifeOrb takes nothing returns nothing
    local integer i= 0
    set gg_trg_ItemAbilLifeOrb=CreateTrigger()
    loop
        call TriggerRegisterPlayerUnitEvent(gg_trg_ItemAbilLifeOrb, Player(i), EVENT_PLAYER_UNIT_DAMAGED, null)
        set i=i + 1
        exitwhen i > bj_MAX_PLAYER_SLOTS
    endloop
    call TriggerAddCondition(gg_trg_ItemAbilLifeOrb, Condition(function Trig_ItemAbilLifeOrb_Conditions))
    call TriggerAddAction(gg_trg_ItemAbilLifeOrb, function Trig_ItemAbilLifeOrb_Actions)
endfunction

//===========================================================================
// Trigger: ItemAbilSoulEater
//===========================================================================
function Trig_ItemAbilSoulEater_Func002002003 takes nothing returns boolean
    return ( UnitHasItemOfTypeBJ(GetFilterUnit(), 'I005') == true )
endfunction

function Trig_ItemAbilSoulEater_Func005Func001C takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(GetEnumUnit()) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_ItemAbilSoulEater_Func005A takes nothing returns nothing
    if ( Trig_ItemAbilSoulEater_Func005Func001C() ) then
        call HealUnit(GetEnumUnit() , GetEnumUnit() , 0.05 * GetUnitState(GetEnumUnit(), UNIT_STATE_MAX_LIFE))
        call AddSpecialEffectTargetUnitBJ("origin", GetEnumUnit(), "MDX\\Effects\\HealGreen.mdx")
        call DestroyEffectBJ(GetLastCreatedEffectBJ())
    else
    endif
endfunction

function Trig_ItemAbilSoulEater_Actions takes nothing returns nothing
    set udg_TempPoint=GetUnitLoc(GetTriggerUnit())
    set udg_TempGroup=GetUnitsInRangeOfLocMatching(900.00, udg_TempPoint, Condition(function Trig_ItemAbilSoulEater_Func002002003))
    call RemoveLocation(udg_TempPoint)
    set udg_TempPoint=null
    call ForGroupBJ(udg_TempGroup, function Trig_ItemAbilSoulEater_Func005A)
    call DestroyGroup(udg_TempGroup)
    set udg_TempGroup=null
endfunction

//===========================================================================
function InitTrig_ItemAbilSoulEater takes nothing returns nothing
    set gg_trg_ItemAbilSoulEater=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(gg_trg_ItemAbilSoulEater, EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddAction(gg_trg_ItemAbilSoulEater, function Trig_ItemAbilSoulEater_Actions)
endfunction

//===========================================================================
// Trigger: ItemAbilSoulEaterCondition
//===========================================================================
function ItemAbilSoulEaterCondition takes nothing returns boolean
    if GetUnitAbilityLevel(GetTriggerUnit(), 'Aloc') == 0 then
    if not IsUnitIllusion(GetTriggerUnit()) then
        return true
    endif
    endif
    return false
endfunction

//===========================================================================
function InitTrig_ItemAbilSoulEaterCondition takes nothing returns nothing
    set gg_trg_ItemAbilSoulEaterCondition=CreateTrigger()
    call TriggerAddCondition(gg_trg_ItemAbilSoulEater, Condition(function ItemAbilSoulEaterCondition))
endfunction
//===========================================================================
// Trigger: TempLevelUp
//===========================================================================
function Trig_TempLevelUp_Func001A takes nothing returns nothing
    call SetHeroLevelBJ(GetEnumUnit(), ( GetHeroLevel(GetEnumUnit()) + 1 ), true)
endfunction

function Trig_TempLevelUp_Actions takes nothing returns nothing
    call ForGroupBJ(udg_PlayerHeroes, function Trig_TempLevelUp_Func001A)
endfunction

//===========================================================================
function InitTrig_TempLevelUp takes nothing returns nothing
    set gg_trg_TempLevelUp=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUp, Player(0), "lvlup", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUp, Player(1), "lvlup", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUp, Player(2), "lvlup", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUp, Player(3), "lvlup", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUp, Player(4), "lvlup", true)
    call TriggerAddAction(gg_trg_TempLevelUp, function Trig_TempLevelUp_Actions)
endfunction

//===========================================================================
// Trigger: TempLevelUpMax
//===========================================================================
function Trig_TempLevelUpMax_Func001A takes nothing returns nothing
    call SetHeroLevelBJ(GetEnumUnit(), 10, true)
endfunction

function Trig_TempLevelUpMax_Actions takes nothing returns nothing
    call ForGroupBJ(udg_PlayerHeroes, function Trig_TempLevelUpMax_Func001A)
endfunction

//===========================================================================
function InitTrig_TempLevelUpMax takes nothing returns nothing
    set gg_trg_TempLevelUpMax=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUpMax, Player(0), "lvlmax", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUpMax, Player(1), "lvlmax", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUpMax, Player(2), "lvlmax", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUpMax, Player(3), "lvlmax", true)
    call TriggerRegisterPlayerChatEvent(gg_trg_TempLevelUpMax, Player(4), "lvlmax", true)
    call TriggerAddAction(gg_trg_TempLevelUpMax, function Trig_TempLevelUpMax_Actions)
endfunction

//===========================================================================
function InitCustomTriggers takes nothing returns nothing
    call InitTrig_IsUnitCasting()
    call InitTrig_IsCastingBegin()
    call InitTrig_IsCastingCleanup()
    set gg_trg_ShouldUnitUseAbility=CreateTrigger() // INLINED!!
    call InitTrig_DispelUnit()
    call InitTrig_EnemyUseAbility()
    call InitTrig_IsUnitStatusImmune()
    call InitTrig_InterruptTarget()
    call InitTrig_GetUnitDamage()
    set gg_trg_GetUnitLifePercentage=CreateTrigger() // INLINED!!
    call InitTrig_GetUnitLifeRegeneration()
    call InitTrig_GetUnitMagicDamageReduction()
    call InitTrig_GetUnitManaRegeneration()
    call InitTrig_GetUnitSpellPower()
    call InitTrig_HealUnit()
    call InitTrig_RegenerateLife()
    call InitTrig_RestoreMana()
    call InitTrig_SpellTargetEnemyFilter()
    call InitTrig_UnitDamageTargetMagic()
    call InitTrig_Init()
    call InitTrig_InitInGame()
    call InitTrig_Regeneration()
    call InitTrig_Zoom()
    call InitTrig_LevelsInit()
    call InitTrig_NextLevel()
    call InitTrig_Level01Exit()
    call InitTrig_Level02Exit()
    call InitTrig_Level03Exit()
    call InitTrig_Level04Exit()
    call InitTrig_Level05Exit()
    call InitTrig_Level06Exit()
    call InitTrig_Level01Complete()
    call InitTrig_Level02Complete()
    call InitTrig_Level03Complete()
    call InitTrig_Level04Complete()
    call InitTrig_Level05Complete()
    call InitTrig_Level06Complete()
    call InitTrig_Level07Complete()
    call InitTrig_InitCircleOfCultists()
    call InitTrig_CircleOfCultistsAggro()
    call InitTrig_CircleOfCultistsAttacked()
    call InitTrig_OpenMainGateStart()
    call InitTrig_OpenMainGateFinish()
    call InitTrig_OpenGateToTriangle()
    call InitTrig_HeroSelectInit()
    call InitTrig_HeroSelectSetSeleted()
    call InitTrig_SetHeroSelectMaxAbils()
    call InitTrig_SetPlayerNumHeroes()
    call InitTrig_DoubleClickTimeoutP1()
    call InitTrig_DoubleClickTimeoutP2()
    call InitTrig_DoubleClickTimeoutP3()
    call InitTrig_DoubleClickTimeoutP4()
    call InitTrig_DoubleClickTimeoutP5()
    call InitTrig_HeroRevive()
    call InitTrig_SetHeroColors()
    call InitTrig_ThunderheadCast()
    call InitTrig_ThunderheadDmg()
    call InitTrig_ThunderheadDmgEvent()
    call InitTrig_SpiritBeastsCast()
    call InitTrig_SpiritBeastsScale()
    call InitTrig_StormShieldCast()
    call InitTrig_StormShieldDmg()
    call InitTrig_AvatarCast()
    call InitTrig_SpiritCoil()
    call InitTrig_DarkSlumber()
    call InitTrig_SiphonAura()
    call InitTrig_WheelOfDeathCast()
    call InitTrig_WheelOfDeathTick()
    call InitTrig_SunBladesCast()
    call InitTrig_SunBladesDmgEvt()
    call InitTrig_SunBlessingLearn()
    call InitTrig_SunBlessingCast()
    call InitTrig_SunBlessingTick()
    call InitTrig_SunShieldDmgEvt()
    call InitTrig_MirageCast()
    call InitTrig_MirageDeath()
    call InitTrig_ArcaneTorrent()
    call InitTrig_ArcaneTorrentDummyDeath()
    call InitTrig_Amplify()
    call InitTrig_NetherFlux()
    call InitTrig_ArcaneNovaFinish()
    call InitTrig_RayOfLight()
    call InitTrig_ShiningGaze()
    call InitTrig_HolyShield()
    call InitTrig_HolyShieldDmgEvent()
    call InitTrig_RadiantNova()
    call InitTrig_HealingStreamCast()
    call InitTrig_FireTotemCast()
    call InitTrig_EarthShield()
    call InitTrig_TranqTotemCast()
    call InitTrig_TranqTotemBirth()
    call InitTrig_TranqTotemDeath()
    call InitTrig_TranqTotemTick()
    call InitTrig_Rake()
    call InitTrig_Umbra()
    call InitTrig_SlaughterCast()
    call InitTrig_SlaughterTick()
    call InitTrig_IronRavenAlphaInit()
    call InitTrig_IronRavenAlphaAbility()
    call InitTrig_IronRavenAlphaPeriodic()
    call InitTrig_IronRavenAlphaSelect()
    //Function not found: call InitTrig_CreateAbilFloatingText()
    call InitTrig_CreepResourceAward()
    call InitTrig_CreepExpReward()
    call InitTrig_CreepRegen()
    call InitTrig_CreepRegenStopByAttack()
    call InitTrig_CreepRegenStopByAttacked()
    call InitTrig_CreepRegenStopBySpellTargetEnemy()
    call InitTrig_CreepRegenStopByDamaged()
    call InitTrig_CreepRegenStopByDamagedEvent()
    call InitTrig_InitGolems()
    call InitTrig_GolemAggro()
    call InitTrig_EarthSpearUse()
    call InitTrig_EarthSpearCast()
    call InitTrig_EarthSpearDmg()
    call InitTrig_AcolyteHeal()
    call InitTrig_ImpaleAttack()
    call InitTrig_ImpaleDummyDeath()
    call InitTrig_BonesOfDeathUse()
    call InitTrig_BonesOfDeathCast()
    call InitTrig_BonesOfDeathEnd()
    call InitTrig_BonesOfDeathStop()
    call InitTrig_SummonScarabsUse()
    call InitTrig_SummonScarabsCast()
    call InitTrig_ShockwaveUse()
    call InitTrig_ShockwaveBegin()
    call InitTrig_ShockwaveFinish()
    call InitTrig_FireDruidBossDeath()
    call InitTrig_FireDruidBossKill()
    call InitTrig_FireDruidBossEngage()
    call InitTrig_AscensionUse()
    call InitTrig_AscensionCast()
    call InitTrig_AscensionDmg()
    call InitTrig_SolarRaysUse()
    call InitTrig_SolarRaysBegin()
    call InitTrig_SolarRaysFinish()
    call InitTrig_SolarRaysDummyDeath()
    call InitTrig_SunfireBeamUse()
    call InitTrig_SunfireBeamBegin()
    call InitTrig_SunfireBeamFinish()
    call InitTrig_TeleportFireDruidUse()
    call InitTrig_TeleportFireDruidCast()
    call InitTrig_SphinxCouncilInit()
    call InitTrig_RandomizeSphinxBossAbils()
    call InitTrig_SphinxBossShareAbility()
    call InitTrig_SphinxBossEncounterRewards()
    call InitTrig_FountainOfBloodUse()
    call InitTrig_FountainOfBloodBegin()
    call InitTrig_FountainOfBloodEnd()
    call InitTrig_SwitcherooUse()
    call InitTrig_SwitcherooCast()
    call InitTrig_SuccubusAttackAnim()
    call InitTrig_AbominationEnrage()
    call InitTrig_AbominationBreathUse()
    call InitTrig_AbominationBreathCast()
    call InitTrig_BoneSpike()
    call InitTrig_FrozenSpheresUse()
    call InitTrig_FrozenSpheresCast()
    call InitTrig_FrozenSpheresDummyDeath()
    call InitTrig_FrozenSpheresTick()
    call InitTrig_LichDeath()
    call InitTrig_LichBossEngage()
    call InitTrig_SoulCoilUse()
    call InitTrig_SoulCoilBegin()
    call InitTrig_SoulCoilDummyCast()
    call InitTrig_SoulCoilEndStop()
    call InitTrig_UnholyNovaUse()
    call InitTrig_UnholyNovaBegin()
    call InitTrig_UnholyNovaFinish()
    call InitTrig_SinisterReflectUse()
    call InitTrig_SinisterReflectBegin()
    call InitTrig_SinisterReflectFinish()
    call InitTrig_SinisterReflectDeath()
    call InitTrig_ClonesUse()
    call InitTrig_ClonesCast()
    call InitTrig_ClonesLoop()
    call InitTrig_ClonesSetNumClones()
    call InitTrig_ClonesDmg()
    call InitTrig_ClonesDmgEvent()
    call InitTrig_InitNagaSirens()
    call InitTrig_NagaSirenHPShareStart()
    call InitTrig_NagaSirenHPShare()
    call InitTrig_NagaSirenDeath()
    call InitTrig_HealTwinUse()
    call InitTrig_HealTwinCast()
    call InitTrig_TeleportUse()
    call InitTrig_TeleportCast()
    call InitTrig_ShadowstormUse()
    call InitTrig_ShadowstormCast()
    call InitTrig_ShadowstormDmg()
    call InitTrig_ShadowstormDmgEvent()
    call InitTrig_ShadowstormDummyDeath()
    call InitTrig_VoidZoneUse()
    call InitTrig_VoidZoneCast()
    call InitTrig_VoidZoneTick()
    call InitTrig_VoidZoneDeath()
    call InitTrig_JinxUse()
    call InitTrig_PhoenixDeath()
    call InitTrig_PhoenixEggDeath()
    call InitTrig_AnkhOfReanimation()
    call InitTrig_AnkhOfReanimationDeath()
    call InitTrig_InitWaspEggs()
    call InitTrig_WaspEggAggro()
    call InitTrig_WaspEggDeath()
    call InitTrig_MasterOfTheVaultInit()
    call InitTrig_MasterOfTheVaultEngage()
    call InitTrig_MasterOfTheVaultAITick()
    call InitTrig_MasterOfTheVaultDeath()
    call InitTrig_OtherwordlyBarrier()
    call InitTrig_DarkBeamCast()
    call InitTrig_DarkBeamDmg()
    call InitTrig_DarkBeamDmgEvent()
    call InitTrig_ShadowEruptionCast()
    call InitTrig_ShadowEruptionDummyDeath()
    call InitTrig_ShadowSpikesCastBegin()
    call InitTrig_ShadowSpikesCastStop()
    call InitTrig_ShadowSpikesCastFinish()
    call InitTrig_ShadowSpikesDummyDeath()
    call InitTrig_SummonCorruptWatcherCast()
    call InitTrig_CorruptWatcherEnterMap()
    call InitTrig_BindingGazeUse()
    call InitTrig_BindingGazeDmg()
    call InitTrig_BindingGazeDmgEvent()
    call InitTrig_SummonOtherwordlyEntity()
    call InitTrig_OtherwordlyEntityDeath()
    call InitTrig_PatMainHallInit()
    call InitTrig_PatMainHallLoad()
    call InitTrig_PatMainHallCenter()
    call InitTrig_PatMainHallMove()
    call InitTrig_ItemAncientTome()
    call InitTrig_ItemAbilLifeOrb()
    call InitTrig_ItemAbilSoulEater()
    call InitTrig_ItemAbilSoulEaterCondition()
    call InitTrig_TempLevelUp()
    call InitTrig_TempLevelUpMax()
endfunction

//===========================================================================
function RunInitializationTriggers takes nothing returns nothing
    call ConditionalTriggerExecute(gg_trg_Init)
    call ConditionalTriggerExecute(gg_trg_LevelsInit)
    call ConditionalTriggerExecute(gg_trg_InitCircleOfCultists)
    call ConditionalTriggerExecute(gg_trg_HeroSelectInit)
    call ConditionalTriggerExecute(gg_trg_StormShieldDmg)
    call ConditionalTriggerExecute(gg_trg_InitGolems)
    call ConditionalTriggerExecute(gg_trg_ImpaleAttack)
    call ConditionalTriggerExecute(gg_trg_SphinxCouncilInit)
    call ConditionalTriggerExecute(gg_trg_InitNagaSirens)
    call ConditionalTriggerExecute(gg_trg_InitWaspEggs)
    call ConditionalTriggerExecute(gg_trg_MasterOfTheVaultInit)
    call ConditionalTriggerExecute(gg_trg_PatMainHallInit)
endfunction

//***************************************************************************
//*
//*  Players
//*
//***************************************************************************

function InitCustomPlayerSlots takes nothing returns nothing

    // Player 0
    call SetPlayerStartLocation(Player(0), 0)
    call ForcePlayerStartLocation(Player(0), 0)
    call SetPlayerColor(Player(0), ConvertPlayerColor(0))
    call SetPlayerRacePreference(Player(0), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(0), false)
    call SetPlayerController(Player(0), MAP_CONTROL_USER)

    // Player 1
    call SetPlayerStartLocation(Player(1), 1)
    call ForcePlayerStartLocation(Player(1), 1)
    call SetPlayerColor(Player(1), ConvertPlayerColor(1))
    call SetPlayerRacePreference(Player(1), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(1), false)
    call SetPlayerController(Player(1), MAP_CONTROL_USER)

    // Player 2
    call SetPlayerStartLocation(Player(2), 2)
    call ForcePlayerStartLocation(Player(2), 2)
    call SetPlayerColor(Player(2), ConvertPlayerColor(2))
    call SetPlayerRacePreference(Player(2), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(2), false)
    call SetPlayerController(Player(2), MAP_CONTROL_USER)

    // Player 3
    call SetPlayerStartLocation(Player(3), 3)
    call ForcePlayerStartLocation(Player(3), 3)
    call SetPlayerColor(Player(3), ConvertPlayerColor(3))
    call SetPlayerRacePreference(Player(3), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(3), false)
    call SetPlayerController(Player(3), MAP_CONTROL_USER)

    // Player 4
    call SetPlayerStartLocation(Player(4), 4)
    call ForcePlayerStartLocation(Player(4), 4)
    call SetPlayerColor(Player(4), ConvertPlayerColor(4))
    call SetPlayerRacePreference(Player(4), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(4), false)
    call SetPlayerController(Player(4), MAP_CONTROL_USER)

    // Player 5
    call SetPlayerStartLocation(Player(5), 5)
    call ForcePlayerStartLocation(Player(5), 5)
    call SetPlayerColor(Player(5), ConvertPlayerColor(5))
    call SetPlayerRacePreference(Player(5), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(5), false)
    call SetPlayerController(Player(5), MAP_CONTROL_USER)

    // Player 20
    call SetPlayerStartLocation(Player(20), 6)
    call ForcePlayerStartLocation(Player(20), 6)
    call SetPlayerColor(Player(20), ConvertPlayerColor(20))
    call SetPlayerRacePreference(Player(20), RACE_PREF_UNDEAD)
    call SetPlayerRaceSelectable(Player(20), false)
    call SetPlayerController(Player(20), MAP_CONTROL_COMPUTER)

endfunction

function InitCustomTeams takes nothing returns nothing
    // Force: TRIGSTR_588
    call SetPlayerTeam(Player(0), 0)
    call SetPlayerTeam(Player(1), 0)
    call SetPlayerTeam(Player(2), 0)
    call SetPlayerTeam(Player(3), 0)
    call SetPlayerTeam(Player(4), 0)
    call SetPlayerTeam(Player(5), 0)

    // Force: TRIGSTR_589
    call SetPlayerTeam(Player(20), 1)

endfunction

function InitAllyPriorities takes nothing returns nothing

    call SetStartLocPrioCount(0, 5)
    call SetStartLocPrio(0, 0, 1, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(0, 1, 2, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(0, 2, 3, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(0, 3, 4, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(0, 4, 5, MAP_LOC_PRIO_HIGH)

    call SetStartLocPrioCount(1, 5)
    call SetStartLocPrio(1, 0, 0, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(1, 1, 2, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(1, 2, 3, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(1, 3, 4, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(1, 4, 5, MAP_LOC_PRIO_HIGH)

    call SetStartLocPrioCount(2, 5)
    call SetStartLocPrio(2, 0, 0, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(2, 1, 1, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(2, 2, 3, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(2, 3, 4, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(2, 4, 5, MAP_LOC_PRIO_HIGH)

    call SetStartLocPrioCount(3, 5)
    call SetStartLocPrio(3, 0, 0, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(3, 1, 1, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(3, 2, 2, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(3, 3, 4, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(3, 4, 5, MAP_LOC_PRIO_HIGH)

    call SetStartLocPrioCount(4, 5)
    call SetStartLocPrio(4, 0, 0, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(4, 1, 1, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(4, 2, 2, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(4, 3, 3, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(4, 4, 5, MAP_LOC_PRIO_HIGH)

    call SetStartLocPrioCount(5, 5)
    call SetStartLocPrio(5, 0, 0, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(5, 1, 1, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(5, 2, 2, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(5, 3, 3, MAP_LOC_PRIO_HIGH)
    call SetStartLocPrio(5, 4, 4, MAP_LOC_PRIO_HIGH)

    call SetStartLocPrioCount(6, 6)
    call SetStartLocPrio(6, 0, 0, MAP_LOC_PRIO_LOW)
    call SetStartLocPrio(6, 1, 1, MAP_LOC_PRIO_LOW)
    call SetStartLocPrio(6, 2, 2, MAP_LOC_PRIO_LOW)
    call SetStartLocPrio(6, 3, 3, MAP_LOC_PRIO_LOW)
    call SetStartLocPrio(6, 4, 4, MAP_LOC_PRIO_LOW)
    call SetStartLocPrio(6, 5, 5, MAP_LOC_PRIO_LOW)
endfunction

//***************************************************************************
//*
//*  Main Initialization
//*
//***************************************************************************

//===========================================================================
function main takes nothing returns nothing
    call SetCameraBounds(- 11008.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), - 8192.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM), 12032.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), 18944.0 - GetCameraMargin(CAMERA_MARGIN_TOP), - 11008.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), 18944.0 - GetCameraMargin(CAMERA_MARGIN_TOP), 12032.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), - 8192.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM))
    call SetDayNightModels("Environment\\DNC\\DNCLordaeron\\DNCLordaeronTerrain\\DNCLordaeronTerrain.mdl", "Environment\\DNC\\DNCLordaeron\\DNCLordaeronUnit\\DNCLordaeronUnit.mdl")
    call SetTerrainFogEx(0, 0.0, 7000.0, 0.000, 0.882, 0.831, 0.588)
    call NewSoundEnvironment("Default")
    call SetAmbientDaySound("BarrensDay")
    call SetAmbientNightSound("BarrensNight")
    call SetMapMusic("Music", true, 0)
    call InitSounds()
    call CreateRegions()
    call CreateCameras()
    call CreateAllDestructables()
    call CreateAllItems()
    call CreateAllUnits()
    call InitBlizzard()


    call InitGlobals()
    call InitCustomTriggers()
    call RunInitializationTriggers()

endfunction

//***************************************************************************
//*
//*  Map Configuration
//*
//***************************************************************************

function config takes nothing returns nothing
    call SetMapName("TRIGSTR_001")
    call SetMapDescription("")
    call SetPlayers(7)
    call SetTeams(7)
    call SetGamePlacement(MAP_PLACEMENT_TEAMS_TOGETHER)

    call DefineStartLocation(0, 10304.0, 256.0)
    call DefineStartLocation(1, 10304.0, 256.0)
    call DefineStartLocation(2, 10304.0, 256.0)
    call DefineStartLocation(3, 10304.0, 256.0)
    call DefineStartLocation(4, 10304.0, 256.0)
    call DefineStartLocation(5, 10304.0, 256.0)
    call DefineStartLocation(6, 10304.0, 256.0)

    // Player setup
    call InitCustomPlayerSlots()
    call InitCustomTeams()
    call InitAllyPriorities()
endfunction




//Struct method generated initializers/callers:

